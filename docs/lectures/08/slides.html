<!DOCTYPE html>
<html lang="en"><head>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/tabby.min.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dc55a5b9e770e841cd82e46aadbfb9b0.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.8.24">

  <meta name="author" content="Marcel Turcotte">
  <title>CSI 4106 - Fall 2025 – Model Evaluation and Hyperparameter Tuning</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
      margin-bottom: 0em;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/theme/quarto-534cd8e3a96973385dffff3f4709048d.css">
  <link href="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
<meta property="og:title" content="Model Evaluation and Hyperparameter Tuning – CSI 4106 - Fall 2025">
<meta property="og:description" content="CSI 4106 - Fall 2025">
<meta property="og:site_name" content="CSI 4106 - Fall 2025">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Model Evaluation and Hyperparameter Tuning</h1>
  <p class="subtitle">CSI 4106 - Fall 2025</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Marcel Turcotte 
</div>
</div>
</div>

  <p class="date">Version: Sep 21, 2025 15:55</p>
</section>
<section>
<section id="preamble" class="title-slide slide level1 center">
<h1>Preamble</h1>

</section>
<section id="message-of-the-day" class="slide level2">
<h2>Message of the Day</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="https://static.wixstatic.com/media/a4c5cd_17f35b4279124d5a813dd3e3f61b4d5f~mv2.png/v1/fill/w_1960,h_1102,al_c,q_95,usm_0.66_1.00_0.01,enc_avif,quality_auto/ETH_Apertus_Keyvisual_Final-LY2-3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img data-src="https://static.wixstatic.com/media/a4c5cd_17f35b4279124d5a813dd3e3f61b4d5f~mv2.png/v1/fill/w_1960,h_1102,al_c,q_95,usm_0.66_1.00_0.01,enc_avif,quality_auto/ETH_Apertus_Keyvisual_Final-LY2-3.png" class="quarto-figure quarto-figure-center" height="450"></a></p>
</figure>
</div>

<aside class="notes">
<blockquote>
<p>EPFL, ETH Zurich and the Swiss National Supercomputing Centre (CSCS) released Apertus 2 September, Switzerland’s first large-scale, open, multilingual language model — a milestone in generative AI for transparency and diversity.</p>
</blockquote>
<ul>
<li><a href="https://www.swiss-ai.org/apertus">www.swiss-ai.org/apertus</a></li>
<li>Downloads available at <a href="https://huggingface.co/collections/swiss-ai/apertus-llm-68b699e65415c231ace3b059">Hugging Face</a></li>
<li><a href="https://publicai.co">Public access</a></li>
</ul>
<p>Should Canada undertake such an extensive project?</p>
<p>Canada is recognized for its exceptional AI research, supported by several renowned research institutions and scholars. Notable examples include:</p>
<ul>
<li><p>The <a href="https://vectorinstitute.ai/">Vector Institute</a> in Toronto, which is home to distinguished researchers like <a href="https://vectorinstitute.ai/team/geoffrey-hinton/">Geoffrey Hinton</a>, a recipient of the 2018 Turing Award for his pioneering work in deep learning and the 2024 Nobel Prize in Physics.</p></li>
<li><p><a href="https://mila.quebec/en">Mila</a> in Montréal, led by <a href="https://mila.quebec/en/directory/yoshua-bengio">Yoshua Bengio</a>, another 2018 Turing Award laureate recognized for his contributions to deep learning.</p></li>
<li><p>The <a href="https://www.amii.ca">Alberta Machine Intelligence Institute (Amii)</a>, where <a href="https://www.amii.ca/people/richard-s-sutton">Richard S. Sutton</a> is a key figure and was awarded the 2024 Turing Award for his influential work in reinforcement learning.</p></li>
</ul>
<p>These institutions and individuals underscore Canada’s leadership and ongoing commitment to advancing artificial intelligence research.</p>
<p>The <a href="https://www.alliancecan.ca/en">Digital Research Alliance of Canada</a>, supported by a <a href="https://ised-isde.canada.ca/site/ised/en/public-consultations/securing-canadas-ai-advantage-foundational-blueprint">$2 billion commitment from the Government of Canada in 2024</a>, provides cutting-edge infrastructure for advanced research. Notably, the high-performance computing resource, <a href="https://docs.alliancecan.ca/wiki/Nibi">Nibi</a>, was launched on July 31, 2025. It features 134,400 CPU cores and 288 NVIDIA H100 GPUs, significantly enhancing computational capacity. For further technical specifications, please refer to the <a href="https://docs.alliancecan.ca/wiki/Technical_documentation">technical documentation</a>.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<aside><div>
<p><a href="https://ethz.ch/en/news-and-events/eth-news/news/2025/09/press-release-apertus-a-fully-open-transparent-multilingual-language-model.html">Apertus: a fully open, transparent, multilingual language model</a>, ETH Zürich, Press Release, 2025-09-02.</p>
</div></aside></section>
<section id="learning-objectives" class="slide level2 scrollable">
<h2>Learning Objectives</h2>
<ol type="1">
<li><strong>Understand the Purpose of Data Splitting:</strong>
<ul>
<li>Describe the roles of the training, validation, and test sets in model evaluation.</li>
<li>Explain why and how datasets are divided for effective model training and evaluation.</li>
</ul></li>
<li><strong>Explain Cross-Validation Techniques:</strong>
<ul>
<li>Define cross-validation and its importance in model evaluation.</li>
<li>Illustrate the process of <span class="math inline">\(k\)</span>-fold cross-validation and its advantages over a single train-test split.</li>
<li>Discuss the concepts of underfitting and overfitting in the context of cross-validation.</li>
</ul></li>
<li><strong>Hyperparameter Tuning:</strong>
<ul>
<li>Explain the difference between model parameters and hyperparameters.</li>
<li>Describe methods for tuning hyperparameters, including grid search and randomized search.</li>
<li>Implement hyperparameter tuning using <code>GridSearchCV</code> in scikit-learn.</li>
</ul></li>
<li><strong>Evaluate Model Performance:</strong>
<ul>
<li>Interpret cross-validation results and understand metrics like mean and standard deviation of scores.</li>
<li>Discuss how cross-validation helps in assessing model generalization and reducing variability.</li>
</ul></li>
<li><strong>Machine Learning Engineering Workflow:</strong>
<ul>
<li>Outline the steps involved in preparing data for machine learning models.</li>
<li>Utilize scikit-learn pipelines for efficient data preprocessing and model training.</li>
<li>Emphasize the significance of consistent data transformations across training and production environments.</li>
</ul></li>
<li><strong>Critical Evaluation of Machine Learning Models:</strong>
<ul>
<li>Assess the limitations and challenges associated with hyperparameter tuning and model selection.</li>
<li>Recognize potential pitfalls in data preprocessing, such as incorrect handling of missing values or inconsistent encoding.</li>
<li>Advocate for thorough testing and validation to ensure model reliability and generalizability.</li>
</ul></li>
<li><strong>Integrate Knowledge in Practical Applications:</strong>
<ul>
<li>Apply the learned concepts to real-world datasets (e.g., OpenML datasets like ‘diabetes’ and ‘adult’).</li>
<li>Interpret and analyze the results of model evaluations and experiments.</li>
<li>Develop a comprehensive understanding of the end-to-end machine learning pipeline.</li>
</ul></li>
</ol>

<aside><div>
<p>The above learning objectives have been generated by OpenAI’s model, <a href="https://openai.com/index/introducing-openai-o1-preview/">o1</a>, based on the lecture content.</p>
</div></aside></section></section>
<section>
<section id="introduction" class="title-slide slide level1 center">
<h1>Introduction</h1>

</section>
<section id="dataset---openml" class="slide level2 scrollable">
<h2>Dataset - openml</h2>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong><i class="fa-solid fa-quote-right" aria-label="quote-right"></i> <a href="https://www.openml.org">www.openml.org</a></strong></p>
</div>
<div class="callout-content">
<p>OpenML is an open platform for sharing datasets, algorithms, and experiments - to learn how to learn better, together.</p>
</div>
</div>
</div>
<div class="fragment">
<div id="6c5c58a1" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb1-3"><a></a></span>
<span id="cb1-4"><a></a><span class="im">from</span> sklearn.datasets <span class="im">import</span> fetch_openml</span>
<span id="cb1-5"><a></a></span>
<span id="cb1-6"><a></a>diabetes <span class="op">=</span> fetch_openml(name<span class="op">=</span><span class="st">'diabetes'</span>, version<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb1-7"><a></a><span class="bu">print</span>(diabetes.DESCR)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>

<aside class="notes">
<p>Today’s dataset is the PIMA dataset, which contains 768 instances and 8 numerical attributes. The numerical nature of these attributes facilitates our analysis. Additionally, since the data originates from a published paper, it likely reflects careful data collection, potentially leading to robust results, as the authors would have needed high-quality data to support their publication.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section>
<section id="dataset---openml-output" class="slide level2 scrollable output-location-slide"><h2>Dataset - openml</h2><div class="cell output-location-slide" data-execution_count="1">
<p><strong>Author</strong>: <a href="vgs@aplcen.apl.jhu.edu">Vincent Sigillito</a></p>
<p><strong>Source</strong>: <a href="https://archive.ics.uci.edu/ml/datasets/pima+indians+diabetes">Obtained from UCI</a></p>
<p><strong>Please cite</strong>: <a href="https://archive.ics.uci.edu/ml/citation_policy.html">UCI citation policy</a></p>
<ol type="1">
<li><p>Title: Pima Indians Diabetes Database</p></li>
<li><p>Sources:</p>
<ol type="a">
<li>Original owners: National Institute of Diabetes and Digestive and Kidney Diseases</li>
<li>Donor of database: Vincent Sigillito (vgs@aplcen.apl.jhu.edu) Research Center, RMI Group Leader Applied Physics Laboratory The Johns Hopkins University Johns Hopkins Road Laurel, MD 20707 (301) 953-6231</li>
<li>Date received: 9 May 1990</li>
</ol></li>
<li><p>Past Usage:</p>
<ol type="1">
<li><p>Smith,<sub>J.</sub>W., Everhart,<sub>J.</sub>E., Dickson,<sub>W.</sub>C., Knowler,<sub>W.</sub>C., &amp; Johannes,<sub>R.</sub>S. (1988). Using the ADAP learning algorithm to forecast the onset of diabetes mellitus. In {it Proceedings of the Symposium on Computer Applications and Medical Care} (pp.&nbsp;261–265). IEEE Computer Society Press.</p>
<p>The diagnostic, binary-valued variable investigated is whether the patient shows signs of diabetes according to World Health Organization criteria (i.e., if the 2 hour post-load plasma glucose was at least 200 mg/dl at any survey examination or if found during routine medical care). The population lives near Phoenix, Arizona, USA.</p>
<p>Results: Their ADAP algorithm makes a real-valued prediction between 0 and 1. This was transformed into a binary decision using a cutoff of 0.448. Using 576 training instances, the sensitivity and specificity of their algorithm was 76% on the remaining 192 instances.</p></li>
</ol></li>
<li><p>Relevant Information: Several constraints were placed on the selection of these instances from a larger database. In particular, all patients here are females at least 21 years old of Pima Indian heritage. ADAP is an adaptive learning routine that generates and executes digital analogs of perceptron-like devices. It is a unique algorithm; see the paper for details.</p></li>
<li><p>Number of Instances: 768</p></li>
<li><p>Number of Attributes: 8 plus class</p></li>
<li><p>For Each Attribute: (all numeric-valued)</p>
<ol type="1">
<li>Number of times pregnant</li>
<li>Plasma glucose concentration a 2 hours in an oral glucose tolerance test</li>
<li>Diastolic blood pressure (mm Hg)</li>
<li>Triceps skin fold thickness (mm)</li>
<li>2-Hour serum insulin (mu U/ml)</li>
<li>Body mass index (weight in kg/(height in m)^2)</li>
<li>Diabetes pedigree function</li>
<li>Age (years)</li>
<li>Class variable (0 or 1)</li>
</ol></li>
<li><p>Missing Attribute Values: None</p></li>
<li><p>Class Distribution: (class value 1 is interpreted as “tested positive for diabetes”)</p>
<p>Class Value Number of instances 0 500 1 268</p></li>
<li><p>Brief statistical analysis:</p>
<p>Attribute number: Mean: Standard Deviation:</p>
<ol type="1">
<li><pre><code>                3.8     3.4</code></pre></li>
<li><pre><code>              120.9    32.0</code></pre></li>
<li><pre><code>               69.1    19.4</code></pre></li>
<li><pre><code>               20.5    16.0</code></pre></li>
<li><pre><code>               79.8   115.2</code></pre></li>
<li><pre><code>               32.0     7.9</code></pre></li>
<li><pre><code>                0.5     0.3</code></pre></li>
<li><pre><code>               33.2    11.8</code></pre></li>
</ol></li>
</ol>
<p>Relabeled values in attribute ‘class’ From: 0 To: tested_negative<br>
From: 1 To: tested_positive</p>
<p>Downloaded from openml.org.</p>
</div></section><section id="dataset---return_x_y" class="slide level2">
<h2>Dataset - <code>return_X_y</code></h2>
<p><code>fetch_openml</code> returns a <code>Bunch</code>, a <code>DataFrame</code>, or <code>X</code> and <code>y</code></p>
<div id="3a2ecbbd" class="cell" data-execution_count="2">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a></a><span class="im">from</span> sklearn.datasets <span class="im">import</span> fetch_openml</span>
<span id="cb10-2"><a></a></span>
<span id="cb10-3"><a></a>X, y <span class="op">=</span> fetch_openml(name<span class="op">=</span><span class="st">'diabetes'</span>, version<span class="op">=</span><span class="dv">1</span>, return_X_y<span class="op">=</span><span class="va">True</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="fragment">
<p>Mild imbalance (ratio less than 3 or 4)</p>
<div id="0feb6387" class="cell" data-execution_count="3">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a></a><span class="bu">print</span>(y.value_counts())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>class
tested_negative    500
tested_positive    268
Name: count, dtype: int64</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p>Converting the target labels to 0 and 1</p>
<div id="351277b2" class="cell" data-execution_count="4">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a></a>y <span class="op">=</span> y.<span class="bu">map</span>({<span class="st">'tested_negative'</span>: <span class="dv">0</span>, <span class="st">'tested_positive'</span>: <span class="dv">1</span>})</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</section></section>
<section>
<section id="cross-evaluation" class="title-slide slide level1 center">
<h1>Cross-evaluation</h1>

</section>
<section id="training-and-test-set" class="slide level2">
<h2>Training and test set</h2>
<p>Sometimes called <strong>holdout method</strong>.</p>
<ul>
<li class="fragment"><p><strong>Guideline:</strong> Typically, allocate <strong>80%</strong> of your dataset for <strong>training</strong> and reserve the remaining <strong>20%</strong> for testing.</p></li>
<li class="fragment"><p><strong>Training Set:</strong> This subset of data is utilized to <strong>train</strong> your model.</p></li>
<li class="fragment"><p><strong>Test Set:</strong> This is an <strong>independent</strong> subset used exclusively at the final stage to assess the model’s performance.</p></li>
</ul>
<aside class="notes">
<h3 id="common-training-and-testing-ratios">Common Training and Testing Ratios</h3>
<ol type="1">
<li><strong>80:20 Split:</strong>
<ul>
<li><strong>Training Set:</strong> 80% of the data</li>
<li><strong>Testing Set:</strong> 20% of the data</li>
<li>This is a widely used default split that provides a balance between having enough data to train the model and enough data to evaluate its performance.</li>
</ul></li>
<li><strong>90:10 Split:</strong>
<ul>
<li><strong>Training Set:</strong> 90% of the data</li>
<li><strong>Testing Set:</strong> 10% of the data</li>
<li>This split might be used when the dataset is very large, ensuring a substantial amount of data for training while still having a decent-sized test set.</li>
</ul></li>
</ol>
<h3 id="considerations-for-choosing-the-split-ratio">Considerations for Choosing the Split Ratio</h3>
<ol type="1">
<li><strong>Dataset Size:</strong>
<ul>
<li>For large datasets, a smaller proportion can be reserved for testing (e.g., 90:10) since even 10% of a large dataset can provide a robust evaluation.</li>
</ul></li>
<li><strong>Model Complexity:</strong>
<ul>
<li>Complex models with many parameters may require more training data to avoid overfitting, suggesting a larger training set.</li>
</ul></li>
<li><strong>Validation Set:</strong>
<ul>
<li>See discussion below.</li>
</ul></li>
<li><strong>Imbalanced Datasets:</strong>
<ul>
<li>For imbalanced datasets, it’s essential to ensure that both the training and testing sets represent the class distribution adequately. <strong>Stratified sampling can be used to maintain the class proportions in both sets.</strong></li>
</ul></li>
</ol>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="training-and-test-set-1" class="slide level2">
<h2>Training and test set</h2>
<p><strong>Training Error:</strong></p>
<ul>
<li>Generally tends to be <strong>low</strong></li>
<li>Achieved by optimizing learning algorithms to minimize error through parameter adjustments (e.g., weights)</li>
</ul>
</section>
<section id="training-and-test-set-2" class="slide level2">
<h2>Training and test set</h2>
<p><strong>Generalization Error:</strong> The error rate observed when the model is evaluated on new, unseen data.</p>
</section>
<section id="training-and-test-set-3" class="slide level2">
<h2>Training and test set</h2>
<p><strong>Underfitting:</strong></p>
<ul>
<li><strong>High training error</strong></li>
<li>Model is too simple to capture underlying patterns</li>
<li>Poor performance on both training and new data</li>
</ul>
<p><strong>Overfitting:</strong></p>
<ul>
<li>Low training error, but <strong>high generalization error</strong></li>
<li>Model captures noise or irrelevant patterns</li>
<li>Poor performance on new, unseen data</li>
</ul>
</section>
<section id="definition" class="slide level2">
<h2>Definition</h2>
<p><strong>Cross-validation</strong> is a method used to evaluate and improve the performance of machine learning models.</p>
<p>It involves partitioning the dataset into multiple subsets, <strong>training the model on some subsets</strong> while <strong>validating it on the remaining ones</strong>.</p>
</section>
<section id="k-fold-cross-validation" class="slide level2">
<h2>k-fold cross-validation</h2>
<ol type="1">
<li class="fragment"><strong>Divide</strong> the dataset into <strong><span class="math inline">\(k\)</span> equally sized parts</strong> (folds).</li>
<li class="fragment">T<strong>raining and validation:</strong>
<ul>
<li class="fragment">For each iteration, <strong>one fold is used as the validation set</strong>, the remaining <strong><span class="math inline">\(k\)</span>-1 folds are used as the training set</strong>.</li>
</ul></li>
<li class="fragment"><strong>Evaluation:</strong> The model’s performance is evaluated in each iteration, resulting in <span class="math inline">\(k\)</span> performance measures.</li>
<li class="fragment"><strong>Aggregation:</strong> Statistics are calculated based on <span class="math inline">\(k\)</span> performance measures.</li>
</ol>

<aside class="notes">
<p>In science, to estimate the value of a constant, it is common to repeat the experiment multiple times in order to calculate the mean and standard deviation of the obtained measurements. A high variance raises questions about the reliability of the experiment. Similarly, <strong><span class="math inline">\(k\)</span>-fold cross-validation</strong> generates <span class="math inline">\(k\)</span> distinct evaluations. This method not only provides a more accurate estimate of the model’s performance but also assesses its robustness against data variability.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<aside><div>
<p>Common choices for the value of <span class="math inline">\(k\)</span> are 3, 5, 7, and 10.</p>
</div></aside></section>
<section id="fold-cross-validation" class="slide level2">
<h2>3-Fold Cross-validation</h2>
<div id="dc34e4a7" class="cell" data-execution_count="6">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="slides_files/figure-revealjs/cell-7-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img data-src="slides_files/figure-revealjs/cell-7-output-1.png" class="quarto-figure quarto-figure-center" width="467" height="431"></a></p>
</figure>
</div>
</div>
</div>

<aside class="notes">
<p>Each row of the table represents an iteration within the <span class="math inline">\(k\)</span>-fold cross-validation process, with the number of iterations equating to the number of folds. In each iteration, one fold is designated for validation, while the remaining <span class="math inline">\(k-1\)</span> folds are utilized for training the model.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<aside><div>
<p>With each iteration, <span class="math inline">\(2/3\)</span> of the dataset is used for training and <span class="math inline">\(1/3\)</span> for validation.</p>
</div></aside></section>
<section id="fold-cross-validation-1" class="slide level2">
<h2>5-Fold Cross-validation</h2>
<div id="c8eeb504" class="cell" data-execution_count="7">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="slides_files/figure-revealjs/cell-8-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img data-src="slides_files/figure-revealjs/cell-8-output-1.png" class="quarto-figure quarto-figure-center" width="468" height="433"></a></p>
</figure>
</div>
</div>
</div>

<aside><div>
<p>With each iteration, <span class="math inline">\(4/5\)</span> of the dataset is used for training and <span class="math inline">\(1/5\)</span> for validation.</p>
</div></aside></section>
<section id="more-reliable-model-evaluation" class="slide level2">
<h2>More Reliable Model Evaluation</h2>
<ul>
<li>More <strong>reliable</strong> estimate of model performance compared to a single train-test split.</li>
<li><strong>Reduces the variability</strong> associated with a single split, leading to a <strong>more stable and unbiased evaluation</strong>.</li>
<li>For large values of <span class="math inline">\(k\)</span><sup>1</sup>, consider the <strong>average</strong>, <strong>variance</strong>, and <strong>confidence interval</strong>.</li>
</ul>
<aside><ol class="aside-footnotes"><li id="fn1"><p>10-fold cross-validation.</p></li></ol></aside></section>
<section id="better-generalization" class="slide level2">
<h2>Better Generalization</h2>
<ul>
<li>Helps in assessing how the model <strong>generalizes</strong> to an independent dataset.</li>
<li>It ensures that the model’s performance is not overly <strong>optimistic</strong> or <strong>pessimistic</strong> by averaging results over multiple folds.</li>
</ul>
</section>
<section id="efficient-use-of-data" class="slide level2">
<h2>Efficient Use of Data</h2>
<ul>
<li><strong>Particularly beneficial for small datasets</strong>, cross-validation ensures that every data point is used for both training and validation.</li>
<li>This <strong>maximizes the use of available data</strong>, leading to more accurate and reliable model training.</li>
</ul>

<aside><div>
<p>Some examples are more informative for learning algorithms, sometimes those near the decision boundary.</p>
</div></aside></section>
<section id="hyperparameter-tuning" class="slide level2">
<h2>Hyperparameter Tuning</h2>
<ul>
<li>Commonly used during <strong>hyperparameter tuning</strong>, allowing for the <strong>selection of the best model parameters</strong> based on their performance across multiple folds.</li>
<li>This helps in identifying the <strong>optimal</strong> configuration that balances <strong>bias</strong> and <strong>variance</strong>.</li>
</ul>
</section>
<section id="challenges" class="slide level2">
<h2>Challenges</h2>
<ul>
<li><strong>Computational Cost</strong>: Requires multiple model trainings.
<ul>
<li><strong>Leave-One-Out</strong> (LOO): Extreme case where ( k = N ).</li>
</ul></li>
<li><strong>Class Imbalance</strong>: Folds may not represent minority classes.
<ul>
<li>Use <strong>Stratified Cross-Validation</strong> to maintain class proportions.</li>
</ul></li>
<li><strong>Complexity</strong>: Error-prone implementation, especially for <strong>nested cross-validation</strong>, <strong>bootstraps</strong>, or integration into larger pipelines.</li>
</ul>
<aside class="notes">
<p>Leave-one-out cross-validation (LOO-CV) can lead to overoptimistic performance evaluation, particularly in certain contexts.</p>
<p>Here’s why:</p>
<pre><code>1.  **High Variance**: In LOO-CV, each iteration uses almost all the data for training, leaving only one instance for testing. This can result in high variance in the test error across iterations because the model is trained on nearly the full dataset. Since each training set is very similar to the full dataset, it can lead to overly optimistic estimates of generalization error, especially when the dataset is small or the model has high variance (e.g., decision trees or k-nearest neighbors).
2.  **Overfitting**: Since LOO-CV uses nearly the entire dataset for training in each iteration, complex models (especially ones prone to overfitting) can fit very closely to the data, which might result in a low training error but a misleadingly low test error in some cases.
3.  **Limited assessment of generalization**: LOO-CV might not give a reliable estimate of how well the model generalizes to completely unseen data because the difference between the training set and the full dataset is minimal, leading to a smaller gap between training and test performance.</code></pre>
<p>In practice, this can make the evaluation appear more optimistic than it would be with more robust methods like k-fold cross-validation, where the test sets are larger, and the model has less opportunity to overfit the training data.</p>
<p><strong>Stratified (in cross-validation)</strong>: a sampling strategy where each fold preserves the class distribution of the full dataset, ensuring that every class is represented proportionally in both training and validation splits.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="cross_val_score" class="slide level2">
<h2><code>cross_val_score</code></h2>
<div id="0cdb667d" class="cell" data-execution_count="8">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a></a><span class="im">from</span> sklearn <span class="im">import</span> tree</span>
<span id="cb15-2"><a></a></span>
<span id="cb15-3"><a></a>clf <span class="op">=</span> tree.DecisionTreeClassifier()</span>
<span id="cb15-4"><a></a></span>
<span id="cb15-5"><a></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> cross_val_score    </span>
<span id="cb15-6"><a></a></span>
<span id="cb15-7"><a></a>clf_scores <span class="op">=</span> cross_val_score(clf, X, y, cv<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb15-8"><a></a></span>
<span id="cb15-9"><a></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Scores:"</span>, clf_scores)</span>
<span id="cb15-10"><a></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Mean: </span><span class="sc">{</span>clf_scores<span class="sc">.</span>mean()<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb15-11"><a></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Standard deviation: </span><span class="sc">{</span>clf_scores<span class="sc">.</span>std()<span class="sc">:.2f}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Scores: [0.71428571 0.66883117 0.71428571 0.79738562 0.73202614]

Mean: 0.73

Standard deviation: 0.04</code></pre>
</div>
</div>

<aside class="notes">
<p>As previously discussed, a significant limitation of decision trees is their propensity for overfitting, which leads to high variance when applied to new datasets. This issue is evident in the observed performance variability, with accuracy ranging from 67% to 79%, which is undesirable for achieving robust model generalization.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<aside><div>
<p><a href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.cross_val_score.html">sklearn.model_selection.cross_val_score</a>, see also <a href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.cross_validate.html#sklearn.model_selection.cross_validate">cross_validate</a>.</p>
</div></aside></section></section>
<section>
<section id="hyperparameter-tuning-1" class="title-slide slide level1 center">
<h1>Hyperparameter tuning</h1>

</section>
<section id="workflow" class="slide level2">
<h2>Workflow</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="https://scikit-learn.org/stable/_images/grid_search_workflow.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img data-src="https://scikit-learn.org/stable/_images/grid_search_workflow.png" class="quarto-figure quarto-figure-center" height="475"></a></p>
</figure>
</div>

<aside class="notes">
<p>The above image implicitly introduces three categories of data subsets: <strong>training</strong>, <strong>validation</strong>, and <strong>test</strong>.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<aside><div>
<p><strong>Attribution</strong>: <a href="https://scikit-learn.org/stable/modules/cross_validation.html#cross-validation">Cross-validation: evaluating estimator performance</a></p>
</div></aside></section>
<section id="workflow---implementation" class="slide level2">
<h2>Workflow - implementation</h2>
<div id="a9d759ff" class="cell" data-execution_count="9">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a></a><span class="im">from</span> sklearn.datasets <span class="im">import</span> fetch_openml</span>
<span id="cb17-2"><a></a></span>
<span id="cb17-3"><a></a>X, y <span class="op">=</span> fetch_openml(name<span class="op">=</span><span class="st">'diabetes'</span>, version<span class="op">=</span><span class="dv">1</span>, return_X_y<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-4"><a></a></span>
<span id="cb17-5"><a></a>y <span class="op">=</span> y.<span class="bu">map</span>({<span class="st">'tested_negative'</span>: <span class="dv">0</span>, <span class="st">'tested_positive'</span>: <span class="dv">1</span>})</span>
<span id="cb17-6"><a></a></span>
<span id="cb17-7"><a></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb17-8"><a></a></span>
<span id="cb17-9"><a></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.1</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<aside class="notes">
<p>To maintain simplicity in these lecture notes, we have not applied any pre-processing steps.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="definition-1" class="slide level2">
<h2>Definition</h2>
<p>A <strong>hyperparameter</strong> is a configuration <strong>external to the model</strong> that is <strong>set prior to the training process</strong> and governs the learning process, influencing model performance and complexity.</p>

<aside><div>
<p>The <strong>weights of a model</strong>, which are learned by the learning algorithm, are often referred to as the <strong>model’s parameters</strong>. To avoid confusion, <strong>user-defined parameters</strong>, such as the learning rate <span class="math inline">\(\alpha\)</span>, are termed <strong>hyperparameters</strong>. Unlike model parameters, hyperparameters are <em>not</em> learned by the learning algorithm.</p>
</div></aside></section>
<section id="hyperparameters---decision-tree" class="slide level2">
<h2>Hyperparameters - Decision Tree</h2>
<ul>
<li><code>criterion</code>: <code>gini</code>, <code>entropy</code>, <code>log_loss</code>, measure the quality of a split.</li>
<li><code>max_depth</code>: limits the <strong>number of levels</strong> in the tree to prevent overfitting.</li>
</ul>

<aside><div>
<p><strong>See</strong>: <a href="https://scikit-learn.org/dev/modules/generated/sklearn.tree.DecisionTreeClassifier.html">DecisionTreeClassifier</a></p>
</div></aside></section>
<section id="hyperparameters---logistic-regression" class="slide level2">
<h2>Hyperparameters - Logistic Regression</h2>
<ul>
<li><code>penalty</code>: <code>l1</code> or <code>l2</code>, helps in preventing overfitting.</li>
<li><code>solver</code>: <code>liblinear</code>, <code>newton-cg</code>, <code>lbfgs</code>, <code>sag</code>, <code>saga</code>.</li>
<li><code>max_iter</code>: maximum number of iterations taken for the solvers to converge.</li>
<li><code>tol</code>: stopping criteria, smaller values mean higher precision.</li>
</ul>

<aside><div>
<p><strong>See</strong>: <a href="https://scikit-learn.org/1.5/modules/generated/sklearn.linear_model.LogisticRegression.html">LogisticRegression</a> and <a href="https://scikit-learn.org/1.5/modules/generated/sklearn.linear_model.SGDClassifier.html">SGDClassifier</a>.</p>
</div></aside></section>
<section id="hyperparameters---knn" class="slide level2">
<h2>Hyperparameters - KNN</h2>
<ul>
<li><code>n_neighbors</code>: number of neighbors to use for <span class="math inline">\(k\)</span>-neighbors queries.</li>
<li><code>weights</code>: <code>uniform</code> or <code>distance</code>, equal weight or distance-based weight.</li>
</ul>

<aside><div>
<p><strong>See</strong>: <a href="https://scikit-learn.org/dev/modules/generated/sklearn.neighbors.KNeighborsClassifier.html">KNeighborsClassifier</a></p>
</div></aside></section>
<section id="experiment-max_depth" class="slide level2">
<h2>Experiment: <code>max_depth</code></h2>
<div id="bb1b7cac" class="cell" data-execution_count="10">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a></a><span class="cf">for</span> value <span class="kw">in</span> [<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="va">None</span>]:</span>
<span id="cb18-2"><a></a></span>
<span id="cb18-3"><a></a>  clf <span class="op">=</span> tree.DecisionTreeClassifier(max_depth<span class="op">=</span>value)</span>
<span id="cb18-4"><a></a></span>
<span id="cb18-5"><a></a>  clf_scores <span class="op">=</span> cross_val_score(clf, X_train, y_train, cv<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb18-6"><a></a></span>
<span id="cb18-7"><a></a>  <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">max_depth = "</span>, value)</span>
<span id="cb18-8"><a></a>  <span class="bu">print</span>(<span class="ss">f"Mean: </span><span class="sc">{</span>clf_scores<span class="sc">.</span>mean()<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb18-9"><a></a>  <span class="bu">print</span>(<span class="ss">f"Standard deviation: </span><span class="sc">{</span>clf_scores<span class="sc">.</span>std()<span class="sc">:.2f}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
max_depth =  3
Mean: 0.74
Standard deviation: 0.04

max_depth =  5
Mean: 0.76
Standard deviation: 0.04

max_depth =  7
Mean: 0.73
Standard deviation: 0.04

max_depth =  None
Mean: 0.71
Standard deviation: 0.05</code></pre>
</div>
</div>
</section>
<section id="experiment-criterion" class="slide level2">
<h2>Experiment: <code>criterion</code></h2>
<div id="53b0c983" class="cell" data-execution_count="11">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a></a><span class="cf">for</span> value <span class="kw">in</span> [<span class="st">"gini"</span>, <span class="st">"entropy"</span>, <span class="st">"log_loss"</span>]:</span>
<span id="cb20-2"><a></a></span>
<span id="cb20-3"><a></a>  clf <span class="op">=</span> tree.DecisionTreeClassifier(max_depth<span class="op">=</span><span class="dv">5</span>, criterion<span class="op">=</span>value)</span>
<span id="cb20-4"><a></a></span>
<span id="cb20-5"><a></a>  clf_scores <span class="op">=</span> cross_val_score(clf, X_train, y_train, cv<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb20-6"><a></a></span>
<span id="cb20-7"><a></a>  <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">criterion = "</span>, value)</span>
<span id="cb20-8"><a></a>  <span class="bu">print</span>(<span class="ss">f"Mean: </span><span class="sc">{</span>clf_scores<span class="sc">.</span>mean()<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb20-9"><a></a>  <span class="bu">print</span>(<span class="ss">f"Standard deviation: </span><span class="sc">{</span>clf_scores<span class="sc">.</span>std()<span class="sc">:.2f}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
criterion =  gini
Mean: 0.76
Standard deviation: 0.04

criterion =  entropy
Mean: 0.75
Standard deviation: 0.05

criterion =  log_loss
Mean: 0.75
Standard deviation: 0.05</code></pre>
</div>
</div>
<aside class="notes">
<p>For this specific problem and dataset, the <code>criterion</code> parameter has a limited impact on the learning process.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="experiment-n_neighbors" class="slide level2 scrollable">
<h2>Experiment: <code>n_neighbors</code></h2>
<div id="8cf18990" class="cell" data-execution_count="12">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsClassifier</span>
<span id="cb22-2"><a></a></span>
<span id="cb22-3"><a></a><span class="cf">for</span> value <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">11</span>):</span>
<span id="cb22-4"><a></a></span>
<span id="cb22-5"><a></a>  clf <span class="op">=</span> KNeighborsClassifier(n_neighbors<span class="op">=</span>value)</span>
<span id="cb22-6"><a></a></span>
<span id="cb22-7"><a></a>  clf_scores <span class="op">=</span> cross_val_score(clf, X_train, y_train, cv<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb22-8"><a></a></span>
<span id="cb22-9"><a></a>  <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">n_neighbors = "</span>, value)</span>
<span id="cb22-10"><a></a>  <span class="bu">print</span>(<span class="ss">f"Mean: </span><span class="sc">{</span>clf_scores<span class="sc">.</span>mean()<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb22-11"><a></a>  <span class="bu">print</span>(<span class="ss">f"Standard deviation: </span><span class="sc">{</span>clf_scores<span class="sc">.</span>std()<span class="sc">:.2f}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>

</section>
<section id="experiment-n_neighbors-output" class="slide level2 scrollable output-location-slide"><h2>Experiment: <code>n_neighbors</code></h2><div class="cell output-location-slide" data-execution_count="12">
<div class="cell-output cell-output-stdout">
<pre><code>
n_neighbors =  1
Mean: 0.67
Standard deviation: 0.05

n_neighbors =  2
Mean: 0.71
Standard deviation: 0.03

n_neighbors =  3
Mean: 0.69
Standard deviation: 0.05

n_neighbors =  4
Mean: 0.73
Standard deviation: 0.03

n_neighbors =  5
Mean: 0.72
Standard deviation: 0.03

n_neighbors =  6
Mean: 0.73
Standard deviation: 0.05

n_neighbors =  7
Mean: 0.74
Standard deviation: 0.04

n_neighbors =  8
Mean: 0.75
Standard deviation: 0.04

n_neighbors =  9
Mean: 0.73
Standard deviation: 0.05

n_neighbors =  10
Mean: 0.73
Standard deviation: 0.04</code></pre>
</div>
</div></section><section id="experiment-weights" class="slide level2">
<h2>Experiment: <code>weights</code></h2>
<div id="5e769fd1" class="cell" data-execution_count="13">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsClassifier</span>
<span id="cb24-2"><a></a></span>
<span id="cb24-3"><a></a><span class="cf">for</span> value <span class="kw">in</span> [<span class="st">"uniform"</span>, <span class="st">"distance"</span>]:</span>
<span id="cb24-4"><a></a></span>
<span id="cb24-5"><a></a>  clf <span class="op">=</span> KNeighborsClassifier(n_neighbors<span class="op">=</span><span class="dv">5</span>, weights<span class="op">=</span>value)</span>
<span id="cb24-6"><a></a></span>
<span id="cb24-7"><a></a>  clf_scores <span class="op">=</span> cross_val_score(clf, X_train, y_train, cv<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb24-8"><a></a></span>
<span id="cb24-9"><a></a>  <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">weights = "</span>, value)</span>
<span id="cb24-10"><a></a>  <span class="bu">print</span>(<span class="ss">f"Mean: </span><span class="sc">{</span>clf_scores<span class="sc">.</span>mean()<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb24-11"><a></a>  <span class="bu">print</span>(<span class="ss">f"Standard deviation: </span><span class="sc">{</span>clf_scores<span class="sc">.</span>std()<span class="sc">:.2f}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
weights =  uniform
Mean: 0.72
Standard deviation: 0.03

weights =  distance
Mean: 0.73
Standard deviation: 0.04</code></pre>
</div>
</div>
<aside class="notes">
<p>For this specific problem and dataset, the <code>weights</code> parameter has a limited impact on the learning process.</p>
<p>At this point, you might hypothesize that certain combinations of hyperparameters could be more optimal than others.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="hyperparameter-tuning-grid-search" class="slide level2">
<h2>Hyperparameter Tuning: Grid Search</h2>
<ul>
<li class="fragment"><p><strong>Many hyperparameters</strong> need tuning</p>
<ul>
<li class="fragment">Major <strong>disadvantage</strong> of ML algorithms</li>
</ul></li>
<li class="fragment"><p><strong>Manual exploration</strong> of combinations is tedious</p></li>
<li class="fragment"><p><strong>Grid search</strong> is more systematic</p>
<ol type="1">
<li class="fragment"><p><strong>Enumerate all</strong> possible hyperparameter combinations</p></li>
<li class="fragment"><p>Train on training set, evaluate on validation set</p></li>
</ol></li>
</ul>

<aside class="notes">
<p>The <strong>training set</strong> referred to here is <strong>different</strong> from the one previously mentioned. In each iteration of the <span class="math inline">\(k\)</span>-fold cross-validation process, a <strong>unique</strong> <strong>training</strong> and <strong>validation set</strong> is created.</p>
<p>In some contexts, the <strong>choice of the model</strong> itself can be considered a hyperparameter. For instance, when performing model selection within a machine learning pipeline, different algorithms (e.g., decision trees, support vector machines, neural networks) can be treated as hyperparameters. This approach allows for the selection of the best-performing model through automated processes such as grid search or random search, alongside the tuning of other hyperparameters.</p>
<p>Thus, while traditionally hyperparameters refer to settings within a specific model, the model choice can also be incorporated into hyperparameter optimization frameworks.</p>
<p>As will be discussed later, the choice of the <strong>number of layers</strong> and the <strong>number of nodes</strong> are often considered hyperparameters when training <strong>deep learning</strong> algorithms.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<aside><div>
<p><strong>Initially</strong>, try powers of 2 or 10. Next, <strong>refine</strong> with grid search near optimal values if time permits.</p>
</div></aside></section>
<section id="gridsearchcv" class="slide level2">
<h2><code>GridSearchCV</code></h2>
<div id="b5c0a735" class="cell" data-execution_count="14">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> GridSearchCV</span>
<span id="cb26-2"><a></a></span>
<span id="cb26-3"><a></a>param_grid <span class="op">=</span> [</span>
<span id="cb26-4"><a></a>  {<span class="st">'max_depth'</span>: <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">10</span>),</span>
<span id="cb26-5"><a></a>   <span class="st">'criterion'</span>: [<span class="st">"gini"</span>, <span class="st">"entropy"</span>, <span class="st">"log_loss"</span>]}</span>
<span id="cb26-6"><a></a>]</span>
<span id="cb26-7"><a></a></span>
<span id="cb26-8"><a></a>clf <span class="op">=</span> tree.DecisionTreeClassifier()</span>
<span id="cb26-9"><a></a></span>
<span id="cb26-10"><a></a>grid_search <span class="op">=</span> GridSearchCV(clf, param_grid, cv<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb26-11"><a></a></span>
<span id="cb26-12"><a></a>grid_search.fit(X_train, y_train)</span>
<span id="cb26-13"><a></a></span>
<span id="cb26-14"><a></a>(grid_search.best_params_, grid_search.best_score_)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>({'criterion': 'gini', 'max_depth': 5}, np.float64(0.7481910124074653))</code></pre>
</div>
</div>
</section>
<section id="gridsearchcv-1" class="slide level2">
<h2>GridSearchCV</h2>
<div id="3073a89f" class="cell" data-execution_count="15">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a></a>param_grid <span class="op">=</span> [</span>
<span id="cb28-2"><a></a>  {<span class="st">'n_neighbors'</span>: <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">15</span>),</span>
<span id="cb28-3"><a></a>   <span class="st">'weights'</span>: [<span class="st">"uniform"</span>, <span class="st">"distance"</span>]}</span>
<span id="cb28-4"><a></a>]</span>
<span id="cb28-5"><a></a></span>
<span id="cb28-6"><a></a>clf <span class="op">=</span> KNeighborsClassifier()</span>
<span id="cb28-7"><a></a></span>
<span id="cb28-8"><a></a>grid_search <span class="op">=</span> GridSearchCV(clf, param_grid, cv<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb28-9"><a></a></span>
<span id="cb28-10"><a></a>grid_search.fit(X_train, y_train)</span>
<span id="cb28-11"><a></a></span>
<span id="cb28-12"><a></a>(grid_search.best_params_, grid_search.best_score_)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>({'n_neighbors': 14, 'weights': 'uniform'}, np.float64(0.7554165363361485))</code></pre>
</div>
</div>
<aside class="notes">
<p>The variable <code>param_grid</code> contains a dictionary specifying the names of the parameters to be tuned, along with the respective values to be tested.</p>
<p>In this instance, the parameters <code>n_neighbors</code> and <code>weights</code> are being tuned. However, additional parameters could be included if necessary.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="gridsearchcv-2" class="slide level2">
<h2><code>GridSearchCV</code></h2>
<div id="90c5dfd3" class="cell" data-execution_count="17">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb30-2"><a></a></span>
<span id="cb30-3"><a></a><span class="co"># 2 * 5 * 5 * 3 = 150 tests!</span></span>
<span id="cb30-4"><a></a></span>
<span id="cb30-5"><a></a>param_grid <span class="op">=</span> [</span>
<span id="cb30-6"><a></a>  {<span class="st">'penalty'</span>: [<span class="st">"l1"</span>, <span class="st">"l2"</span>, <span class="va">None</span>],</span>
<span id="cb30-7"><a></a>   <span class="st">'solver'</span> : [<span class="st">'liblinear'</span>, <span class="st">'newton-cg'</span>, <span class="st">'lbfgs'</span>, <span class="st">'sag'</span>, <span class="st">'saga'</span>],</span>
<span id="cb30-8"><a></a>   <span class="st">'max_iter'</span> : [<span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">400</span>, <span class="dv">800</span>, <span class="dv">1600</span>],</span>
<span id="cb30-9"><a></a>   <span class="st">'tol'</span> : [<span class="fl">0.01</span>, <span class="fl">0.001</span>, <span class="fl">0.0001</span>]}</span>
<span id="cb30-10"><a></a>]</span>
<span id="cb30-11"><a></a></span>
<span id="cb30-12"><a></a>clf <span class="op">=</span> LogisticRegression()</span>
<span id="cb30-13"><a></a></span>
<span id="cb30-14"><a></a>grid_search <span class="op">=</span> GridSearchCV(clf, param_grid, cv<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb30-15"><a></a></span>
<span id="cb30-16"><a></a>grid_search.fit(X_train, y_train)</span>
<span id="cb30-17"><a></a></span>
<span id="cb30-18"><a></a>(grid_search.best_params_, grid_search.best_score_)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>({'max_iter': 100, 'penalty': 'l2', 'solver': 'newton-cg', 'tol': 0.001},
 np.float64(0.7756646856427901))</code></pre>
</div>
</div>
</section>
<section id="randomized-search" class="slide level2">
<h2>Randomized Search</h2>
<ul>
<li class="fragment"><strong>Large number of combinations </strong>(many hyperparameters, many values)</li>
<li class="fragment">Use <strong>RandomizedSearchCV</strong>:
<ul>
<li class="fragment">Supply <strong>list of values</strong> or <strong>probability distribution</strong> for hyperparameters</li>
<li class="fragment">Specify <strong>number of iterations</strong> (combinations to try)</li>
<li class="fragment">Predictable <strong>execution time</strong></li>
</ul></li>
</ul>

<aside><div>
<p><strong>See</strong>: <a href="https://scikit-learn.org/stable/auto_examples/model_selection/plot_randomized_search.html">Comparing randomized search and grid search for hyperparameter estimation</a>.</p>
</div></aside></section>
<section id="workflow-1" class="slide level2">
<h2>Workflow</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="https://scikit-learn.org/stable/_images/grid_search_workflow.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img data-src="https://scikit-learn.org/stable/_images/grid_search_workflow.png" class="quarto-figure quarto-figure-center" height="475"></a></p>
</figure>
</div>

<aside class="notes">
<p>As the ongoing example illustrates, in addition to evaluating various hyperparameter values, multiple models can also be tested.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<aside><div>
<p><strong>Attribution</strong>: <a href="https://scikit-learn.org/stable/modules/cross_validation.html#cross-validation">Cross-validation: evaluating estimator performance</a></p>
</div></aside></section>
<section id="finally-we-proceed-with-testing" class="slide level2">
<h2>Finally, we proceed with testing</h2>
<div id="ce3a5bb7" class="cell" data-execution_count="18">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a></a>clf <span class="op">=</span> LogisticRegression(max_iter<span class="op">=</span><span class="dv">100</span>, penalty<span class="op">=</span><span class="st">'l2'</span>, solver<span class="op">=</span><span class="st">'newton-cg'</span>, tol<span class="op">=</span><span class="fl">0.001</span>)</span>
<span id="cb32-2"><a></a></span>
<span id="cb32-3"><a></a>clf.fit(X_train, y_train)</span>
<span id="cb32-4"><a></a></span>
<span id="cb32-5"><a></a>y_pred <span class="op">=</span> clf.predict(X_test)</span>
<span id="cb32-6"><a></a></span>
<span id="cb32-7"><a></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report</span>
<span id="cb32-8"><a></a></span>
<span id="cb32-9"><a></a><span class="bu">print</span>(classification_report(y_test, y_pred))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>              precision    recall  f1-score   support

           0       0.83      0.83      0.83        52
           1       0.64      0.64      0.64        25

    accuracy                           0.77        77
   macro avg       0.73      0.73      0.73        77
weighted avg       0.77      0.77      0.77        77
</code></pre>
</div>
</div>

<aside><div>
<p>It appears that we are facing a <strong>class imbalance issue</strong>, which should have been identified earlier in our workflow!</p>
</div></aside></section></section>
<section>
<section id="prologue" class="title-slide slide level1 center">
<h1>Prologue</h1>

</section>
<section id="summary" class="slide level2 smaller">
<h2>Summary</h2>
<ul>
<li><strong>Training Set Size</strong>: Impact on model efficacy and generalization.</li>
<li><strong>Attribute Encoding</strong>: Evaluation of techniques to capture biological phenomena.</li>
<li><strong>Preprocessing</strong>:
<ul>
<li>Data Scaling</li>
<li>Handling Missing Values</li>
<li>Managing Class Imbalance</li>
</ul></li>
</ul>
</section>
<section id="next-lecture" class="slide level2">
<h2>Next lecture</h2>
<ul>
<li>We will further discuss machine learning engineering.</li>
</ul>
</section>
<section id="references" class="slide level2 smaller scrollable">
<h2>References</h2>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Russell:2020aa" class="csl-entry" role="listitem">
Russell, Stuart, and Peter Norvig. 2020. <em>Artificial Intelligence: <span>A</span> Modern Approach</em>. 4th ed. Pearson. <a href="http://aima.cs.berkeley.edu/">http://aima.cs.berkeley.edu/</a>.
</div>
</div>
</section>
<section class="slide level2">

<p>Marcel <strong>Turcotte</strong></p>
<p><a href="mailto:Marcel.Turcotte@uOttawa.ca">Marcel.Turcotte@uOttawa.ca</a></p>
<p>School of Electrical Engineering and <strong>Computer Science</strong> (EE<strong>CS</strong>)</p>
<p>University of Ottawa</p>


</section></section>

    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<p><img src="../../assets/images/uottawa_hor_black.png" class="slide-logo"></p>
<div class="footer footer-default">
<p><a href="https://turcotte.xyz/teaching/csi-4106">turcotte.xyz/teaching/csi-4106</a></p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="../../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
          const outerScaffold = trigger.parentElement.cloneNode(true);
          const codeEl = outerScaffold.querySelector('code');
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp("https:\/\/turcotte\.xyz\/teaching\/csi-4106");
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    <script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
    (function() {
      let previousOnload = window.onload;
      window.onload = () => {
        if (previousOnload) {
          previousOnload();
        }
        lightboxQuarto.on('slide_before_load', (data) => {
          const { slideIndex, slideNode, slideConfig, player, trigger } = data;
          const href = trigger.getAttribute('href');
          if (href !== null) {
            const imgEl = window.document.querySelector(`a[href="${href}"] img`);
            if (imgEl !== null) {
              const srcAttr = imgEl.getAttribute("src");
              if (srcAttr && srcAttr.startsWith("data:")) {
                slideConfig.href = srcAttr;
              }
            }
          } 
        });
      
        lightboxQuarto.on('slide_after_load', (data) => {
          const { slideIndex, slideNode, slideConfig, player, trigger } = data;
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(slideNode);
          }
        });
      
      };
      
    })();
              </script>
    

</body></html>