<!DOCTYPE html>
<html lang="en"><head>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/tabby.min.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-ea385d0e468b0dd5ea5bf0780b1290d9.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.7.33">

  <meta name="author" content="Marcel Turcotte">
  <title>CSI 4106 - Fall 2025 – Logististic regression</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
      margin-bottom: 0em;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/theme/quarto-f563837468303362081e247dddd440d0.css">
  <link href="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
<meta property="og:title" content="Logististic regression – CSI 4106 - Fall 2025">
<meta property="og:description" content="CSI 4106 - Fall 2025">
<meta property="og:site_name" content="CSI 4106 - Fall 2025">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Logististic regression</h1>
  <p class="subtitle">CSI 4106 - Fall 2025</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Marcel Turcotte 
</div>
</div>
</div>

  <p class="date">Version: Sep 17, 2025 15:26</p>
</section>
<section>
<section id="preamble" class="title-slide slide level1 center">
<h1>Preamble</h1>

</section>
<section id="message-of-the-day" class="slide level2 scrollable">
<h2>Message of the Day</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="https://cdn.theatlantic.com/thumbor/e3cWq_N5d7ra9OaF0EH0Qi4yH4E=/0x0:2000x1125/1952x1098/media/img/mt/2025/09/AIA_S2_Ep_9/original.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img data-src="https://cdn.theatlantic.com/thumbor/e3cWq_N5d7ra9OaF0EH0Qi4yH4E=/0x0:2000x1125/1952x1098/media/img/mt/2025/09/AIA_S2_Ep_9/original.jpg" class="quarto-figure quarto-figure-center" height="475"></a></p>
</figure>
</div>

<aside class="notes">
<p>A 30 minutes podcast where Garry Kasparov is joined by cognitive scientist Gary Marcus.</p>
<p><a href="https://www.kasparov.com">Garry Kasparov</a> (b. 1963) is a Russian chess grandmaster and former World Chess Champion, widely regarded as one of the greatest players in history. He held the world’s top ranking for nearly two decades and is also known for his matches against IBM’s Deep Blue and his later political activism and writing.</p>
<p><a href="http://garymarcus.com/">Gary Marcus</a> (b. 1965) is an American cognitive scientist, author, and entrepreneur. He is known for his critiques of deep learning, his work on language acquisition and cognitive development, and for founding several AI startups.</p>
<blockquote>
<p>Kasparov and Marcus agree that AI is a tool—neither inherently utopian nor dystopian—and that the real risks stem from how it is used and by whom. Marcus emphasizes current AI systems still lack genuine understanding; they work by pattern recognition over vast datasets, not by grasping rules or concepts, which leads to alignment problems: machines frequently err or act in unforeseen ways. A major concern is how AI amplifies political deception, surveillance, and information manipulation—tools favored by autocratic or oligarchic interests. On the brighter side, they argue that we are not powerless: democratic societies still have levers—legal regulation, mass action, resistance, insistence on accountability—and might yet steer AI toward benefiting rather than undermining democracy. The default path is dangerous, but with political will, things need not slide irreversibly toward techno-fascism. (Summary generated by ChatGPT 5 on 2025-09-16)</p>
</blockquote>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<aside><div>
<p><a href="https://www.theatlantic.com/podcasts/archive/2025/09/ai-and-the-fight-between-democracy-and-autocracy/684095/">AI and the Rise of Techno-Fascism in the United States</a> by Gary Kasparov, The Atlantic, 2025-09-05. (31m 13s)</p>
</div></aside></section>
<section id="learning-objectives" class="slide level2">
<h2>Learning Objectives</h2>
<ul>
<li><strong>Differentiate</strong> between binary classification and multi-class classification paradigms.</li>
<li><strong>Describe</strong> a methodology for converting multi-class classification problems into binary classification tasks.</li>
<li><strong>Implement</strong> a logistic regression algorithm, focusing on its application in classification problems.</li>
</ul>
</section></section>
<section>
<section id="classification-tasks" class="title-slide slide level1 center">
<h1>Classification tasks</h1>

</section>
<section id="definitions" class="slide level2">
<h2>Definitions</h2>
<ul>
<li class="fragment"><p><strong>Binary classification</strong> is a supervised learning task where the objective is to categorize instances (examples) into one of <strong>two discrete classes</strong>.</p></li>
<li class="fragment"><p>A <strong>multi-class classification</strong> task is a type of supervised learning problem where the objective is to categorize instances into one of <strong>three or more discrete classes</strong>.</p></li>
</ul>

<aside class="notes">
<ul>
<li>An example of a binary classification task is the prediction of disease status using genomic data <span class="citation" data-cites="Wu:2018aa">(<a href="#/references" role="doc-biblioref" onclick="">Wu et al. 2018</a>)</span>.</li>
<li>Researchers often seek to accurately classify the type, subtype, or stage of cancer using gene expression data. For example, in the Pan-Cancer Atlas, specific cancers such as Breast Cancer (BRCA), Colon Adenocarcinoma (COAD), Lung Adenocarcinoma (LUAD), Ovarian Cancer (OV), and Thyroid Cancer (THCA) can be differentiated based on their unique gene expression profiles <span class="citation" data-cites="Alharbi:2023aa">(<a href="#/references" role="doc-biblioref" onclick="">Alharbi and Vakanski 2023</a>)</span>.</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<aside><div>
<p><strong>Caveat</strong>: <strong>Multi-class classification</strong> should not be confused with <strong>multi-label classification</strong>, which allows an instance to be associated with multiple classes. The algorithms designed to address these tasks differ significantly.</p>
</div></aside></section>
<section id="binary-classification" class="slide level2">
<h2>Binary classification</h2>
<ul>
<li class="fragment">Some machine learning algorithms are specifically designed to solve binary classification problems.
<ul>
<li class="fragment"><strong>Logistic regression</strong> and <strong>support vector machines</strong> (SVMs) are such examples.</li>
</ul></li>
</ul>
<aside class="notes">
<p>Later in the presentation, make sure to understand why the logistic regression is specifically designed to solve binary classification problems.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="multi-class-classification" class="slide level2 smaller">
<h2>Multi-class classification</h2>
<ul>
<li class="fragment">Any <strong>multi-class classification problem</strong> can be transformed into a <strong>binary classification problem</strong>.</li>
<li class="fragment"><strong>One-vs-All (OvA)</strong>
<ul>
<li class="fragment">A <strong>separate binary classifier</strong> is trained <strong>for each class</strong>.</li>
<li class="fragment">For each classifier, <strong>one class</strong> is treated as the <strong>positive class</strong>, and <strong>all other classes</strong> are treated as the <strong>negative class</strong>.</li>
<li class="fragment">The <strong>final assignment</strong> of a class label is made based on the classifier that outputs the <strong>highest confidence score</strong> for a given input.</li>
</ul></li>
</ul>

<aside><div>
<p>Scikit-learn offers <a href="https://scikit-learn.org/stable/modules/generated/sklearn.multiclass.OneVsRestClassifier.html#sklearn.multiclass.OneVsRestClassifier"><code>OneVsRestClassifier</code></a>, a utility designed to extend binary classifiers for multi-class classification tasks via the One-vs-Rest strategy.</p>
<p>A complete example will be presented at the end of the lecture.</p>
</div></aside></section></section>
<section>
<section id="logistic-regression" class="title-slide slide level1 center">
<h1>Logistic Regression</h1>

</section>
<section id="data-and-problem" class="slide level2">
<h2>Data and Problem</h2>
<ul>
<li><strong>Dataset</strong>: Palmer Penguins</li>
<li><strong>Task</strong>: Binary classification to distinguish Gentoo penguins from non-Gentoo species</li>
<li><strong>Feature of Interest</strong>: Flipper length</li>
</ul>
</section>
<section id="histogram" class="slide level2">
<h2>Histogram</h2>
<div id="f2f4ba31" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-4"><a></a></span>
<span id="cb1-5"><a></a><span class="cf">try</span>:</span>
<span id="cb1-6"><a></a>    <span class="im">from</span> palmerpenguins <span class="im">import</span> load_penguins</span>
<span id="cb1-7"><a></a><span class="cf">except</span> <span class="pp">ImportError</span>:</span>
<span id="cb1-8"><a></a>    <span class="op">!</span> pip install palmerpenguins</span>
<span id="cb1-9"><a></a>    <span class="im">from</span> palmerpenguins <span class="im">import</span> load_penguins</span>
<span id="cb1-10"><a></a></span>
<span id="cb1-11"><a></a><span class="co"># Load the Palmer Penguins dataset</span></span>
<span id="cb1-12"><a></a>df <span class="op">=</span> load_penguins()</span>
<span id="cb1-13"><a></a></span>
<span id="cb1-14"><a></a><span class="co"># Keep only 'flipper_length_mm' and 'species'</span></span>
<span id="cb1-15"><a></a>df <span class="op">=</span> df[[<span class="st">'flipper_length_mm'</span>, <span class="st">'species'</span>]]</span>
<span id="cb1-16"><a></a></span>
<span id="cb1-17"><a></a><span class="co"># Drop rows with missing values (NaNs)</span></span>
<span id="cb1-18"><a></a>df.dropna(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1-19"><a></a></span>
<span id="cb1-20"><a></a><span class="co"># Create a binary label: 1 if Gentoo, 0 otherwise</span></span>
<span id="cb1-21"><a></a>df[<span class="st">'is_gentoo'</span>] <span class="op">=</span> (df[<span class="st">'species'</span>] <span class="op">==</span> <span class="st">'Gentoo'</span>).astype(<span class="bu">int</span>)</span>
<span id="cb1-22"><a></a></span>
<span id="cb1-23"><a></a><span class="co"># Separate features (X) and labels (y)</span></span>
<span id="cb1-24"><a></a>X <span class="op">=</span> df[[<span class="st">'flipper_length_mm'</span>]]</span>
<span id="cb1-25"><a></a>y <span class="op">=</span> df[<span class="st">'is_gentoo'</span>]</span>
<span id="cb1-26"><a></a></span>
<span id="cb1-27"><a></a><span class="co"># Plot the distribution of flipper lengths by binary species label</span></span>
<span id="cb1-28"><a></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb1-29"><a></a>sns.histplot(data<span class="op">=</span>df, x<span class="op">=</span><span class="st">'flipper_length_mm'</span>, hue<span class="op">=</span><span class="st">'is_gentoo'</span>, kde<span class="op">=</span><span class="va">True</span>, bins<span class="op">=</span><span class="dv">30</span>, palette<span class="op">=</span><span class="st">'Set1'</span>)</span>
<span id="cb1-30"><a></a>plt.title(<span class="st">'Distribution of Flipper Length (Gentoo vs. Others)'</span>)</span>
<span id="cb1-31"><a></a>plt.xlabel(<span class="st">'Flipper Length (mm)'</span>)</span>
<span id="cb1-32"><a></a>plt.ylabel(<span class="st">'Frequency'</span>)</span>
<span id="cb1-33"><a></a>plt.legend(title<span class="op">=</span><span class="st">'Species'</span>, labels<span class="op">=</span>[<span class="st">'Gentoo'</span>, <span class="st">'Non Gentoo'</span>])</span>
<span id="cb1-34"><a></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="slides_files/figure-revealjs/cell-2-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img data-src="slides_files/figure-revealjs/cell-2-output-1.png" class="quarto-figure quarto-figure-center" width="808" height="523"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="logistic-logit-regression" class="slide level2">
<h2>Logistic (Logit) Regression</h2>
<ul>
<li class="fragment"><p>Despite its name, <strong>logistic regression</strong> serves as a <strong>classification</strong> algorithm rather than a regression technique.</p></li>
<li class="fragment"><p>The <strong>labels</strong> in logistic regression are binary values, denoted as <span class="math inline">\(y_i \in \{0,1\}\)</span>, making it a <strong>binary classification task</strong>.</p></li>
<li class="fragment"><p>The primary objective of logistic regression is to determine the <strong>probability</strong> that a given instance <span class="math inline">\(x_i\)</span> belongs to the <strong>positive class</strong>, i.e., <span class="math inline">\(y_i = 1\)</span>.</p></li>
</ul>
<aside class="notes">
<p>The representation of the two classes, <strong>negative</strong> and <strong>positive</strong>, by the values 0 and 1, respectively, is not arbitrary. This choice is intrinsically connected to our objective of determining the <strong>probability</strong> that an instance <span class="math inline">\(x_i\)</span> belongs to the positive class.</p>
<p>While this learning algorithm may initially seem unremarkable, it is essential to continue engaging with it, as logistic regression will later prove to be crucial in the discussion on artificial neural networks.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="model" class="slide level2">
<h2>Model</h2>
<ul>
<li class="fragment"><strong>General Case:</strong> <span class="math inline">\(P(y = k | x, \theta)\)</span>, where <span class="math inline">\(k\)</span> is a class label.</li>
<li class="fragment"><strong>Binary Case</strong>: <span class="math inline">\(y \in {0,1}\)</span>
<ul>
<li class="fragment"><strong>Predict</strong> <span class="math inline">\(P(y = 1 | x, \theta)\)</span></li>
</ul></li>
</ul>
</section>
<section id="visualizing-our-data" class="slide level2">
<h2>Visualizing our data</h2>
<div id="3cb9d4db" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a></a><span class="co"># Scatter plot of flipper length vs. binary label (Gentoo or Not Gentoo)</span></span>
<span id="cb2-2"><a></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb2-3"><a></a></span>
<span id="cb2-4"><a></a><span class="co"># Plot points labeled as Gentoo (is_gentoo = 1)</span></span>
<span id="cb2-5"><a></a>plt.scatter(</span>
<span id="cb2-6"><a></a>    df.loc[df[<span class="st">'is_gentoo'</span>] <span class="op">==</span> <span class="dv">1</span>, <span class="st">'flipper_length_mm'</span>],</span>
<span id="cb2-7"><a></a>    df.loc[df[<span class="st">'is_gentoo'</span>] <span class="op">==</span> <span class="dv">1</span>, <span class="st">'is_gentoo'</span>],</span>
<span id="cb2-8"><a></a>    color<span class="op">=</span><span class="st">'blue'</span>,</span>
<span id="cb2-9"><a></a>    label<span class="op">=</span><span class="st">'Gentoo'</span></span>
<span id="cb2-10"><a></a>)</span>
<span id="cb2-11"><a></a></span>
<span id="cb2-12"><a></a><span class="co"># Plot points labeled as Not Gentoo (is_gentoo = 0)</span></span>
<span id="cb2-13"><a></a>plt.scatter(</span>
<span id="cb2-14"><a></a>    df.loc[df[<span class="st">'is_gentoo'</span>] <span class="op">==</span> <span class="dv">0</span>, <span class="st">'flipper_length_mm'</span>],</span>
<span id="cb2-15"><a></a>    df.loc[df[<span class="st">'is_gentoo'</span>] <span class="op">==</span> <span class="dv">0</span>, <span class="st">'is_gentoo'</span>],</span>
<span id="cb2-16"><a></a>    color<span class="op">=</span><span class="st">'red'</span>,</span>
<span id="cb2-17"><a></a>    label<span class="op">=</span><span class="st">'Not Gentoo'</span></span>
<span id="cb2-18"><a></a>)</span>
<span id="cb2-19"><a></a></span>
<span id="cb2-20"><a></a>plt.title(<span class="st">'Flipper Length vs. Gentoo Indicator'</span>)</span>
<span id="cb2-21"><a></a>plt.xlabel(<span class="st">'Flipper Length (mm)'</span>)</span>
<span id="cb2-22"><a></a>plt.ylabel(<span class="st">'Binary Label (1 = Gentoo, 0 = Not Gentoo)'</span>)</span>
<span id="cb2-23"><a></a>plt.legend(loc<span class="op">=</span><span class="st">'best'</span>)</span>
<span id="cb2-24"><a></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb2-25"><a></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="slides_files/figure-revealjs/cell-3-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img data-src="slides_files/figure-revealjs/cell-3-output-1.png" class="quarto-figure quarto-figure-center" width="812" height="523"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="intuition" class="slide level2">
<h2>Intuition</h2>
<p>Fitting a linear regression is not the answer, but <span class="math inline">\(\ldots\)</span></p>
<div id="8c459bd0" class="cell" data-execution_count="3">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression</span>
<span id="cb3-2"><a></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb3-3"><a></a></span>
<span id="cb3-4"><a></a>lin_reg <span class="op">=</span> LinearRegression()</span>
<span id="cb3-5"><a></a>lin_reg.fit(X, y)</span>
<span id="cb3-6"><a></a></span>
<span id="cb3-7"><a></a>X_new <span class="op">=</span> pd.DataFrame([X.<span class="bu">min</span>(), X.<span class="bu">max</span>()], columns<span class="op">=</span>X.columns)</span>
<span id="cb3-8"><a></a></span>
<span id="cb3-9"><a></a>y_pred <span class="op">=</span> lin_reg.predict(X_new)</span>
<span id="cb3-10"><a></a></span>
<span id="cb3-11"><a></a><span class="co"># Plot the scatter plot</span></span>
<span id="cb3-12"><a></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">5</span>, <span class="dv">3</span>))</span>
<span id="cb3-13"><a></a>plt.scatter(X, y, c<span class="op">=</span>y, cmap<span class="op">=</span><span class="st">'bwr'</span>, edgecolor<span class="op">=</span><span class="st">'k'</span>)</span>
<span id="cb3-14"><a></a>plt.plot(X_new, y_pred, <span class="st">"r-"</span>)</span>
<span id="cb3-15"><a></a>plt.xlabel(<span class="st">'Flipper Length (mm)'</span>)</span>
<span id="cb3-16"><a></a>plt.ylabel(<span class="st">'Binary Label (Gentoo or Not Gentoo)'</span>)</span>
<span id="cb3-17"><a></a>plt.title(<span class="st">'Flipper Length vs. Binary Label (Gentoo or Not Gentoo)'</span>)</span>
<span id="cb3-18"><a></a>plt.yticks([<span class="dv">0</span>, <span class="dv">1</span>], [<span class="st">'Not Gentoo'</span>, <span class="st">'Gentoo'</span>])</span>
<span id="cb3-19"><a></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb3-20"><a></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="slides_files/figure-revealjs/cell-4-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img data-src="slides_files/figure-revealjs/cell-4-output-1.png" class="quarto-figure quarto-figure-center" width="530" height="302"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="intuition-continued" class="slide level2">
<h2>Intuition (continued)</h2>
<div class="columns">
<div class="column" style="width:35%;">
<div id="067cf97f" class="cell" data-execution_count="4">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="slides_files/figure-revealjs/cell-5-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img data-src="slides_files/figure-revealjs/cell-5-output-1.png" class="quarto-figure quarto-figure-center" width="530" height="302"></a></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:65%;">
<ul>
<li class="fragment"><p>A high <strong><code>flipper_length_mm</code></strong> typically results in a model output approaching 1.</p></li>
<li class="fragment"><p>Conversely, a low <strong><code>flipper_length_mm</code></strong> generally yields a model output near 0.</p></li>
<li class="fragment"><p>Notably, the model outputs are not confined to the [0, 1] interval and may occasionally fall below 0 or surpass 1.</p></li>
</ul>
</div></div>
</section>
<section id="intuition-continued-1" class="slide level2">
<h2>Intuition (continued)</h2>
<div class="columns">
<div class="column" style="width:35%;">
<div id="ac8b7d20" class="cell" data-execution_count="5">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="slides_files/figure-revealjs/cell-6-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img data-src="slides_files/figure-revealjs/cell-6-output-1.png" class="quarto-figure quarto-figure-center" width="530" height="302"></a></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:65%;">
<ul>
<li class="fragment">For a <strong>single feature</strong>, the decision boundary is a <strong>specific point</strong>.</li>
<li class="fragment">In this case, the <strong>decision boundary</strong> is approximately 205.</li>
</ul>
</div></div>
</section>
<section id="intuition-continued-2" class="slide level2">
<h2>Intuition (continued)</h2>
<div class="columns">
<div class="column" style="width:35%;">
<div id="90fff76d" class="cell" data-execution_count="7">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="slides_files/figure-revealjs/cell-8-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img data-src="slides_files/figure-revealjs/cell-8-output-1.png" class="quarto-figure quarto-figure-center" width="530" height="302"></a></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:65%;">
<ul>
<li class="fragment">As <strong><code>flipper_length_mm</code></strong> increases from 205 to 230, confidence in classifying the example as Gentoo rises.</li>
<li class="fragment">Conversely, as <strong><code>flipper_length_mm</code></strong> decreases from 205 to 170, confidence in classifying the example as non-Gentoo rises.</li>
</ul>
</div></div>
</section>
<section id="intuition-continued-3" class="slide level2">
<h2>Intuition (continued)</h2>
<div class="columns">
<div class="column" style="width:35%;">
<div id="6d42f44a" class="cell" data-execution_count="8">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="slides_files/figure-revealjs/cell-9-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img data-src="slides_files/figure-revealjs/cell-9-output-1.png" class="quarto-figure quarto-figure-center" width="530" height="302"></a></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:65%;">
<ul>
<li class="fragment">For <strong>values near the decision boundary</strong>, 205, some examples classify as Gentoo while others do not, leading to a classification uncertainty comparable to a coin flip (<strong>0.5 probability</strong>).</li>
</ul>
</div></div>
</section></section>
<section>
<section id="logistic-function" class="title-slide slide level1 center">
<h1>Logistic Function</h1>

</section>
<section id="logistic-function-1" class="slide level2">
<h2>Logistic Function</h2>
<div class="columns">
<div class="column" style="width:40%;">
<p>In mathematics, the <strong>standard logistic function</strong> maps a real-valued input from <span class="math inline">\(\mathbb{R}\)</span> to the open interval <span class="math inline">\((0,1)\)</span>. The function is defined as:</p>
<p><span class="math display">\[
  \sigma(t) = \frac{1}{1+e^{-t}}
\]</span></p>
</div><div class="column" style="width:60%;">
<div id="93e3312a" class="cell" data-execution_count="9">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a></a><span class="co"># Sigmoid function</span></span>
<span id="cb4-2"><a></a><span class="kw">def</span> sigmoid(t):</span>
<span id="cb4-3"><a></a>    <span class="cf">return</span> <span class="dv">1</span> <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> np.exp(<span class="op">-</span>t))</span>
<span id="cb4-4"><a></a></span>
<span id="cb4-5"><a></a><span class="co"># Generate t values</span></span>
<span id="cb4-6"><a></a>t <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">1000</span>)</span>
<span id="cb4-7"><a></a></span>
<span id="cb4-8"><a></a><span class="co"># Compute y values for the sigmoid function</span></span>
<span id="cb4-9"><a></a>sigma <span class="op">=</span> sigmoid(t)</span>
<span id="cb4-10"><a></a></span>
<span id="cb4-11"><a></a><span class="co"># Create a figure</span></span>
<span id="cb4-12"><a></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb4-13"><a></a>ax.plot(t, sigma, color<span class="op">=</span><span class="st">'blue'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)  <span class="co"># Keep the curve opaque</span></span>
<span id="cb4-14"><a></a></span>
<span id="cb4-15"><a></a><span class="co"># Draw vertical axis at x = 0</span></span>
<span id="cb4-16"><a></a>ax.axvline(x<span class="op">=</span><span class="dv">0</span>, color<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb4-17"><a></a></span>
<span id="cb4-18"><a></a><span class="co"># Add labels on the vertical axis</span></span>
<span id="cb4-19"><a></a>ax.set_yticks([<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="fl">1.0</span>])</span>
<span id="cb4-20"><a></a></span>
<span id="cb4-21"><a></a><span class="co"># Add labels to the axes</span></span>
<span id="cb4-22"><a></a>ax.set_xlabel(<span class="st">'t'</span>)</span>
<span id="cb4-23"><a></a>ax.set_ylabel(<span class="vs">r'</span><span class="dv">$\s</span><span class="vs">igma</span><span class="kw">(</span><span class="vs">t</span><span class="kw">)</span><span class="dv">$</span><span class="vs">'</span>)</span>
<span id="cb4-24"><a></a></span>
<span id="cb4-25"><a></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb4-26"><a></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="slides_files/figure-revealjs/cell-10-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img data-src="slides_files/figure-revealjs/cell-10-output-1.png" class="quarto-figure quarto-figure-center" width="813" height="429"></a></p>
</figure>
</div>
</div>
</div>
</div></div>
<aside class="notes">
<ul>
<li>When the input variable <span class="math inline">\(t\)</span> is 0, the output of the logistic function is 0.5.
<ul>
<li>Indeed, <span class="math inline">\(e^{-t} = {e^0} = 1\)</span> and thus <span class="math inline">\(\frac{1}{1+e^{-t}} = \frac{1}{1+1}= \frac{1}{2}.\)</span></li>
</ul></li>
<li>As <span class="math inline">\(t\)</span> increases, the output value approaches 1.
<ul>
<li>As <span class="math inline">\(t \to \infty\)</span>, <span class="math inline">\(e^{-t} \to 0\)</span>.</li>
</ul></li>
<li>Conversely, as <span class="math inline">\(t\)</span> becomes more negative, the output value approaches 0.
<ul>
<li>As <span class="math inline">\(t \to -\infty\)</span>, <span class="math inline">\(e^{-t} \to \infty\)</span> (the two negative signs cancel out).</li>
</ul></li>
<li>The standard logistic function is also commonly referred to as the <strong>sigmoid</strong> function.</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="logistic-regression-intuition" class="slide level2 smaller">
<h2>Logistic Regression (intuition)</h2>
<div class="columns">
<div class="column" style="width:65%;">
<div id="2f419877" class="cell" data-execution_count="10">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="slides_files/figure-revealjs/cell-11-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10"><img data-src="slides_files/figure-revealjs/cell-11-output-1.png" class="quarto-figure quarto-figure-center" width="495" height="356"></a></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:35%;">
<div id="f2e758c2" class="cell" data-execution_count="11">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="slides_files/figure-revealjs/cell-12-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11"><img data-src="slides_files/figure-revealjs/cell-12-output-1.png" class="quarto-figure quarto-figure-center" width="516" height="356"></a></p>
</figure>
</div>
</div>
</div>
</div></div>
<ul>
<li class="fragment">When the <strong>distance to the decision boundary</strong> is <strong>zero</strong>, uncertainty is high, making a probability of <strong>0.5</strong> appropriate.</li>
<li class="fragment">As we move <strong>away from the decision boundary</strong>, confidence increases, warranting <strong>higher</strong> or <strong>lower</strong> probabilities accordingly.</li>
</ul>
</section>
<section id="logistic-function-2" class="slide level2">
<h2>Logistic function</h2>
<div class="columns">
<div class="column" style="width:60%;">
<p>An S-shaped curve, such as the standard logistic function (aka <strong>sigmoid</strong>), is termed a <strong>squashing function</strong> because it maps a wide input domain to a constrained output range.</p>
<p><span class="math display">\[
  \sigma(t) = \frac{1}{1+e^{-t}}
\]</span></p>
</div><div class="column" style="width:40%;">
<div id="070e9b77" class="cell" data-execution_count="12">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a></a><span class="co"># Create a figure</span></span>
<span id="cb5-2"><a></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb5-3"><a></a>ax.plot(t, sigma, color<span class="op">=</span><span class="st">'blue'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)  <span class="co"># Keep the curve opaque</span></span>
<span id="cb5-4"><a></a></span>
<span id="cb5-5"><a></a><span class="co"># Draw vertical axis at x = 0</span></span>
<span id="cb5-6"><a></a>ax.axvline(x<span class="op">=</span><span class="dv">0</span>, color<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb5-7"><a></a></span>
<span id="cb5-8"><a></a><span class="co"># Add labels on the vertical axis</span></span>
<span id="cb5-9"><a></a>ax.set_yticks([<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="fl">1.0</span>])</span>
<span id="cb5-10"><a></a></span>
<span id="cb5-11"><a></a><span class="co"># Add labels to the axes</span></span>
<span id="cb5-12"><a></a>ax.set_xlabel(<span class="st">'t'</span>)</span>
<span id="cb5-13"><a></a>ax.set_ylabel(<span class="vs">r'</span><span class="dv">$\s</span><span class="vs">igma</span><span class="kw">(</span><span class="vs">t</span><span class="kw">)</span><span class="dv">$</span><span class="vs">'</span>)</span>
<span id="cb5-14"><a></a></span>
<span id="cb5-15"><a></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb5-16"><a></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="slides_files/figure-revealjs/cell-13-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12"><img data-src="slides_files/figure-revealjs/cell-13-output-1.png" class="quarto-figure quarto-figure-center" width="813" height="429"></a></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="logistic-logit-regression-1" class="slide level2">
<h2>Logistic (Logit) Regression</h2>
<ul>
<li class="fragment"><p>Analogous to <strong>linear regression</strong>, <strong>logistic regression</strong> computes a weighted sum of the input features, expressed as: <span class="math display">\[
\theta_0 + \theta_1 x_i^{(1)} + \theta_2 x_i^{(2)} + \ldots + \theta_D x_i^{(D)}
\]</span></p></li>
<li class="fragment"><p>However, using the sigmoid function limits its output to the range <span class="math inline">\((0,1)\)</span>: <span class="math display">\[
\sigma(\theta_0 + \theta_1 x_i^{(1)} + \theta_2 x_i^{(2)} + \ldots + \theta_D x_i^{(D)})
\]</span></p></li>
</ul>
</section>
<section id="notation" class="slide level2">
<h2>Notation</h2>
<ul>
<li class="fragment"><p>Equation for the <strong>logistic regression</strong>: <span class="math display">\[
\sigma(\theta_0 + \theta_1 x_i^{(1)} + \theta_2 x_i^{(2)} + \ldots + \theta_D x_i^{(D)})
\]</span></p></li>
<li class="fragment"><p>Multipling <span class="math inline">\(\theta_0\)</span> (intercept/bias) by 1: <span class="math display">\[
\sigma(\theta_0 \times 1 + \theta_1 x_i^{(1)} + \theta_2 x_i^{(2)} + \ldots + \theta_D x_i^{(D)})
\]</span></p></li>
<li class="fragment"><p>Multipling <span class="math inline">\(\theta_0\)</span> by <span class="math inline">\(x_i^{(0)} = 1\)</span>: <span class="math display">\[
\sigma(\theta_0 x_i^{(0)} + \theta_1 x_i^{(1)} + \theta_2 x_i^{(2)} + \ldots + \theta_D x_i^{(D)})
\]</span></p></li>
</ul>
</section>
<section id="logistic-regression-1" class="slide level2">
<h2>Logistic regression</h2>
<p>The <strong>Logistic Regression</strong> model, in its vectorized form, is defined as:</p>
<p><span class="math display">\[
  h_\theta(x_i) = \sigma(\theta x_i) = \frac{1}{1+e^{- \theta x_i}}
  \]</span></p>

<aside><div>
<p>An extra feature, <span class="math inline">\(x_i^{(0)} = 1\)</span>, has been added to <span class="math inline">\(x_i\)</span>, and <span class="math inline">\(\theta_0\)</span> is the intercept/bias term.</p>
</div></aside></section>
<section id="logistic-regression-two-attributes" class="slide level2">
<h2>Logistic regression (two attributes)</h2>
<div class="columns">
<div class="column" style="width:35%;">
<div id="953222b1" class="cell" data-execution_count="13">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="slides_files/figure-revealjs/cell-14-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13"><img data-src="slides_files/figure-revealjs/cell-14-output-1.png" class="quarto-figure quarto-figure-center" width="750" height="376"></a></p>
</figure>
</div>
</div>
</div>
<p><span class="math display">\[
  h_\theta(x_i) = \sigma(\theta x_i)
\]</span></p>
</div><div class="column" style="width:65%;">
<ul>
<li class="fragment">In logistic regression, <strong>the probability of correctly classifying an example increases as its distance from the decision boundary increases</strong>.</li>
<li class="fragment">This principle holds for both <strong>positive</strong> and <strong>negative</strong> classes.</li>
<li class="fragment">An example lying on the decision boundary has a <strong>50% probability</strong> of belonging to either class.</li>
</ul>
</div></div>
</section>
<section id="logistic-regression-2" class="slide level2">
<h2>Logistic regression</h2>
<ul>
<li><p>The <strong>Logistic Regression</strong> model, in its vectorized form, is defined as:</p>
<p><span class="math display">\[
h_\theta(x_i) = \sigma(\theta x_i) = \frac{1}{1+e^{- \theta x_i}}
\]</span></p></li>
<li><p><strong>Predictions</strong> are made as follows:</p>
<ul>
<li><span class="math inline">\(y_i = 0\)</span>, if <span class="math inline">\(h_\theta(x_i) &lt; 0.5\)</span></li>
<li><span class="math inline">\(y_i = 1\)</span>, if <span class="math inline">\(h_\theta(x_i) \geq 0.5\)</span></li>
</ul></li>
</ul>
<div class="fragment">
<ul>
<li>The values of <span class="math inline">\(\theta\)</span> are learned using <strong>gradient descent</strong>.</li>
</ul>
</div>
</section>
<section class="slide level2">

<iframe data-external="1" src="https://www.youtube.com/embed/yIYKR4sgzI8" width="100%" height="85%" title="StatQuest: Logistic Regression" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>

<aside class="notes">
<p>“StatQuest breaks down complicated Statistics and Machine Learning methods into small, bite-sized pieces that are easy to understand. StatQuest doesn’t dumb down the material, instead, it builds you up so that you are smarter and have a better understanding of Statistics and Machine Learning.” It is often a good place to start to get the intuition to understand statistical and machine learning concepts.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<aside><div>
<p><strong>Attribution</strong>: <a href="https://youtu.be/yIYKR4sgzI8">StatQuest: Logistic Regression</a> by Josh Starmer.</p>
</div></aside></section></section>
<section>
<section id="digits-example" class="title-slide slide level1 center">
<h1>Digits example</h1>

</section>
<section id="yann-lecun" class="slide level2">
<h2>1989 Yann LeCun</h2>
<iframe data-external="1" src="https://www.youtube.com/embed/H0oEr40YhrQ" width="889" height="500" title="Convolutional Network Demo from 1989 [restored version]" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>
</section>
<section id="handwritten-digit-recognition" class="slide level2">
<h2>Handwritten Digit Recognition</h2>
<h3 id="aims">Aims:</h3>
<ul>
<li><p>Developing a <strong>logistic regression model</strong> for the <strong>recognition of handwritten digits</strong>.</p></li>
<li><p>Visualize the <strong>insights</strong> and <strong>patterns</strong> the model has acquired.</p></li>
</ul>

<aside><div>
<p>We are using the <a href="https://archive.ics.uci.edu/dataset/80/optical+recognition+of+handwritten+digits">UCI ML hand-written digits datasets</a>.</p>
</div></aside></section>
<section id="uci-ml-hand-written-digits-datasets" class="slide level2">
<h2>UCI ML hand-written digits datasets</h2>
<p>Loading the dataset</p>
<div id="28813a67" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a></a><span class="im">from</span> sklearn.datasets <span class="im">import</span> load_digits</span>
<span id="cb6-2"><a></a></span>
<span id="cb6-3"><a></a>digits <span class="op">=</span> load_digits()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>What is the type of <code>digits.data</code></p>
<div id="f49b9f68" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a></a><span class="bu">type</span>(digits.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>numpy.ndarray</code></pre>
</div>
</div>

<aside><div>
<p>Developing a <strong>logistic regression model</strong> for the <strong>recognition of handwritten digits</strong>.</p>
</div></aside></section>
<section id="uci-ml-hand-written-digits-datasets-1" class="slide level2">
<h2>UCI ML hand-written digits datasets</h2>
<p>How many examples (<code>N</code>) and how many attributes (<code>D</code>)?</p>
<div id="cd3c87db" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a></a>digits.data.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>(1797, 64)</code></pre>
</div>
</div>
<p>Assigning <code>N</code> and <code>D</code></p>
<div id="70a344f2" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a></a>N, D <span class="op">=</span> digits.data.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>target</code> has the same number of entries (examples) as <code>data</code>?</p>
<div id="64a7daf6" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a></a>digits.target.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>(1797,)</code></pre>
</div>
</div>
</section>
<section id="uci-ml-hand-written-digits-datasets-2" class="slide level2">
<h2>UCI ML hand-written digits datasets</h2>
<p>What are the width and height of those images?</p>
<div id="b89db46e" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a></a>digits.images.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>(1797, 8, 8)</code></pre>
</div>
</div>
<p>Assigning <code>width</code> and <code>height</code></p>
<div id="4536c876" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a></a>_, width, height <span class="op">=</span> digits.images.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="uci-ml-hand-written-digits-datasets-3" class="slide level2">
<h2>UCI ML hand-written digits datasets</h2>
<p>Assigning <code>X</code> and <code>y</code></p>
<div id="15c2b0aa" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a></a>X <span class="op">=</span> digits.data</span>
<span id="cb17-2"><a></a>y <span class="op">=</span> digits.target</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="uci-ml-hand-written-digits-datasets-4" class="slide level2 smaller">
<h2>UCI ML hand-written digits datasets</h2>
<p><code>X[0]</code> is a vector of size <code>width * height = D</code> (<span class="math inline">\(8 \times 8 = 64\)</span>).</p>
<div id="8542165b" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a></a>X[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>array([ 0.,  0.,  5., 13.,  9.,  1.,  0.,  0.,  0.,  0., 13., 15., 10.,
       15.,  5.,  0.,  0.,  3., 15.,  2.,  0., 11.,  8.,  0.,  0.,  4.,
       12.,  0.,  0.,  8.,  8.,  0.,  0.,  5.,  8.,  0.,  0.,  9.,  8.,
        0.,  0.,  4., 11.,  0.,  1., 12.,  7.,  0.,  0.,  2., 14.,  5.,
       10., 12.,  0.,  0.,  0.,  0.,  6., 13., 10.,  0.,  0.,  0.])</code></pre>
</div>
</div>
<div class="fragment">
<p>It corresponds to an <span class="math inline">\(8 \times 8 = 64\)</span> image.</p>
<div id="42725991" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a></a>X[<span class="dv">0</span>].reshape(width, height)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>array([[ 0.,  0.,  5., 13.,  9.,  1.,  0.,  0.],
       [ 0.,  0., 13., 15., 10., 15.,  5.,  0.],
       [ 0.,  3., 15.,  2.,  0., 11.,  8.,  0.],
       [ 0.,  4., 12.,  0.,  0.,  8.,  8.,  0.],
       [ 0.,  5.,  8.,  0.,  0.,  9.,  8.,  0.],
       [ 0.,  4., 11.,  0.,  1., 12.,  7.,  0.],
       [ 0.,  2., 14.,  5., 10., 12.,  0.,  0.],
       [ 0.,  0.,  6., 13., 10.,  0.,  0.,  0.]])</code></pre>
</div>
</div>
</div>
</section>
<section id="uci-ml-hand-written-digits-datasets-5" class="slide level2 smaller">
<h2>UCI ML hand-written digits datasets</h2>
<p>Plot the first <code>n=5</code> examples</p>
<div id="4ef45cca" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb22-2"><a></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb22-3"><a></a></span>
<span id="cb22-4"><a></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">2</span>))</span>
<span id="cb22-5"><a></a>n <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb22-6"><a></a></span>
<span id="cb22-7"><a></a><span class="cf">for</span> index, (image, label) <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="bu">zip</span>(X[<span class="dv">0</span>:n], y[<span class="dv">0</span>:n])):</span>
<span id="cb22-8"><a></a>    plt.subplot(<span class="dv">1</span>, n, index <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb22-9"><a></a>    plt.imshow(np.reshape(image, (width,width)), cmap<span class="op">=</span>plt.cm.gray)</span>
<span id="cb22-10"><a></a>    plt.title(<span class="ss">f'y = </span><span class="sc">{</span>label<span class="sc">}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><a href="slides_files/figure-revealjs/cell-25-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14"><img data-src="slides_files/figure-revealjs/cell-25-output-1.png" width="781" height="190"></a></p>
</figure>
</div>
</div>
</div>
<aside class="notes">
<p>Intensity values close to 0 are represented in black, while high values are represented in white.</p>
<p>Use <code>cmap=plt.cm.binary</code> to invert the images (intensity values close to 0 in white, high values in black).</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="uci-ml-hand-written-digits-datasets-6" class="slide level2 smaller">
<h2>UCI ML hand-written digits datasets</h2>
<div id="3347c934" class="cell" data-execution_count="25">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb23-2"><a></a></span>
<span id="cb23-3"><a></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">2</span>))</span>
<span id="cb23-4"><a></a>n <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb23-5"><a></a></span>
<span id="cb23-6"><a></a><span class="cf">for</span> index, (image, label) <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="bu">zip</span>(X[<span class="dv">0</span>:n], y[<span class="dv">0</span>:n])):</span>
<span id="cb23-7"><a></a>    plt.subplot(<span class="dv">1</span>, n, index <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb23-8"><a></a>    plt.imshow(np.reshape(image, (width,width)), cmap<span class="op">=</span>plt.cm.gray)</span>
<span id="cb23-9"><a></a>    plt.title(<span class="ss">f'y = </span><span class="sc">{</span>label<span class="sc">}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><a href="slides_files/figure-revealjs/cell-26-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15"><img data-src="slides_files/figure-revealjs/cell-26-output-1.png" width="781" height="190"></a></p>
</figure>
</div>
</div>
</div>
<ul>
<li class="fragment"><p>In our dataset, each <span class="math inline">\(x_i\)</span> is an <strong>attribute vector</strong> of size <span class="math inline">\(D = 64\)</span>.</p></li>
<li class="fragment"><p>This vector is formed by concatenating the rows of an <span class="math inline">\(8 \times 8\)</span> image.</p></li>
<li class="fragment"><p>The <code>reshape</code> function is employed to convert this 64-dimensional vector back into its original <span class="math inline">\(8 \times 8\)</span> image format.</p></li>
</ul>
</section>
<section id="uci-ml-hand-written-digits-datasets-7" class="slide level2">
<h2>UCI ML hand-written digits datasets</h2>
<div id="26cd53cb" class="cell" data-execution_count="26">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><a href="slides_files/figure-revealjs/cell-27-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-16"><img data-src="slides_files/figure-revealjs/cell-27-output-1.png" width="781" height="190"></a></p>
</figure>
</div>
</div>
</div>
<ul>
<li class="fragment"><p>We will train <strong>10 classifiers</strong>, each corresponding to a specific digit in a <strong>One-vs-All (OvA)</strong> approach.</p></li>
<li class="fragment"><p>Each classifier will determine the optimal values of <span class="math inline">\(\theta_j\)</span> (associated with the pixel features), allowing it to distinguish one digit from all other digits.</p></li>
</ul>
</section>
<section id="uci-ml-hand-written-digits-datasets-8" class="slide level2">
<h2>UCI ML hand-written digits datasets</h2>
<p>Preparing for our machine learning experiment</p>
<div id="d2d6caf9" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb24-2"><a></a></span>
<span id="cb24-3"><a></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.1</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="uci-ml-hand-written-digits-datasets-9" class="slide level2">
<h2>UCI ML hand-written digits datasets</h2>
<p>Optimization algorithms generally work best when the attributes have similar ranges.</p>
<div id="14b9f0f1" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb25-2"><a></a></span>
<span id="cb25-3"><a></a>scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb25-4"><a></a>X_train <span class="op">=</span> scaler.fit_transform(X_train)</span>
<span id="cb25-5"><a></a>X_test <span class="op">=</span> scaler.transform(X_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

<aside class="notes">
<p>Certain classifiers exhibit suboptimal performance when there are significant variations in feature scales. This issue is particularly pronounced in classifiers that utilize gradient descent for parameter optimization, as they can be adversely affected by discrepancies in feature scale. Consequently, standardization of features is a widely adopted practice to mitigate this problem.</p>
<p><a href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.StandardScaler.html">StandardScaler</a> is a commonly used approach. For a given feature, the values are transformed as follows:</p>
<p><span class="math display">\[
z = (x - \mu) / \sigma
\]</span></p>
<p>where <span class="math inline">\(\mu\)</span> is the average of all the values for that feature for the training data, and <span class="math inline">\(\sigma\)</span> the corresponding standard deviation.</p>
<p>Calling <code>fit</code> forces the scaler to learn the mean and standard deviation of each feature. Calling <code>tranform</code>, applies the transformation onto the designated dataset. Finally, calling <code>fit_transform</code> combines the two steps.</p>
<p>It would be an error to apply <code>fit</code> or <code>fit_transform</code> on the entire dataset, an error called <strong>data leakeage</strong>. Information from the test data would influence the mean and standard deviation learnt by the scaler. The training data would be transformed using information from the test set. The model will learn from training data scaled using information baised by the test set. The test set is no longer independent.</p>
<p>It is paramount to scale the test data. The model has been trained on scaled data, here with mean values centered at zero and standard deviation of 1. The original data was likely on a widely different scale. Imagine a attribute representing the temperature in celcius might have values -40 to 40. Another attribute, this one representing a grade, with values from 0 to 100. The model would produce non sense results on such data. The test data needs to be scaled using the mean and standard deviation from the training data, which represents the frame of reference for its training.</p>
<ol type="1">
<li><p><strong>Fairness in evaluation (no cheating):</strong> If you use the test data to compute the mean and variance, you’re peeking at the answers. Even though it’s “just” a mean and standard deviation, that’s still information from the test set. This breaks the principle that test data should remain completely unseen until evaluation.</p></li>
<li><p><strong>Consistency of distribution:</strong> The model was trained assuming features are centered and scaled using the training distribution. If you scale test data differently (e.g., with its own mean/std), then the numbers the model sees no longer match the distribution it was trained on. It’s like giving the model inputs in a “new language.”</p></li>
<li><p><strong>Deployment perspective:</strong> In real applications, you’ll only ever have the training distribution to compute the scaling parameters. When the model is deployed, you can’t stop time to recompute scaling each time new data arrives — you must apply the fixed transformation learned from the training data.</p></li>
</ol>
<p><strong>“The scaler is part of the model.”</strong> Just like weights in logistic regression, the <code>StandardScaler</code>’s mean and variance are <strong>learned from the training set</strong>. Once learned, they become fixed parameters of your preprocessing pipeline.</p>
<p><strong>“Training vs.&nbsp;exam.”</strong> Training data is your study material; test data is the exam. You can’t look at the exam questions to prepare your notes (using test data for scaling), and you can’t change the exam’s grading scheme midway (scaling test data separately). You must prepare with your study notes (training distribution) and then take the exam under the same scheme.</p>
<p><strong>“Same ruler for everyone.”</strong> Scaling is like using a ruler to measure heights. You calibrate the ruler once with the training data. If you used a different ruler for the test data, the numbers wouldn’t be comparable anymore.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<aside><div>
<p><strong>Discussion</strong>: importance of applying <code>fit_transform</code> only to <code>X_train</code>.</p>
</div></aside></section>
<section id="uci-ml-hand-written-digits-datasets-10" class="slide level2">
<h2>UCI ML hand-written digits datasets</h2>
<div id="9c6a5988" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb26-2"><a></a><span class="im">from</span> sklearn.multiclass <span class="im">import</span> OneVsRestClassifier</span>
<span id="cb26-3"><a></a></span>
<span id="cb26-4"><a></a>clf <span class="op">=</span> OneVsRestClassifier(LogisticRegression())</span>
<span id="cb26-5"><a></a>clf <span class="op">=</span> clf.fit(X_train, y_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

<aside class="notes">
<p>Each logistic regression finds a <strong>hyperplane</strong> in a <strong>64-dimensional space</strong> that separates the data into two classes.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<aside><div>
<p>Asking the classifier to solve a multiclass task, using <strong>one-vs-rest (OvR)</strong>, aka OvA. Classfiers in <code>sklearn</code> have <a href="https://scikit-learn.org/stable/modules/multiclass.html">multi-learning support</a> built-in.</p>
</div></aside></section>
<section id="uci-ml-hand-written-digits-datasets-11" class="slide level2 smaller">
<h2>UCI ML hand-written digits datasets</h2>
<p>Applying the classifier to our test set</p>
<div id="af7438fc" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report</span>
<span id="cb27-2"><a></a></span>
<span id="cb27-3"><a></a>y_pred <span class="op">=</span> clf.predict(X_test)</span>
<span id="cb27-4"><a></a></span>
<span id="cb27-5"><a></a><span class="bu">print</span>(classification_report(y_test, y_pred))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              precision    recall  f1-score   support

           0       1.00      1.00      1.00        17
           1       1.00      1.00      1.00        11
           2       1.00      1.00      1.00        17
           3       1.00      0.94      0.97        17
           4       1.00      1.00      1.00        25
           5       0.96      1.00      0.98        22
           6       1.00      1.00      1.00        19
           7       1.00      0.95      0.97        19
           8       0.80      1.00      0.89         8
           9       0.96      0.92      0.94        25

    accuracy                           0.98       180
   macro avg       0.97      0.98      0.97       180
weighted avg       0.98      0.98      0.98       180
</code></pre>
</div>
</div>
</section>
<section id="visualization" class="slide level2">
<h2>Visualization</h2>
<p>How many classes?</p>
<div id="85314d6d" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a></a>clf.classes_</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])</code></pre>
</div>
</div>
<div class="fragment">
<p>The coefficients and intercepts are in distinct arrays.</p>
<div id="c28f579b" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a></a>(clf.estimators_[<span class="dv">0</span>].coef_.shape, clf.estimators_[<span class="dv">0</span>].intercept_.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>((1, 64), (1,))</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p>Intercepts are <span class="math inline">\(\theta_0\)</span>, where as coefficents are <span class="math inline">\(\theta_j, j \in [1,64]\)</span>.</p>

</div>
<aside><div>
<p>Adapted from <a href="https://atmamani.github.io/projects/ml/mnist-digits-classification-using-logistic-regression-scikit-learn/">MNIST digits classification using Logistic regression in Scikit-Learn</a>, visited 2024-09-23.</p>
</div></aside></section>
<section id="visualization-1" class="slide level2">
<h2>Visualization</h2>
<div id="7bca1a95" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a></a>clf.estimators_[<span class="dv">0</span>].coef_[<span class="dv">0</span>].<span class="bu">round</span>(<span class="dv">2</span>).reshape(width, height)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>array([[ 0.  , -0.25,  0.04,  0.21,  0.02, -0.58, -0.36, -0.05],
       [ 0.  , -0.39,  0.04,  0.43,  0.53,  0.72, -0.03, -0.12],
       [-0.03,  0.19,  0.28, -0.04, -0.94,  0.84, -0.01, -0.06],
       [-0.04,  0.27,  0.26, -0.57, -1.75,  0.24,  0.07, -0.03],
       [ 0.  ,  0.32,  0.57, -0.58, -1.62, -0.15,  0.17,  0.  ],
       [-0.08, -0.13,  0.92, -0.85, -0.83, -0.01,  0.22, -0.  ],
       [-0.04, -0.36,  0.61, -0.14,  0.28,  0.01, -0.37, -0.41],
       [ 0.01, -0.31, -0.31,  0.54, -0.32, -0.18, -0.32, -0.21]])</code></pre>
</div>
</div>
</section>
<section id="visualization-2" class="slide level2">
<h2>Visualization</h2>
<div id="47d2ef7b" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a></a>coef <span class="op">=</span> clf.estimators_[<span class="dv">0</span>].coef_</span>
<span id="cb35-2"><a></a>plt.imshow(coef[<span class="dv">0</span>].reshape(width,height))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><a href="slides_files/figure-revealjs/cell-35-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-17"><img data-src="slides_files/figure-revealjs/cell-35-output-1.png" width="407" height="411"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="visualization-3" class="slide level2">
<h2>Visualization</h2>
<div id="157dea26" class="cell" data-execution_count="35">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">5</span>))</span>
<span id="cb36-2"><a></a></span>
<span id="cb36-3"><a></a><span class="cf">for</span> index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(clf.classes_)):</span>
<span id="cb36-4"><a></a>    plt.subplot(<span class="dv">2</span>, <span class="dv">5</span>, index <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb36-5"><a></a>    plt.title(<span class="ss">f'y = </span><span class="sc">{</span>clf<span class="sc">.</span>classes_[index]<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb36-6"><a></a>    plt.imshow(clf.estimators_[index].coef_.reshape(width,width), </span>
<span id="cb36-7"><a></a>               cmap<span class="op">=</span>plt.cm.RdBu)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><a href="slides_files/figure-revealjs/cell-36-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-18"><img data-src="slides_files/figure-revealjs/cell-36-output-1.png" width="781" height="391"></a></p>
</figure>
</div>
</div>
</div>
<aside class="notes">
<p>Each <code>LogisticRegression</code> learns 64 <span class="math inline">\(\theta_i\)</span> parameters.</p>
<p>In the images above, red pixels correspond to negative coefficients, while blue pixels correspond to positive coefficients.</p>
<p>For the first classifier, which predicts the digit ‘0’, the model assigns negative weights to high-intensity pixels in the center of the image and positive weights to high-intensity pixels in the oval region surrounding the center.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="visualization-4" class="slide level2">
<h2>Visualization</h2>
<div id="f1409d08" class="cell" data-execution_count="36">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">5</span>))</span>
<span id="cb37-2"><a></a></span>
<span id="cb37-3"><a></a><span class="cf">for</span> index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(clf.classes_)):</span>
<span id="cb37-4"><a></a>    plt.subplot(<span class="dv">2</span>, <span class="dv">5</span>, index <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb37-5"><a></a>    plt.title(<span class="ss">f'y = </span><span class="sc">{</span>clf<span class="sc">.</span>classes_[index]<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb37-6"><a></a>    plt.imshow(clf.estimators_[index].coef_.reshape(width,width), </span>
<span id="cb37-7"><a></a>               cmap<span class="op">=</span>plt.cm.RdBu,</span>
<span id="cb37-8"><a></a>               interpolation<span class="op">=</span><span class="st">'bilinear'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><a href="slides_files/figure-revealjs/cell-37-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-19"><img data-src="slides_files/figure-revealjs/cell-37-output-1.png" width="781" height="391"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section class="slide level2">

<iframe data-external="1" src="https://www.youtube.com/embed/AX-ZEC-71DI" width="100%" height="85%" title="Machine Learning and Logistic Regression" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>

<aside><div>
<p><strong>Attribution</strong>: <a href="https://youtu.be/AX-ZEC-71DI">Machine Learning and Logistic Regression</a>, IBM Technology, 2024-07-19.</p>
</div></aside></section></section>
<section>
<section id="prologue" class="title-slide slide level1 center">
<h1>Prologue</h1>

</section>
<section id="references" class="slide level2 smaller scrollable">
<h2>References</h2>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Alharbi:2023aa" class="csl-entry" role="listitem">
Alharbi, Fadi, and Aleksandar Vakanski. 2023. <span>“<span class="nocase">Machine Learning Methods for Cancer Classification Using Gene Expression Data: A Review</span>.”</span> <em>Bioengineering</em> 10 (2): 173. <a href="https://doi.org/10.3390/bioengineering10020173">https://doi.org/10.3390/bioengineering10020173</a>.
</div>
<div id="ref-Russell:2020aa" class="csl-entry" role="listitem">
Russell, Stuart, and Peter Norvig. 2020. <em>Artificial Intelligence: <span>A</span> Modern Approach</em>. 4th ed. Pearson. <a href="http://aima.cs.berkeley.edu/">http://aima.cs.berkeley.edu/</a>.
</div>
<div id="ref-Wu:2018aa" class="csl-entry" role="listitem">
Wu, Qianfan, Adel Boueiz, Alican Bozkurt, Arya Masoomi, Allan Wang, Dawn L DeMeo, Scott T Weiss, and Weiliang Qiu. 2018. <span>“<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6530791"><span class="nocase">Deep Learning Methods for Predicting Disease Status Using Genomic Data</span></a>.”</span> <em>Journal of Biometrics &amp; Biostatistics</em> 9 (5).
</div>
</div>
</section>
<section id="resources" class="slide level2">
<h2>Resources</h2>
<ul>
<li><a href="https://scikit-learn.org/stable/auto_examples/linear_model/plot_iris_logistic.html">Logistic Regression 3-class Classifier</a> from <code>sklearn</code></li>
</ul>
</section>
<section id="next-lecture" class="slide level2">
<h2>Next lecture</h2>
<ul>
<li>Negative log-likelihood, geometric interpretation, implementation</li>
</ul>
</section></section>
<section>
<section id="one-vs-all" class="title-slide slide level1 center">
<h1>One-vs-All</h1>

</section>
<section id="one-vs-all-classifier-complete" class="slide level2">
<h2>One-vs-All classifier (complete)</h2>
<div id="3efe7a4d" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a></a><span class="im">from</span> sklearn.datasets <span class="im">import</span> load_iris</span>
<span id="cb38-2"><a></a></span>
<span id="cb38-3"><a></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb38-4"><a></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> label_binarize</span>
<span id="cb38-5"><a></a></span>
<span id="cb38-6"><a></a><span class="co"># Load the Iris dataset</span></span>
<span id="cb38-7"><a></a>iris <span class="op">=</span> load_iris()</span>
<span id="cb38-8"><a></a>X, y <span class="op">=</span> iris.data, iris.target</span>
<span id="cb38-9"><a></a></span>
<span id="cb38-10"><a></a><span class="co"># Binarize the output</span></span>
<span id="cb38-11"><a></a>y_bin <span class="op">=</span> label_binarize(y, classes<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>])</span>
<span id="cb38-12"><a></a></span>
<span id="cb38-13"><a></a><span class="co"># Split the dataset into training and testing sets</span></span>
<span id="cb38-14"><a></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y_bin, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="one-vs-all-classifier-complete-1" class="slide level2">
<h2>One-vs-All classifier (complete)</h2>
<div id="a7ce73f4" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a></a><span class="co"># Train a One-vs-All classifier for each class</span></span>
<span id="cb39-2"><a></a></span>
<span id="cb39-3"><a></a>classifiers <span class="op">=</span> []</span>
<span id="cb39-4"><a></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>):</span>
<span id="cb39-5"><a></a>    clf <span class="op">=</span> LogisticRegression()</span>
<span id="cb39-6"><a></a>    clf.fit(X_train, y_train[:, i])</span>
<span id="cb39-7"><a></a>    classifiers.append(clf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

<aside><div>
<p>Each logistic regression finds a <strong>hyperplane</strong> in a <strong>4-dimensional space</strong> that separates the data into two classes.</p>
</div></aside></section>
<section id="one-vs-all-classifier-complete-2" class="slide level2">
<h2>One-vs-All classifier (complete)</h2>
<div id="2e46e270" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a></a><span class="co"># Predict on a new sample</span></span>
<span id="cb40-2"><a></a>new_sample <span class="op">=</span> X_test[<span class="dv">0</span>].reshape(<span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb40-3"><a></a>confidences <span class="op">=</span> [clf.decision_function(new_sample) <span class="cf">for</span> clf <span class="kw">in</span> classifiers]</span>
<span id="cb40-4"><a></a></span>
<span id="cb40-5"><a></a><span class="co"># Final assignment</span></span>
<span id="cb40-6"><a></a>final_class <span class="op">=</span> np.argmax(confidences)</span>
<span id="cb40-7"><a></a></span>
<span id="cb40-8"><a></a><span class="co"># Printing the result</span></span>
<span id="cb40-9"><a></a><span class="bu">print</span>(<span class="ss">f"Final class assigned: </span><span class="sc">{</span>iris<span class="sc">.</span>target_names[final_class]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb40-10"><a></a><span class="bu">print</span>(<span class="ss">f"True class: </span><span class="sc">{</span>iris<span class="sc">.</span>target_names[np.argmax(y_test[<span class="dv">0</span>])]<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Final class assigned: versicolor
True class: versicolor</code></pre>
</div>
</div>
</section>
<section id="label_binarized" class="slide level2 smaller">
<h2><code>label_binarized</code></h2>
<div id="7805756b" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> label_binarize</span>
<span id="cb42-2"><a></a></span>
<span id="cb42-3"><a></a><span class="co"># Original class labels</span></span>
<span id="cb42-4"><a></a>y_train <span class="op">=</span> np.array([<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>])</span>
<span id="cb42-5"><a></a></span>
<span id="cb42-6"><a></a><span class="co"># Binarize the labels</span></span>
<span id="cb42-7"><a></a>y_train_binarized <span class="op">=</span> label_binarize(y_train, classes<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>])</span>
<span id="cb42-8"><a></a></span>
<span id="cb42-9"><a></a><span class="co"># Assume y_train_binarized contains the binarized labels</span></span>
<span id="cb42-10"><a></a><span class="bu">print</span>(<span class="st">"Binarized labels:</span><span class="ch">\n</span><span class="st">"</span>, y_train_binarized)</span>
<span id="cb42-11"><a></a></span>
<span id="cb42-12"><a></a><span class="co"># Convert binarized labels back to the original numerical values</span></span>
<span id="cb42-13"><a></a>original_labels <span class="op">=</span> [np.argmax(b) <span class="cf">for</span> b <span class="kw">in</span> y_train_binarized]</span>
<span id="cb42-14"><a></a><span class="bu">print</span>(<span class="st">"Original labels:</span><span class="ch">\n</span><span class="st">"</span>, original_labels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Binarized labels:
 [[1 0 0]
 [0 1 0]
 [0 0 1]
 [1 0 0]
 [0 1 0]
 [0 0 1]
 [0 1 0]
 [1 0 0]]
Original labels:
 [np.int64(0), np.int64(1), np.int64(2), np.int64(0), np.int64(1), np.int64(2), np.int64(1), np.int64(0)]</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>Marcel <strong>Turcotte</strong></p>
<p><a href="mailto:Marcel.Turcotte@uOttawa.ca">Marcel.Turcotte@uOttawa.ca</a></p>
<p>School of Electrical Engineering and <strong>Computer Science</strong> (EE<strong>CS</strong>)</p>
<p>University of Ottawa</p>
<div class="columns">
<div class="column" style="width:70%;">

</div><div class="column" style="width:30%;">
<p><a href="../../assets/images/amigurumi_chihuahua-2024-09-16.png" class="lightbox" data-gallery="quarto-lightbox-gallery-20"><img data-src="../../assets/images/amigurumi_chihuahua-2024-09-16.png"></a></p>
</div></div>



<aside><div>
<p><strong>Attribution</strong>: “An image of a sad Chihuahua amigurumi with a birthday hat.” Generated by DALL-E, via ChatGPT (GPT-4), OpenAI, September 16, 2024.</p>
</div></aside></section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<p><img src="../../assets/images/uottawa_hor_black.png" class="slide-logo"></p>
<div class="footer footer-default">
<p><a href="https://turcotte.xyz/teaching/csi-4106">turcotte.xyz/teaching/csi-4106</a></p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="../../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
            const codeEl = trigger.previousElementSibling.cloneNode(true);
            for (const childEl of codeEl.children) {
              if (isCodeAnnotation(childEl)) {
                childEl.remove();
              }
            }
            return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp("https:\/\/turcotte\.xyz\/teaching\/csi-4106");
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    <script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
    (function() {
      let previousOnload = window.onload;
      window.onload = () => {
        if (previousOnload) {
          previousOnload();
        }
        lightboxQuarto.on('slide_before_load', (data) => {
          const { slideIndex, slideNode, slideConfig, player, trigger } = data;
          const href = trigger.getAttribute('href');
          if (href !== null) {
            const imgEl = window.document.querySelector(`a[href="${href}"] img`);
            if (imgEl !== null) {
              const srcAttr = imgEl.getAttribute("src");
              if (srcAttr && srcAttr.startsWith("data:")) {
                slideConfig.href = srcAttr;
              }
            }
          } 
        });
      
        lightboxQuarto.on('slide_after_load', (data) => {
          const { slideIndex, slideNode, slideConfig, player, trigger } = data;
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(slideNode);
          }
        });
      
      };
      
    })();
              </script>
    

</body></html>