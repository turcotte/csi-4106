<!DOCTYPE html>
<html lang="en"><head>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/tabby.min.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.7.32">

  <meta name="author" content="Marcel Turcotte">
  <title>CSI 4106 - Fall 2025 – Machine Learning Engineering</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
      margin-bottom: 0em;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/theme/quarto-f563837468303362081e247dddd440d0.css">
  <link href="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
<meta property="og:title" content="Machine Learning Engineering – CSI 4106 - Fall 2025">
<meta property="og:description" content="CSI 4106 - Fall 2025">
<meta property="og:site_name" content="CSI 4106 - Fall 2025">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Machine Learning Engineering</h1>
  <p class="subtitle">CSI 4106 - Fall 2025</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Marcel Turcotte 
</div>
</div>
</div>

  <p class="date">Version: Jul 10, 2025 15:54</p>
</section>
<section>
<section id="preamble" class="title-slide slide level1 center">
<h1>Preamble</h1>

</section>
<section id="quote-of-the-day" class="slide level2 scrollable">
<h2>Quote of the Day</h2>
<p></p><div id="tweet-72281"></div><script>tweet={"url":"https:\/\/twitter.com\/YahooFinance\/status\/1839320829517287616","author_name":"Yahoo Finance","author_url":"https:\/\/twitter.com\/YahooFinance","html":"\u003Cblockquote class=\"twitter-tweet\" align=\"center\"\u003E\u003Cp lang=\"en\" dir=\"ltr\"\u003E\u003Ca href=\"https:\/\/twitter.com\/search?q=%24IBM&amp;src=ctag&amp;ref_src=twsrc%5Etfw\"\u003E$IBM\u003C\/a\u003E and NASA are partnering to develop an open-source AI model for weather and climate analysis. \u003Cbr\u003E\u003Cbr\u003EHugging Face CEO \u003Ca href=\"https:\/\/twitter.com\/ClementDelangue?ref_src=twsrc%5Etfw\"\u003E@ClementDelangue\u003C\/a\u003E discusses: \u003Ca href=\"https:\/\/t.co\/Nt9Zn76hCc\"\u003Epic.twitter.com\/Nt9Zn76hCc\u003C\/a\u003E\u003C\/p\u003E&mdash; Yahoo Finance (@YahooFinance) \u003Ca href=\"https:\/\/twitter.com\/YahooFinance\/status\/1839320829517287616?ref_src=twsrc%5Etfw\"\u003ESeptember 26, 2024\u003C\/a\u003E\u003C\/blockquote\u003E\n\u003Cscript async src=\"https:\/\/platform.twitter.com\/widgets.js\" charset=\"utf-8\"\u003E\u003C\/script\u003E\n\n","width":550,"height":null,"type":"rich","cache_age":"3153600000","provider_name":"Twitter","provider_url":"https:\/\/twitter.com","version":"1.0"};document.getElementById("tweet-72281").innerHTML = tweet["html"];</script><p></p>

<aside><div>
<p><a href="https://time.com/collection/time100-ai/6308994/clement-delangue/#:~:text=Clément%20Delangue%20is%20the,%2C%20datasets%2C%20and%20best%20practices.">Clément Delangue</a>, <a href="https://huggingface.co">Hugging Face</a> CEO, discusses AI for good. Specifically, the development by IBM and NASA of an open-source AI model for weather and climate analysis.</p>
</div></aside></section>
<section id="learning-objectives" class="slide level2 scrollable">
<h2>Learning Objectives</h2>
<ol type="1">
<li><strong>Data Size and Its Impact:</strong>
<ul>
<li>Recognize the influence of dataset size on model performance.</li>
<li>Discuss the concept of data augmentation and its role in improving model robustness.</li>
<li>Explore the “unreasonable effectiveness of data” in machine learning.</li>
</ul></li>
<li><strong>Feature Engineering and Encoding:</strong>
<ul>
<li>Explain the importance of feature extraction and the role of domain knowledge.</li>
<li>Compare different methods for encoding categorical data, such as one-hot encoding and ordinal encoding.</li>
<li>Justify the choice of encoding methods based on the nature of the data and the problem.</li>
</ul></li>
<li><strong>Data Preprocessing Techniques:</strong>
<ul>
<li>Apply normalization and standardization for feature scaling.</li>
<li>Decide when to use normalization versus standardization based on data characteristics.</li>
<li>Handle missing values using various imputation strategies and understand their implications.</li>
</ul></li>
<li><strong>Addressing Class Imbalance:</strong>
<ul>
<li>Define the class imbalance problem and its impact on model performance.</li>
<li>Explore solutions like resampling, algorithmic adjustments, and synthetic data generation (e.g., SMOTE).</li>
<li>Understand the importance of applying these techniques appropriately to avoid data leakage.</li>
</ul></li>
<li><strong>Integrate Knowledge in Practical Applications:</strong>
<ul>
<li>Apply the learned concepts to real-world datasets (e.g., OpenML datasets like ‘diabetes’ and ‘adult’).</li>
<li>Interpret and analyze the results of model evaluations and experiments.</li>
<li>Develop a comprehensive understanding of the end-to-end machine learning pipeline.</li>
</ul></li>
</ol>

<aside><div>
<p>The above learning objectives have been generated by OpenAI’s model, <a href="https://openai.com/index/introducing-openai-o1-preview/">o1</a>, based on the lecture content.</p>
</div></aside></section></section>
<section>
<section id="data" class="title-slide slide level1 center">
<h1>Data</h1>

</section>
<section id="size-does-matter" class="slide level2">
<h2>Size does matter</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>“However, these results suggest that we may want to reconsider the trade-off between spending time and money on algorithm development versus <strong>spending it on corpus development</strong> algorithms themselves.”</p>
</div><div class="column" style="width:50%;">
<p><a href="../../assets/images/millions_of_words.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img data-src="../../assets/images/millions_of_words.png"></a></p>
</div></div>

<aside><div>
<p><strong>Attribution</strong>: <span class="citation" data-cites="Banko:2001aa">Banko and Brill (<a href="#/references" role="doc-biblioref" onclick="">2001</a>)</span></p>
</div></aside></section>
<section id="unreasonable-effectiveness-of-data" class="slide level2">
<h2>Unreasonable Effectiveness of Data</h2>
<iframe data-external="1" src="https://www.youtube.com/embed/yvDCzhbjYWs" width="889" height="500" title="The Unreasonable Effectiveness of Data" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>

<aside class="notes">
<p>Peter Norvig’s presentation, titled “The Unreasonable Effectiveness of Data,” runs for just over one hour. It is noteworthy that the paper on which the presentation is based was published in 2009, predating the success of AlexNet.</p>
<p>The substantial improvements observed with AlexNet in 2012 highlighted the benefits of training deep neural networks on large image datasets.</p>
<p>Similarly, modern models like GPT, Gemini, Claude, and LLaMA have achieved significant advancements in language capabilities by training on vast amounts of text data, encompassing nearly all written material since the inception of human civilization.</p>
<p><strong>Neural scaling laws</strong> describe how the performance of neural networks varies with changes in key factors such as dataset size, number of parameters, and computational cost&nbsp;<span class="citation" data-cites="Kaplan:2020aa">Kaplan et al. (<a href="#/references" role="doc-biblioref" onclick="">2020</a>)</span>.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<aside><div>
<p><span class="citation" data-cites="halevy:2009tn">Halevy, Norvig, and Pereira (<a href="#/references" role="doc-biblioref" onclick="">2009</a>)</span> and <span class="citation" data-cites="Kaplan:2020aa">Kaplan et al. (<a href="#/references" role="doc-biblioref" onclick="">2020</a>)</span>.</p>
</div></aside></section>
<section id="definition" class="slide level2">
<h2>Definition</h2>
<p><strong>Data augmentation</strong> is a technique used to increase the diversity of a dataset by applying various transformations to the existing data.</p>

<aside><div>
<p><strong>Purpose</strong>: Enhance the robustness and generalization capability of machine learning models.</p>
</div></aside></section>
<section id="data-augmentation" class="slide level2">
<h2>Data Augmentation</h2>
<ul>
<li class="fragment"><strong>For Images</strong>: Rotations, translations, scaling, flipping, adding noise, etc.
<ul>
<li class="fragment"><a href="https://youtube.com/shorts/DA_-6296G5o">How to find ancient geoglyphs using machine learning?</a>, <span class="citation" data-cites="Sakai:2024aa">Sakai et al. (<a href="#/references" role="doc-biblioref" onclick="">2024</a>)</span></li>
</ul></li>
<li class="fragment"><strong>For Text</strong>: Synonym replacement, random insertion, deletion, and swapping of words.</li>
</ul>

<aside><div>
<p><strong>Generative Adversarial Networks (GANs)</strong> (a form of deep learning) can be used to generate new, synthetic data that mimics the distribution of the original dataset.</p>
<p>See also: <span class="citation" data-cites="Shumailov:2024aa">Shumailov et al. (<a href="#/references" role="doc-biblioref" onclick="">2024</a>)</span>.</p>
</div></aside></section></section>
<section>
<section id="machine-learning-engineering" class="title-slide slide level1 center">
<h1>Machine Learning Engineering</h1>

</section>
<section id="machine-learning-engineering-1" class="slide level2">
<h2>Machine Learning Engineering</h2>
<ol type="1">
<li>Gather <strong>adequate</strong> data.</li>
<li>Extract <strong>features</strong> from the raw data:
<ul>
<li>This process is <strong>labor-intensive</strong>.</li>
<li>It necessitates <strong>creativity</strong>.</li>
<li><strong>Domain knowledge</strong> is highly beneficial.</li>
</ul></li>
</ol>
</section>
<section id="dataset---adult" class="slide level2 scrollable">
<h2>Dataset - Adult</h2>
<div id="e25df083" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb1-3"><a></a></span>
<span id="cb1-4"><a></a><span class="im">from</span> sklearn.datasets <span class="im">import</span> fetch_openml</span>
<span id="cb1-5"><a></a></span>
<span id="cb1-6"><a></a>adult <span class="op">=</span> fetch_openml(name<span class="op">=</span><span class="st">'adult'</span>, version<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb1-7"><a></a><span class="bu">print</span>(adult.DESCR)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

<aside class="notes">
<p>Le jeu de données ‘Adult’ contient plusieurs attributs caractérisés par des valeurs catégorielles. Ce jeu de données servira de base pour une brève discussion sur l’encodage de ces valeurs catégorielles.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="dataset---adult-output" class="slide level2 scrollable output-location-slide"><h2>Dataset - Adult</h2><div class="cell output-location-slide" data-execution_count="1">
<p><strong>Author</strong>: Ronny Kohavi and Barry Becker<br>
<strong>Source</strong>: <a href="https://archive.ics.uci.edu/ml/datasets/Adult">UCI</a> - 1996<br>
<strong>Please cite</strong>: Ron Kohavi, “Scaling Up the Accuracy of Naive-Bayes Classifiers: a Decision-Tree Hybrid”, Proceedings of the Second International Conference on Knowledge Discovery and Data Mining, 1996</p>
<p>Prediction task is to determine whether a person makes over 50K a year. Extraction was done by Barry Becker from the 1994 Census database. A set of reasonably clean records was extracted using the following conditions: ((AAGE&gt;16) &amp;&amp; (AGI&gt;100) &amp;&amp; (AFNLWGT&gt;1)&amp;&amp; (HRSWK&gt;0))</p>
<p>This is the original version from the UCI repository, with training and test sets merged.</p>
<h3 id="variable-description">Variable description</h3>
<p>Variables are all self-explanatory except <strong>fnlwgt</strong>. This is a proxy for the demographic background of the people: “People with similar demographic characteristics should have similar weights”. This similarity-statement is not transferable across the 51 different states.</p>
<p>Description from the donor of the database:</p>
<p>The weights on the CPS files are controlled to independent estimates of the civilian noninstitutional population of the US. These are prepared monthly for us by Population Division here at the Census Bureau. We use 3 sets of controls. These are: 1. A single cell estimate of the population 16+ for each state. 2. Controls for Hispanic Origin by age and sex. 3. Controls by Race, age and sex.</p>
<p>We use all three sets of controls in our weighting program and “rake” through them 6 times so that by the end we come back to all the controls we used. The term estimate refers to population totals derived from CPS by creating “weighted tallies” of any specified socio-economic characteristics of the population. People with similar demographic characteristics should have similar weights. There is one important caveat to remember about this statement. That is that since the CPS sample is actually a collection of 51 state samples, each with its own probability of selection, the statement only applies within state.</p>
<h3 id="relevant-papers">Relevant papers</h3>
<p>Ronny Kohavi and Barry Becker. Data Mining and Visualization, Silicon Graphics.<br>
e-mail: ronnyk ‘@’ live.com for questions.</p>
<p>Downloaded from openml.org.</p>
</div></section><section id="adult---workclass" class="slide level2 scrollable">
<h2>Adult - Workclass</h2>
<div id="cd72a796" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a></a>adult.data[<span class="st">'workclass'</span>].unique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>['Private', 'Local-gov', NaN, 'Self-emp-not-inc', 'Federal-gov', 'State-gov', 'Self-emp-inc', 'Without-pay', 'Never-worked']
Categories (8, object): ['Federal-gov', 'Local-gov', 'Never-worked', 'Private', 'Self-emp-inc', 'Self-emp-not-inc', 'State-gov', 'Without-pay']</code></pre>
</div>
</div>
</section>
<section id="adult---education" class="slide level2 scrollable">
<h2>Adult - Education</h2>
<div id="a00587a9" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a></a>adult.data[<span class="st">'education'</span>].unique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>['11th', 'HS-grad', 'Assoc-acdm', 'Some-college', '10th', ..., 'Assoc-voc', '9th', '12th', '1st-4th', 'Preschool']
Length: 16
Categories (16, object): ['10th', '11th', '12th', '1st-4th', ..., 'Masters', 'Preschool', 'Prof-school', 'Some-college']</code></pre>
</div>
</div>
</section>
<section id="adult---marital-status" class="slide level2 scrollable">
<h2>Adult - Marital Status</h2>
<div id="0b733c01" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a></a>adult.data[<span class="st">'marital-status'</span>].unique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>['Never-married', 'Married-civ-spouse', 'Widowed', 'Divorced', 'Separated', 'Married-spouse-absent', 'Married-AF-spouse']
Categories (7, object): ['Divorced', 'Married-AF-spouse', 'Married-civ-spouse', 'Married-spouse-absent', 'Never-married', 'Separated', 'Widowed']</code></pre>
</div>
</div>
</section>
<section id="categorical-data" class="slide level2">
<h2>Categorical Data</h2>
<p><strong>Key Points on Data Representation</strong></p>
<ul>
<li><strong>Numerical Representation</strong>: Some learning algorithms require data to be in numerical form.</li>
<li><strong>Example Attribute</strong>: Consider the <code>workclass</code> attribute, which has 8 distinct values like ‘Federal-gov’, ‘Local-gov’, and so on.</li>
</ul>
</section>
<section id="encoding-methods" class="slide level2">
<h2>Encoding Methods</h2>
<p><strong>Which</strong> encoding method is preferable and <strong>why?</strong></p>
<ol type="1">
<li class="fragment"><code>w</code> = 1, 2, 3, 4, 5, 6, 7, or 8</li>
<li class="fragment"><code>w</code> = [0,0,0], [0,0,1], [0,1,0], <span class="math inline">\(\ldots\)</span>, or [1,1,1]</li>
<li class="fragment"><code>w</code> = [1,0,0,0,0,0,0,0], [0,1,0,0,0,0,0,0], <span class="math inline">\(\ldots\)</span>, or [0,0,0,0,0,0,0,1]</li>
</ol>
</section>
<section id="encoding-for-categorical-data" class="slide level2 smaller">
<h2>Encoding for Categorical Data</h2>
<p><strong>One-Hot Encoding</strong>: This method should be preferred for categorical data.</p>
<ul>
<li class="fragment"><strong>Increases Dimensionality</strong>: One-hot encoding increases the dimensionality of feature vectors.</li>
<li class="fragment"><strong>Avoids Bias</strong>: Other encoding methods can introduce biases.</li>
<li class="fragment"><strong>Example of Bias</strong>: Using the first method, <code>w</code> = 1, 2, 3, etc., implies that ‘Federal-gov’ and ‘Local-gov’ are similar, while ‘Federal-gov’ and ‘Without-pay’ are not.</li>
<li class="fragment"><strong>Misleading Similarity</strong>: The second method, <code>w</code> = [0,0,0], [0,0,1], etc., might mislead the algorithm by suggesting similarity based on numeric patterns.</li>
</ul>
</section>
<section id="definition-1" class="slide level2">
<h2>Definition</h2>
<p><strong>One-Hot Encoding</strong>: A technique that converts categorical variables into a binary vector representation, where each category is represented by a vector with a single ‘1’ and all other elements as ‘0’.</p>

<aside><div>
<p>Later, we will consider another encoding called an <strong>embedding</strong>.</p>
</div></aside></section>
<section id="onehotencoder" class="slide level2">
<h2>OneHotEncoder</h2>
<div id="a8025d7a" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a></a><span class="im">from</span> numpy <span class="im">import</span> array</span>
<span id="cb8-2"><a></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> OneHotEncoder</span>
<span id="cb8-3"><a></a></span>
<span id="cb8-4"><a></a>work <span class="op">=</span> adult.data[[<span class="st">'workclass'</span>]]</span>
<span id="cb8-5"><a></a></span>
<span id="cb8-6"><a></a>onehot_encoder <span class="op">=</span> OneHotEncoder()</span>
<span id="cb8-7"><a></a></span>
<span id="cb8-8"><a></a>onehot_encoder.fit(work)</span>
<span id="cb8-9"><a></a>values_encoded <span class="op">=</span> onehot_encoder.transform(work)</span>
<span id="cb8-10"><a></a></span>
<span id="cb8-11"><a></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">5</span>): <span class="bu">print</span>(values_encoded.toarray()[i])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[0. 0. 0. 1. 0. 0. 0. 0. 0.]
[0. 0. 0. 1. 0. 0. 0. 0. 0.]
[0. 1. 0. 0. 0. 0. 0. 0. 0.]
[0. 0. 0. 1. 0. 0. 0. 0. 0.]
[0. 0. 0. 0. 0. 0. 0. 0. 1.]</code></pre>
</div>
</div>

<aside class="notes">
<p>A student from my research group faced a challenging debugging issue. They mistakenly created a new encoder for the training set using <code>onehot_encoder.fit(X_test['some_attribute'])</code>, which produced a vector representation different from the one used during training. Consequently, the results on the training set were poor, while the results on the test set appeared satisfactory.</p>
<p>While <code>Pandas</code> offers a method called <code>get_dummies()</code> for one-hot encoding, it is important to note the following distinctions:</p>
<ul>
<li><strong>Category Memory</strong>: <code>OneHotEncoder</code> retains the categories it was trained on, whereas <code>get_dummies()</code> does not.</li>
<li><strong>Consistency in Production</strong>: It is crucial to use the same encoding scheme in production as was used during training to ensure accurate results.</li>
<li><strong>Vector Length Discrepancies</strong>: If <code>get_dummies()</code> encounters a different number of categories in new data, it will produce vectors of varying lengths, leading to potential errors.</li>
<li><strong>Handling Missing Values</strong>: When <code>get_dummies()</code> processes missing values, it generates an additional column to accommodate them.</li>
</ul>
<p>Ensuring consistency in encoding across <strong>training</strong>, <strong>validation</strong>, and <strong>production</strong> datasets is essential to maintain the integrity and accuracy of your machine learning models.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<aside><div>
<p><strong>Consistency is Key</strong>: Ensure you use the same encoding on: Validation Set, Test Set, and Production Data.</p>
</div></aside></section>
<section id="case-study" class="slide level2 smaller">
<h2>Case Study</h2>
<ul>
<li><strong>Dataset</strong>: <a href="https://archive.ics.uci.edu/dataset/45/heart+disease">Heart Disease</a>
<ul>
<li><strong>Examples</strong>: 303, <strong>features</strong>: 13, <strong>target</strong>: Presence/absence of disease</li>
</ul></li>
<li><strong>Categorical Data</strong>:
<ul>
<li><strong>sex</strong>: 1 = male, 0 = female</li>
<li><strong>cp (chest pain type)</strong>:
<ul>
<li>1: Typical angina</li>
<li>2: Atypical angina</li>
<li>3: Non-anginal pain</li>
<li>4: Asymptomatic</li>
</ul></li>
<li><strong>Other</strong>: ‘fbs’, ‘restecg’, ‘exang’, ‘slope’, ‘thal’</li>
</ul></li>
</ul>

<aside class="notes">
<p>Here are some suggestions for further investigation:</p>
<ul>
<li>Assess the impact of omitting missing values on the dataset.</li>
<li>Implement hyperparameter tuning to determine whether <span class="math inline">\(L_1\)</span> or <span class="math inline">\(L_2\)</span> regularization enhances model performance.</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<aside><div>
<p><strong>To simplify the analysis</strong>: Examples with missing values were dropped, no hyperparameter tuning was performed, numerical values were scaled for solver convergence.</p>
</div></aside></section>
<section id="case-study-1" class="slide level2 scrollable">
<h2>Case Study</h2>
<div id="a97ae913" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb10-2"><a></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb10-3"><a></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb10-4"><a></a><span class="im">from</span> sklearn.datasets <span class="im">import</span> fetch_openml</span>
<span id="cb10-5"><a></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> OneHotEncoder, StandardScaler</span>
<span id="cb10-6"><a></a><span class="im">from</span> sklearn.compose <span class="im">import</span> ColumnTransformer</span>
<span id="cb10-7"><a></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb10-8"><a></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb10-9"><a></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report</span>
<span id="cb10-10"><a></a></span>
<span id="cb10-11"><a></a><span class="co"># Load the 'Heart-Disease' dataset from OpenML</span></span>
<span id="cb10-12"><a></a>data <span class="op">=</span> fetch_openml(name<span class="op">=</span><span class="st">'Heart-Disease'</span>, version<span class="op">=</span><span class="dv">1</span>, as_frame<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb10-13"><a></a>df <span class="op">=</span> data.frame</span>
<span id="cb10-14"><a></a></span>
<span id="cb10-15"><a></a><span class="co"># Replace '?' with NaN and convert columns to numeric</span></span>
<span id="cb10-16"><a></a><span class="cf">for</span> col <span class="kw">in</span> df.columns:</span>
<span id="cb10-17"><a></a>    df[col] <span class="op">=</span> pd.to_numeric(df[col], errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb10-18"><a></a></span>
<span id="cb10-19"><a></a><span class="co"># Drop rows with missing values</span></span>
<span id="cb10-20"><a></a>df.dropna(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb10-21"><a></a></span>
<span id="cb10-22"><a></a><span class="co"># Define features and target</span></span>
<span id="cb10-23"><a></a>X <span class="op">=</span> df.drop(columns<span class="op">=</span>[<span class="st">'target'</span>])</span>
<span id="cb10-24"><a></a>y <span class="op">=</span> df[<span class="st">'target'</span>]</span>
<span id="cb10-25"><a></a></span>
<span id="cb10-26"><a></a><span class="co"># Columns to encode with OneHotEncoder</span></span>
<span id="cb10-27"><a></a>columns_to_encode <span class="op">=</span> [<span class="st">'sex'</span>, <span class="st">'cp'</span>, <span class="st">'fbs'</span>, <span class="st">'restecg'</span>, <span class="st">'exang'</span>, <span class="st">'slope'</span>, <span class="st">'thal'</span>]</span>
<span id="cb10-28"><a></a></span>
<span id="cb10-29"><a></a><span class="co"># Identify numerical columns</span></span>
<span id="cb10-30"><a></a>numerical_columns <span class="op">=</span> X.columns.difference(columns_to_encode)</span>
<span id="cb10-31"><a></a></span>
<span id="cb10-32"><a></a><span class="co"># Split the dataset into training and testing sets before transformations</span></span>
<span id="cb10-33"><a></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(</span>
<span id="cb10-34"><a></a>    X, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span></span>
<span id="cb10-35"><a></a>)</span>
<span id="cb10-36"><a></a></span>
<span id="cb10-37"><a></a><span class="co"># Apply OneHotEncoder and StandardScaler using ColumnTransformer</span></span>
<span id="cb10-38"><a></a>column_transformer <span class="op">=</span> ColumnTransformer(</span>
<span id="cb10-39"><a></a>    transformers<span class="op">=</span>[</span>
<span id="cb10-40"><a></a>        (<span class="st">'onehot'</span>, OneHotEncoder(), columns_to_encode),</span>
<span id="cb10-41"><a></a>        (<span class="st">'scaler'</span>, StandardScaler(), numerical_columns)</span>
<span id="cb10-42"><a></a>    ]</span>
<span id="cb10-43"><a></a>)</span>
<span id="cb10-44"><a></a></span>
<span id="cb10-45"><a></a><span class="co"># Fit the transformer on the training data and transform both training and test data</span></span>
<span id="cb10-46"><a></a>X_train_processed <span class="op">=</span> column_transformer.fit_transform(X_train)</span>
<span id="cb10-47"><a></a>X_test_processed <span class="op">=</span> column_transformer.transform(X_test)</span>
<span id="cb10-48"><a></a></span>
<span id="cb10-49"><a></a><span class="co"># Initialize and train logistic regression model</span></span>
<span id="cb10-50"><a></a>model <span class="op">=</span> LogisticRegression(max_iter<span class="op">=</span><span class="dv">1000</span>)</span>
<span id="cb10-51"><a></a>model <span class="op">=</span> model.fit(X_train_processed, y_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<aside class="notes">
<p>In the context of using <code>ColumnTransformer</code>, the second element of the triplets, typically an estimator, can also be replaced with the options <code>drop</code> or <code>passthrough</code>. The <code>drop</code> option excludes the specified column from the transformation process, while <code>passthrough</code> retains the column in its original state without any modifications.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="case-study---results" class="slide level2">
<h2>Case study - results</h2>
<div id="fc0bd063" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a></a><span class="co"># Predict and evaluate the model</span></span>
<span id="cb11-2"><a></a>y_pred <span class="op">=</span> model.predict(X_test_processed)</span>
<span id="cb11-3"><a></a></span>
<span id="cb11-4"><a></a><span class="bu">print</span>(classification_report(y_test, y_pred))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              precision    recall  f1-score   support

         0.0       0.87      0.93      0.90        29
         1.0       0.93      0.88      0.90        32

    accuracy                           0.90        61
   macro avg       0.90      0.90      0.90        61
weighted avg       0.90      0.90      0.90        61
</code></pre>
</div>
</div>
</section>
<section id="case-study---chest-pain-cp" class="slide level2 smaller">
<h2>Case study - chest pain (cp)</h2>
<div id="82c5bfba" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a></a><span class="co"># Retrieve feature names after transformation using get_feature_names_out()</span></span>
<span id="cb13-2"><a></a>feature_names <span class="op">=</span> column_transformer.get_feature_names_out()</span>
<span id="cb13-3"><a></a></span>
<span id="cb13-4"><a></a><span class="co"># Get coefficients and map them to feature names</span></span>
<span id="cb13-5"><a></a>coefficients <span class="op">=</span> model.coef_[<span class="dv">0</span>]</span>
<span id="cb13-6"><a></a></span>
<span id="cb13-7"><a></a><span class="co"># Create a DataFrame with feature names and coefficients</span></span>
<span id="cb13-8"><a></a>coef_df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb13-9"><a></a>    <span class="st">'Feature'</span>: feature_names,</span>
<span id="cb13-10"><a></a>    <span class="st">'Coefficient'</span>: coefficients</span>
<span id="cb13-11"><a></a>})</span>
<span id="cb13-12"><a></a></span>
<span id="cb13-13"><a></a><span class="co"># Display coefficients associated with 'cp'</span></span>
<span id="cb13-14"><a></a>cp_features <span class="op">=</span> coef_df[coef_df[<span class="st">'Feature'</span>].<span class="bu">str</span>.contains(<span class="st">'_cp'</span>)]</span>
<span id="cb13-15"><a></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Coefficients associated with 'cp':"</span>)</span>
<span id="cb13-16"><a></a><span class="bu">print</span>(cp_features)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Coefficients associated with 'cp':
          Feature  Coefficient
2  onehot__cp_0.0    -1.013382
3  onehot__cp_1.0    -0.212284
4  onehot__cp_2.0     0.599934
5  onehot__cp_3.0     0.628824</code></pre>
</div>
</div>
</section>
<section id="case-study---coefficients" class="slide level2">
<h2>Case study - coefficients</h2>
<div id="a8f70384" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a></a><span class="co"># Visualize the coefficients</span></span>
<span id="cb15-2"><a></a></span>
<span id="cb15-3"><a></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb15-4"><a></a>plt.barh(coef_df[<span class="st">'Feature'</span>], coef_df[<span class="st">'Coefficient'</span>])</span>
<span id="cb15-5"><a></a>plt.title(<span class="st">'Feature Coefficients'</span>)</span>
<span id="cb15-6"><a></a>plt.xlabel(<span class="st">'Coefficient Value'</span>)</span>
<span id="cb15-7"><a></a>plt.ylabel(<span class="st">'Feature'</span>)</span>
<span id="cb15-8"><a></a>plt.tight_layout()</span>
<span id="cb15-9"><a></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


<aside><div>
<p><strong>Positive coefficients</strong> in a logistic regression model signify that <strong>higher values of the corresponding feature contribute positively</strong> to the probability of an example <strong>belonging to ‘target = 1.0’</strong>. Negative coefficients indicate the opposite effect.</p>
</div></aside></section>
<section id="case-study---coefficients-output" class="slide level2 output-location-slide"><h2>Case study - coefficients</h2><div class="cell output-location-slide" data-execution_count="9">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="slides_files/figure-revealjs/cell-10-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img data-src="slides_files/figure-revealjs/cell-10-output-1.png" class="quarto-figure quarto-figure-center" width="757" height="564"></a></p>
</figure>
</div>
</div>
</div></section><section id="case-study---coefficients-sorted" class="slide level2">
<h2>Case study - coefficients (sorted)</h2>
<div id="03668688" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a></a><span class="co"># Visualize the coefficients</span></span>
<span id="cb16-2"><a></a></span>
<span id="cb16-3"><a></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb16-4"><a></a>coef_df.sort_values(by<span class="op">=</span><span class="st">'Coefficient'</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb16-5"><a></a>plt.barh(coef_df[<span class="st">'Feature'</span>], coef_df[<span class="st">'Coefficient'</span>])</span>
<span id="cb16-6"><a></a>plt.title(<span class="st">'Feature Coefficients'</span>)</span>
<span id="cb16-7"><a></a>plt.xlabel(<span class="st">'Coefficient Value'</span>)</span>
<span id="cb16-8"><a></a>plt.ylabel(<span class="st">'Feature'</span>)</span>
<span id="cb16-9"><a></a>plt.tight_layout()</span>
<span id="cb16-10"><a></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

</section>
<section id="case-study---coefficients-sorted-output" class="slide level2 output-location-slide"><h2>Case study - coefficients (sorted)</h2><div class="cell output-location-slide" data-execution_count="10">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="slides_files/figure-revealjs/cell-11-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img data-src="slides_files/figure-revealjs/cell-11-output-1.png" class="quarto-figure quarto-figure-center" width="757" height="564"></a></p>
</figure>
</div>
</div>
</div></section><section id="definition-2" class="slide level2">
<h2>Definition</h2>
<p><strong>Ordinal encoding</strong> is a technique that assigns numerical values to categorical attributes based on their inherent order or rank.</p>
</section>
<section id="feature-engineering---ordinal" class="slide level2">
<h2>Feature Engineering - Ordinal</h2>
<p>For attributs with values such as <strong>‘Poor’</strong>, <strong>‘Average’</strong>, and <strong>‘Good’</strong>, an ordinal encoding would make sense.</p>
<div class="fragment">
<p>However!</p>
<div id="aecc5edd" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a></a><span class="im">from</span> numpy <span class="im">import</span> array</span>
<span id="cb17-2"><a></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> OrdinalEncoder</span>
<span id="cb17-3"><a></a></span>
<span id="cb17-4"><a></a>X <span class="op">=</span>[[<span class="st">'Poor'</span>], [<span class="st">'Average'</span>], [<span class="st">'Good'</span>], [<span class="st">'Average'</span>], [<span class="st">'Average'</span>]]</span>
<span id="cb17-5"><a></a></span>
<span id="cb17-6"><a></a>encoder <span class="op">=</span> OrdinalEncoder()</span>
<span id="cb17-7"><a></a></span>
<span id="cb17-8"><a></a>encoder.fit(X)</span>
<span id="cb17-9"><a></a>encoder.transform(X)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>array([[2.],
       [0.],
       [1.],
       [0.],
       [0.]])</code></pre>
</div>
</div>
</div>
</section>
<section id="ordinalencoder-revised" class="slide level2">
<h2>OrdinalEncoder (revised)</h2>
<div id="ca271fa9" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a></a><span class="im">from</span> numpy <span class="im">import</span> array</span>
<span id="cb19-2"><a></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> OrdinalEncoder</span>
<span id="cb19-3"><a></a></span>
<span id="cb19-4"><a></a>X <span class="op">=</span>[[<span class="st">'Poor'</span>], [<span class="st">'Average'</span>], [<span class="st">'Good'</span>], [<span class="st">'Average'</span>], [<span class="st">'Average'</span>]]</span>
<span id="cb19-5"><a></a></span>
<span id="cb19-6"><a></a>encoder <span class="op">=</span> OrdinalEncoder(categories<span class="op">=</span>[[<span class="st">'Poor'</span>, <span class="st">'Average'</span>, <span class="st">'Good'</span>]])</span>
<span id="cb19-7"><a></a></span>
<span id="cb19-8"><a></a>encoder.fit(X)</span>
<span id="cb19-9"><a></a></span>
<span id="cb19-10"><a></a>X_encoded <span class="op">=</span> encoder.transform(X)</span>
<span id="cb19-11"><a></a></span>
<span id="cb19-12"><a></a>X_encoded</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>array([[0.],
       [1.],
       [2.],
       [1.],
       [1.]])</code></pre>
</div>
</div>
<aside class="notes">
<p>The desired order of the categories must be explicitly provided to the encoder; otherwise, it defaults to alphabetical order.</p>
<p>An ordinal encoder is appropriate when categorical attributes have a clear, inherent order or ranking, such as ‘Low’, ‘Medium’, and ‘High’, or ‘Poor’, ‘Average’, and ‘Good’. This encoding method preserves the ordinal relationships among categories.</p>
<p>When data is inherently ordinal, this encoding is more compact and can be advantageous for machine learning models. However, if there is any uncertainty about the ordinal nature of the data, it is safer to use a <code>OneHotEncoder</code>.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="definition-3" class="slide level2">
<h2>Definition</h2>
<p><strong>Discretization</strong> involves grouping ordinal values into discrete categories.</p>

<aside><div>
<p>AKA <strong>binning</strong>, <strong>bucketing</strong>, or <strong>quantization</strong>.</p>
</div></aside></section>
<section id="feature-engineering-binning" class="slide level2 scrollable">
<h2>Feature Engineering: Binning</h2>
<p><strong>Example</strong>: Categorizing ages into bins such as ‘infant’, ‘child’, ‘teen’, ‘adult’, and ‘senior citizen’.</p>
<div class="fragment">
<p><strong>Advantages</strong>:</p>
<ul>
<li>Enables the algorithm to learn effectively with fewer training examples.</li>
</ul>
<p><strong>Disadvantages</strong>:</p>
<ul>
<li>Requires domain expertise to define meaningful categories.</li>
<li>May lack generalizability; for example, the starting age for ‘senior citizen’ could be 60, 65, or 70<sup>1</sup>.</li>
</ul>
<aside class="notes">
<p>Providing hints or predefined bins can help a decision tree algorithm generate more compact trees, as it reduces the need for the classifier to independently learn decision boundaries.</p>
<p>However, introducing such a strong bias may hinder the algorithm’s ability to discover meaningful decision boundaries on its own.</p>
<p>Cross-validation is an effective method to determine the best encoding scheme, but it is essential to withhold the test set until the final evaluation phase of the project to prevent data leakage and ensure unbiased assessment.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
<aside><ol class="aside-footnotes"><li id="fn1"><p>Your instructor is concerned with your choice of cutoff <i class="fa-solid fa-face-smile-wink" aria-label="face-smile-wink"></i></p></li></ol></aside></section>
<section id="functiontransformer" class="slide level2">
<h2>FunctionTransformer</h2>
<div id="41217721" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb21-2"><a></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb21-3"><a></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> FunctionTransformer</span>
<span id="cb21-4"><a></a></span>
<span id="cb21-5"><a></a>bins <span class="op">=</span> [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">13</span>, <span class="dv">20</span>, <span class="dv">60</span>, np.inf]</span>
<span id="cb21-6"><a></a>labels <span class="op">=</span> [<span class="st">'infant'</span>, <span class="st">'kid'</span>, <span class="st">'teen'</span>, <span class="st">'adult'</span>, <span class="st">'senior citizen'</span>]</span>
<span id="cb21-7"><a></a></span>
<span id="cb21-8"><a></a>transformer <span class="op">=</span> FunctionTransformer(</span>
<span id="cb21-9"><a></a>    pd.cut, kw_args<span class="op">=</span>{<span class="st">'bins'</span>: bins, <span class="st">'labels'</span>: labels, <span class="st">'retbins'</span>: <span class="va">False</span>}</span>
<span id="cb21-10"><a></a>)</span>
<span id="cb21-11"><a></a></span>
<span id="cb21-12"><a></a>X <span class="op">=</span> np.array([<span class="fl">0.5</span>, <span class="dv">2</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">97</span>])</span>
<span id="cb21-13"><a></a>transformer.fit_transform(X)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>['infant', 'kid', 'teen', 'adult', 'senior citizen']
Categories (5, object): ['infant' &lt; 'kid' &lt; 'teen' &lt; 'adult' &lt; 'senior citizen']</code></pre>
</div>
</div>

<aside><div>
<p>Se also: <a href="https://scikit-learn.org/dev/modules/generated/sklearn.preprocessing.KBinsDiscretizer.html#sklearn.preprocessing.KBinsDiscretizer">KBinsDiscretizer</a></p>
</div></aside></section></section>
<section>
<section id="scaling" class="title-slide slide level1 center">
<h1>Scaling</h1>

</section>
<section id="normalization" class="slide level2">
<h2>Normalization</h2>
<p>Learning algorithms perform optimally when feature values have <strong>similar ranges</strong>, such as [-1,1] or [0,1].</p>
<ul>
<li>This accelerates optimization (e.g., gradient descent).</li>
</ul>
<p><strong>Normalization</strong>: <span class="math display">\[
  \frac{x_i^{(j)} - \min^{(j)}}{\max^{(j)} - \min^{(j)}}
\]</span></p>

<aside><div>
<p><strong>See:</strong> <a href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.MinMaxScaler.html">sklearn.preprocessing.MinMaxScaler</a></p>
</div></aside></section>
<section id="standardization" class="slide level2">
<h2>Standardization</h2>
<p>Standardization (AKA z-score normalization) transforms each feature to have a <strong>normal distribution</strong> with a mean (<span class="math inline">\(\mu\)</span>) of 0 and a standard deviation (<span class="math inline">\(\sigma\)</span>) of 1.</p>
<p><span class="math display">\[
\frac{x_i^{(j)} - \mu^{(j)}}{\sigma^{(j)}}
\]</span></p>
<p><strong>Note</strong>: The range of values is not bounded!</p>

<aside><div>
<p><strong>See:</strong> <a href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.StandardScaler.html">sklearn.preprocessing.StandardScaler</a></p>
</div></aside></section>
<section id="standardization-or-normalization" class="slide level2">
<h2>Standardization or Normalization?</h2>
<ul>
<li class="fragment">Treat scaling as a hyperparameter and <strong>evaluate both</strong> normalization and standardization.</li>
<li class="fragment"><strong>Standardization</strong> is generally more robust to <strong>outliers</strong> than normalization.</li>
<li class="fragment">Guidelines from <span class="citation" data-cites="burkov2019">Andriy Burkov (<a href="#/references" role="doc-biblioref" onclick="">2019</a>)</span>, § 5:
<ul>
<li class="fragment">Use <strong>standardization</strong> for <strong>unsupervised learning</strong> tasks.</li>
<li class="fragment">Use <strong>standardization</strong> if features are approximately <strong>normally distributed</strong>.</li>
<li class="fragment">Prefer <strong>standardization</strong> in the presence of <strong>outliers</strong>.</li>
<li class="fragment">Otherwise, use <strong>normalization</strong>.</li>
</ul></li>
</ul>
<aside class="notes">
<p>Do you see why standardization is generally more robust to <strong>outliers</strong> than normalization?</p>
<p>An effective strategy for mitigating the impact of outliers in data is the application of a logarithmic transformation to the values. This technique reduces the skewness of the data, thereby diminishing the disproportionate influence of extreme values.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="case-study---normal-distribution" class="slide level2">
<h2>Case Study - Normal Distribution</h2>
<div id="2b2023e2" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb23-2"><a></a>np.random.seed(<span class="dv">7</span>)</span>
<span id="cb23-3"><a></a></span>
<span id="cb23-4"><a></a><span class="co"># Sample characteristics</span></span>
<span id="cb23-5"><a></a>sample_size <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb23-6"><a></a>mu <span class="op">=</span> <span class="dv">57</span></span>
<span id="cb23-7"><a></a>sigma <span class="op">=</span> <span class="dv">7</span></span>
<span id="cb23-8"><a></a></span>
<span id="cb23-9"><a></a><span class="co"># Generate values</span></span>
<span id="cb23-10"><a></a>norm_values <span class="op">=</span> sigma <span class="op">*</span> np.random.randn(sample_size) <span class="op">+</span> mu</span>
<span id="cb23-11"><a></a></span>
<span id="cb23-12"><a></a><span class="co"># Add three outliers</span></span>
<span id="cb23-13"><a></a>norm_values <span class="op">=</span> np.append(norm_values, [<span class="dv">92</span>, <span class="dv">95</span>, <span class="dv">98</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="case-study---normal-distribution-1" class="slide level2">
<h2>Case Study - Normal Distribution</h2>
<div id="e7892452" class="cell" data-execution_count="15">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><a href="slides_files/figure-revealjs/cell-16-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img data-src="slides_files/figure-revealjs/cell-16-output-1.png" width="817" height="449"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="logarithm" class="slide level2">
<h2>Logarithm</h2>
<div id="ff627402" class="cell" data-execution_count="16">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><a href="slides_files/figure-revealjs/cell-17-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img data-src="slides_files/figure-revealjs/cell-17-output-1.png" width="816" height="429"></a></p>
</figure>
</div>
</div>
</div>

<aside><div>
<p>Logarithm of values from a normal distribution containing outliers.</p>
</div></aside></section>
<section id="normalization-1" class="slide level2">
<h2>Normalization</h2>
<div id="abab5569" class="cell" data-execution_count="17">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><a href="slides_files/figure-revealjs/cell-18-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img data-src="slides_files/figure-revealjs/cell-18-output-1.png" width="816" height="449"></a></p>
</figure>
</div>
</div>
</div>

<aside><div>
<p>Normalization (<code>MinMaxScaler</code>) of values from a normal distribution containing outliers.</p>
</div></aside></section>
<section id="standardization-1" class="slide level2">
<h2>Standardization</h2>
<div id="49efac45" class="cell" data-execution_count="18">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><a href="slides_files/figure-revealjs/cell-19-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img data-src="slides_files/figure-revealjs/cell-19-output-1.png" width="816" height="449"></a></p>
</figure>
</div>
</div>
</div>

<aside><div>
<p>Standardization (<code>StandardScaler</code>) of values from a normal distribution containing outliers.</p>
</div></aside></section>
<section id="logarithm-standardization" class="slide level2">
<h2>Logarithm &amp; Standardization</h2>
<div id="76b128ac" class="cell" data-execution_count="19">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><a href="slides_files/figure-revealjs/cell-20-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img data-src="slides_files/figure-revealjs/cell-20-output-1.png" width="816" height="449"></a></p>
</figure>
</div>
</div>
</div>

<aside><div>
<p>Standardization (<code>StandardScaler</code>) of values from a normal distribution containing outliers.</p>
</div></aside></section>





</section>
<section>
<section id="missing-values" class="title-slide slide level1 center">
<h1>Missing Values</h1>

</section>
<section id="definition-4" class="slide level2">
<h2>Definition</h2>
<p><strong>Missing values</strong> refer to the absence of data points or entries in a dataset where a value is expected.</p>

<aside><div>
<p><strong>Age</strong> is a good example, as some patients may withhold their age due to privacy concerns.</p>
</div></aside></section>
<section id="handling-missing-values" class="slide level2 smaller">
<h2>Handling Missing Values</h2>
<ul>
<li class="fragment"><strong>Drop Examples</strong>
<ul>
<li class="fragment">Feasible if the dataset is <strong>large</strong> and <strong>outcome is unaffected</strong>.</li>
</ul></li>
<li class="fragment"><strong>Drop Features</strong>
<ul>
<li class="fragment">Suitable if it <strong>does not impact</strong> the project’s outcome.</li>
</ul></li>
<li class="fragment"><strong>Use Algorithms Handling Missing Data</strong>
<ul>
<li class="fragment">Example: <code>XGBoost</code></li>
<li class="fragment"><strong>Note</strong>: Some algorithms like <code>sklearn.linear_model.LinearRegression</code> <strong>cannot handle</strong> missing values.</li>
</ul></li>
<li class="fragment"><strong>Data Imputation</strong>
<ul>
<li class="fragment">Replace missing values with computed values.</li>
</ul></li>
</ul>
</section>
<section id="definition-5" class="slide level2">
<h2>Definition</h2>
<p><strong>Data imputation</strong> is the process of replacing missing values in a dataset with substituted values, typically using statistical or machine learning methods.</p>
</section>
<section id="data-imputation-strategy" class="slide level2">
<h2>Data Imputation Strategy</h2>
<p>Replace missing values with <strong>mean</strong> or <strong>median</strong> of the <strong>attribute</strong>.</p>
<div id="1c8b95c2" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a></a><span class="im">from</span> sklearn.impute <span class="im">import</span> SimpleImputer</span>
<span id="cb25-2"><a></a>imputer <span class="op">=</span> SimpleImputer(strategy<span class="op">=</span><span class="st">"median"</span>)</span>
<span id="cb25-3"><a></a></span>
<span id="cb25-4"><a></a>X <span class="op">=</span> imputer.fit_transform(X)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<ul>
<li class="fragment"><p><strong>Cons</strong>: Ignores feature correlations and complex relationships.</p></li>
<li class="fragment"><p><strong>Mode Imputation</strong>: Replace missing values with the most frequent value; also ignores feature correlations.</p></li>
</ul>
<aside class="notes">
<p>Data imputation inherently relies on several assumptions, which may not always hold true.</p>
<p><strong>Randomness Assumption</strong>: Many methods (e.g., mean/median imputation) assume that missingness is unrelated to any data.</p>
<p><strong>Model Bias</strong>: Incorrect randomness assumptions can lead to biased estimates and flawed conclusions.</p>
<p><strong>Information Loss</strong>: Imputation can obscure patterns, leading to loss of valuable information for advanced models.</p>
<p>Proceed with caution!</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section>
<section id="data-imputation-strategy-1" class="slide level2">
<h2>Data Imputation Strategy</h2>
<p><strong>Special Value Method</strong>: Replace missing values with a value outside the normal range (e.g., use -1 or 2 for data normalized between [0,1]).</p>
<ul>
<li><strong>Objective</strong>: Enable the learning algorithm to recognize and appropriately handle missing values.</li>
</ul>
</section>
<section id="data-imputation-strategy-2" class="slide level2 smaller">
<h2>Data Imputation Strategy</h2>
<ul>
<li><p><strong>Middle-Range Imputation</strong>: Replace missing values with a value in the middle of the normal range (e.g., use 0 for data distributed in the range [-1,1]).</p>
<ul>
<li><strong>Categorical Data</strong>: Use small non-zero numerical values.
<ul>
<li>Example: Use [0.25, 0.25, 0.25, 0.25] instead of [1, 0, 0, 0] for ‘Poor’, [0, 1, 0, 0] for ‘Everage’, [0, 0, 1, 0] for ‘Good’, and [0, 0, 0, 1] for ‘Excellent’.</li>
</ul></li>
<li><strong>Objective</strong>: Minimize the impact of imputed values on the results.</li>
</ul></li>
</ul>
<aside class="notes">
<p><strong>Selection of Method</strong>: The effectiveness of imputation methods can vary, and it is essential to compare multiple techniques to determine the best approach for your specific dataset.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="alternative-approach" class="slide level2 smaller">
<h2>Alternative Approach</h2>
<ul>
<li class="fragment"><strong>Problem Definition</strong>: Predict unknown (missing) labels for given examples.</li>
<li class="fragment">Have you encountered this kind of problem before?</li>
<li class="fragment"><strong>Relevance</strong>: This can be framed as a supervised learning problem.
<ul>
<li class="fragment">Let <span class="math inline">\(\hat{x_i}\)</span> be a new example: <span class="math inline">\([x_i^{(1)}, x_i^{(2)}, \ldots, x_i^{(j-1)}, x_i^{(j+1)}, \ldots, x_i^{(D)}]\)</span>.</li>
<li class="fragment">Let <span class="math inline">\(\hat{y}_i = x_i^{j}\)</span>.</li>
<li class="fragment"><strong>Training Set</strong>: Use examples where <span class="math inline">\(x_i^{j}\)</span> is not missing.</li>
<li class="fragment"><strong>Method</strong>: Train a classifier on this set to predict (impute) the missing values.</li>
</ul></li>
</ul>
</section>
<section id="using-ml-for-imputation" class="slide level2">
<h2>Using ML for Imputation</h2>
<ol type="1">
<li class="fragment"><p><strong>Instance-Based Method</strong>:</p>
<ul>
<li class="fragment">Use <span class="math inline">\(k\)</span> nearest neighbors (k-NN) to find the <span class="math inline">\(k\)</span> closest examples and impute using the non-missing values from the neighborhood.</li>
</ul></li>
<li class="fragment"><p><strong>Model-Based Methods</strong>:</p>
<ul>
<li class="fragment">Employ advanced techniques such as random forests, tensor decomposition, or deep neural networks.</li>
</ul></li>
</ol>
</section>
<section id="why-use-these-methods" class="slide level2">
<h2>Why Use these Methods?</h2>
<ul>
<li class="fragment"><strong>Advantages</strong>:
<ul>
<li class="fragment">Effectively handle complex relationships and correlations between features.</li>
</ul></li>
<li class="fragment"><strong>Disadvantages</strong>:
<ul>
<li class="fragment">Cost-intensive in terms of labor, CPU time, and memory resources.</li>
</ul></li>
</ul>
</section></section>
<section>
<section id="class-imbalance" class="title-slide slide level1 center">
<h1>Class Imbalance</h1>

</section>
<section id="definition-6" class="slide level2">
<h2>Definition</h2>
<p>The <strong>class imbablance problem</strong> is a scenario where the number of instances in one class significantly outnumbers the instances in other classes.</p>
<div class="fragment">
<p>Models tend to be biased towards the <strong>majority class</strong>, leading to <strong>poor performance on the minority class</strong>.</p>

</div>
<aside><div>
<p>Standard evaluation metrics like accuracy may be misleading in the presence of class imbalance.</p>
</div></aside></section>
<section id="solutions" class="slide level2">
<h2>Solutions</h2>
<ul>
<li class="fragment"><p><strong>Resampling:</strong> Techniques such as <strong>oversampling</strong> the minority class or <strong>undersampling</strong> the majority class.</p></li>
<li class="fragment"><p><strong>Algorithmic Adjustments:</strong> Using cost-sensitive learning or modifying decision thresholds.</p></li>
<li class="fragment"><p><strong>Synthetic Data:</strong> Generating synthetic samples for the minority class using methods like SMOTE (Synthetic Minority Over-sampling Technique).</p></li>
</ul>

<aside class="notes">
<p><span class="citation" data-cites="chawla:2002ty">Chawla et al. (<a href="#/references" role="doc-biblioref" onclick="">2002</a>)</span> presents the original work, whereas <span class="citation" data-cites="10.1109/icic54025.2021.9632912">Pradipta et al. (<a href="#/references" role="doc-biblioref" onclick="">2021</a>)</span> is a recent review.</p>
<p><strong>Oversampling</strong></p>
<ul>
<li><strong>Oversampling</strong> can lead to overfitting, especially if the synthetic samples are very similar to the existing ones.</li>
<li><strong>Impact</strong>: The model may perform well on training data but generalize poorly to unseen data.</li>
</ul>
<p><strong>Undersampling</strong></p>
<ul>
<li><p><strong>Loss of Information</strong> reduces the number of instances in the majority class.</p></li>
<li><p><strong>Impact</strong>: Potentially discards valuable information and can lead to underfitting.</p></li>
<li><p><strong>Reduced Model Performance</strong>: Smaller training dataset may not capture the complexity of the problem.</p></li>
<li><p><strong>Impact</strong>: Can result in a less accurate and less robust model.</p></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<aside><div>
<p>Apply solutions only to the <strong>training set</strong> to prevents <strong>data leakage</strong>.</p>
</div></aside></section></section>
<section>
<section id="prologue" class="title-slide slide level1 center">
<h1>Prologue</h1>

</section>
<section id="further-readings" class="slide level2">
<h2>Further readings</h2>
<div class="columns">
<div class="column" style="width:20%;">
<p><a href="https://m.media-amazon.com/images/I/51XUfJm64KL._AC_UF350,350_QL50_.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-14"><img data-src="https://m.media-amazon.com/images/I/51XUfJm64KL._AC_UF350,350_QL50_.jpg"></a></p>
</div><div class="column" style="width:80%;">
<ul>
<li><a href="http://www.mlebook.com/wiki/doku.php"><strong>Machine Learning Engineering</strong></a> by <a href="https://www.linkedin.com/in/andriyburkov">Andriy Burkov</a> <span class="citation" data-cites="Burkov:2020aa">(<a href="#/references" role="doc-biblioref" onclick="">A. Burkov 2020</a>)</span>.</li>
<li>Covers data collection, storage, preprocessing, feature engineering, model testing and debugging, deployment, retirement, and maintenance.</li>
<li>From the author of <a href="https://themlbook.com"><strong>The Hundred-Page Machine Learning Book</strong></a> <span class="citation" data-cites="burkov2019">(<a href="#/references" role="doc-biblioref" onclick="">Andriy Burkov 2019</a>)</span>.</li>
<li>Available under a “read first, buy later” model.</li>
</ul>
</div></div>
</section>
<section id="summary" class="slide level2 smaller">
<h2>Summary</h2>
<ul>
<li><strong>Training Set Size</strong>: Impact on model efficacy and generalization.</li>
<li><strong>Attribute Encoding</strong>: Evaluation of techniques to avoid bias and possibly speed up the training.</li>
<li><strong>Preprocessing</strong>:
<ul>
<li>Data Scaling</li>
<li>Handling Missing Values</li>
<li>Managing Class Imbalance</li>
</ul></li>
</ul>
</section>
<section id="next-lecture" class="slide level2">
<h2>Next lecture</h2>
<ul>
<li>We will introduce artificial neural networks.</li>
</ul>
</section>
<section id="references" class="slide level2 smaller scrollable">
<h2>References</h2>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Banko:2001aa" class="csl-entry" role="listitem">
Banko, Michele, and Eric Brill. 2001. <span>“Scaling to Very Very Large Corpora for Natural Language Disambiguation.”</span> In <em>Proceedings of the 39th Annual Meeting on Association for Computational Linguistics</em>, 26–33. ACL ’01. USA: Association for Computational Linguistics. <a href="https://doi.org/10.3115/1073012.1073017">https://doi.org/10.3115/1073012.1073017</a>.
</div>
<div id="ref-Burkov:2020aa" class="csl-entry" role="listitem">
Burkov, A. 2020. <em>Machine Learning Engineering</em>. True Positive Incorporated. <a href="https://books.google.ca/books?id=HeXizQEACAAJ">https://books.google.ca/books?id=HeXizQEACAAJ</a>.
</div>
<div id="ref-burkov2019" class="csl-entry" role="listitem">
Burkov, Andriy. 2019. <em>The Hundred-Page Machine Learning Book</em>. Andriy Burkov.
</div>
<div id="ref-chawla:2002ty" class="csl-entry" role="listitem">
Chawla, N V, K W Bowyer, L O Hall, and W P Kegelmeyer. 2002. <span>“<span class="nocase">SMOTE: Synthetic minority over-sampling technique</span>.”</span> <em>Journal of Artificial Intelligence Research</em> 16: 321–57.
</div>
<div id="ref-halevy:2009tn" class="csl-entry" role="listitem">
Halevy, Alon, Peter Norvig, and Fernando Pereira. 2009. <span>“<span class="nocase">The Unreasonable Effectiveness of Data</span>.”</span> <em>IEEE Intelligent Systems</em> 24 (2): 8–12.
</div>
<div id="ref-Kaplan:2020aa" class="csl-entry" role="listitem">
Kaplan, Jared, Sam McCandlish, Tom Henighan, Tom B. Brown, Benjamin Chess, Rewon Child, Scott Gray, Alec Radford, Jeffrey Wu, and Dario Amodei. 2020. <span>“Scaling Laws for Neural Language Models.”</span> <a href="https://arxiv.org/abs/2001.08361">https://arxiv.org/abs/2001.08361</a>.
</div>
<div id="ref-10.1109/icic54025.2021.9632912" class="csl-entry" role="listitem">
Pradipta, Gede Angga, Retantyo Wardoyo, Aina Musdholifah, I Nyoman Hariyasa Sanjaya, and Muhammad Ismail. 2021. <span>“<span class="nocase">SMOTE for Handling Imbalanced Data Problem : A Review</span>.”</span> <em>2021 Sixth International Conference on Informatics and Computing (ICIC)</em> 00: 1–8. <a href="https://doi.org/10.1109/icic54025.2021.9632912">https://doi.org/10.1109/icic54025.2021.9632912</a>.
</div>
<div id="ref-Russell:2020aa" class="csl-entry" role="listitem">
Russell, Stuart, and Peter Norvig. 2020. <em>Artificial Intelligence: <span>A</span> Modern Approach</em>. 4th ed. Pearson. <a href="http://aima.cs.berkeley.edu/">http://aima.cs.berkeley.edu/</a>.
</div>
<div id="ref-Sakai:2024aa" class="csl-entry" role="listitem">
Sakai, Masato, Akihisa Sakurai, Siyuan Lu, Jorge Olano, Conrad M. Albrecht, Hendrik F. Hamann, and Marcus Freitag. 2024. <span>“<span class="nocase">AI-accelerated Nazca survey nearly doubles the number of known figurative geoglyphs and sheds light on their purpose</span>.”</span> <em>Proceedings of the National Academy of Sciences</em> 121 (40): e2407652121. <a href="https://doi.org/10.1073/pnas.2407652121">https://doi.org/10.1073/pnas.2407652121</a>.
</div>
<div id="ref-Shumailov:2024aa" class="csl-entry" role="listitem">
Shumailov, Ilia, Zakhar Shumaylov, Yiren Zhao, Nicolas Papernot, Ross Anderson, and Yarin Gal. 2024. <span>“<span class="nocase">AI models collapse when trained on recursively generated data</span>.”</span> <em>Nature</em> 631 (8022): 755–59. <a href="https://doi.org/10.1038/s41586-024-07566-y">https://doi.org/10.1038/s41586-024-07566-y</a>.
</div>
</div>
</section></section>
<section>
<section id="sec-pipeline" class="title-slide slide level1 appendix center">
<h1>Appendix: Pipeline</h1>

</section>
<section id="pipeline" class="slide level2">
<h2>Pipeline</h2>
<div id="dc992776" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a></a><span class="im">from</span> sklearn.pipeline <span class="im">import</span> Pipeline</span>
<span id="cb26-2"><a></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb26-3"><a></a></span>
<span id="cb26-4"><a></a>num_pipeline <span class="op">=</span> Pipeline([</span>
<span id="cb26-5"><a></a>        (<span class="st">'imputer'</span>, SimpleImputer(strategy<span class="op">=</span><span class="st">"median"</span>)),</span>
<span id="cb26-6"><a></a>        (<span class="st">'attribs_adder'</span>, CombinedAttributesAdder()),</span>
<span id="cb26-7"><a></a>        (<span class="st">'std_scaler'</span>, StandardScaler()),</span>
<span id="cb26-8"><a></a>        ])</span>
<span id="cb26-9"><a></a></span>
<span id="cb26-10"><a></a>training_num_tr <span class="op">=</span> num_pipeline.fit_transform(training_num)</span>
<span id="cb26-11"><a></a></span>
<span id="cb26-12"><a></a>full_pipeline <span class="op">=</span> ColumnTransformer([</span>
<span id="cb26-13"><a></a>        (<span class="st">"num"</span>, num_pipeline, num_attribs),</span>
<span id="cb26-14"><a></a>        (<span class="st">"cat"</span>, OneHotEncoder(), [<span class="st">"sequence"</span>]),</span>
<span id="cb26-15"><a></a>    ])</span>
<span id="cb26-16"><a></a></span>
<span id="cb26-17"><a></a>training_prepared <span class="op">=</span> full_pipeline.fit_transform(training)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<p>Marcel <strong>Turcotte</strong></p>
<p><a href="mailto:Marcel.Turcotte@uOttawa.ca">Marcel.Turcotte@uOttawa.ca</a></p>
<p>School of Electrical Engineering and <strong>Computer Science</strong> (EE<strong>CS</strong>)</p>
<p>University of Ottawa</p>
<div class="columns">
<div class="column" style="width:70%;">

</div><div class="column" style="width:30%;">
<p><a href="../../assets/images/MarcelT_The_Shell-DALLE-2024-09-30.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15"><img data-src="../../assets/images/MarcelT_The_Shell-DALLE-2024-09-30.png"></a></p>
</div></div>

<aside><div>
<p><strong>Attribution</strong>: Generated by DALL-E, via ChatGPT (GPT-4), OpenAI, September 30, 2024.</p>
<p>See next page for interactions.</p>
</div></aside></section>
<section id="gpt-4o-interactions-2024-09-30" class="slide level2 smaller scrollable">
<h2>GPT-4o interactions 2024-09-30</h2>
<p><strong>I presented GPT-4o with an image of the main character from <a href="https://a24films.com/films/marcel-the-shell-with-shoes-on">Marcel the Shell With Shoes On</a> and had the following interactions.</strong></p>
<p><strong>Marcel:</strong> How would you describe the subject of the image, its artistic quality, technique, and rendering style?</p>
<p><strong>GPT-4o</strong>: The image depicts a whimsical character that resembles a small shell with one large, expressive eye. It stands on two legs wearing shoes, giving it a cute and almost anthropomorphic appearance. The character has a surreal and quirky look, which lends it a sense of personality and charm.</p>
<p><strong>Artistic Quality</strong>:</p>
<p>The image is rendered with a high degree of polish and smoothness, possibly created digitally. The textures, shading, and lighting are soft and subtle, giving the character a smooth and rounded look. The rendering captures a delicate balance between realism (in the textures of the shell and shoes) and cartoon-like abstraction (in the exaggerated eye and small stature).</p>
<p><strong>Technique</strong>:</p>
<p>The artist appears to have employed a blend of digital painting and 3D-like modeling techniques, with careful attention to detail in the reflections in the eye and the textures of the shell and shoes. The color palette is muted, using soft tones that evoke a gentle, friendly atmosphere.</p>
<p><strong>Rendering Style</strong>:</p>
<p>The rendering style is a mix of minimalist and hyperrealist elements. The minimalism is seen in the simplified forms of the character—particularly the body and legs—while the hyperrealism comes through in the detailing of the eye and the subtle textures. This gives the character a tactile, almost tangible quality while maintaining its fantastical, imaginative essence.</p>
<p>The overall effect of the design is both charming and surreal, combining everyday objects (a shell, shoes) with anthropomorphic and fantastical elements to create a unique, playful character.</p>
<p><strong>Marcel:</strong> Create an image based on the following description: The image depicts a whimsical character that resembles a small shell with one large, expressive eye. It stands on two legs wearing shoes, giving it a cute and almost anthropomorphic appearance. The character has a surreal and quirky look, which lends it a sense of personality and charm.</p>
<p><strong>Artistic Quality</strong>:</p>
<p>The image is rendered with a high degree of polish and smoothness, possibly created digitally. The textures, shading, and lighting are soft and subtle, giving the character a smooth and rounded look. The rendering captures a delicate balance between realism (in the textures of the shell and shoes) and cartoon-like abstraction (in the exaggerated eye and small stature).</p>
<p><strong>Technique</strong>:</p>
<p>The artist appears to have employed a blend of digital painting and 3D-like modeling techniques, with careful attention to detail in the reflections in the eye and the textures of the shell and shoes. The color palette is muted, using soft tones that evoke a gentle, friendly atmosphere.</p>
<p><strong>Rendering Style</strong>:</p>
<p>The rendering style is a mix of minimalist and hyperrealist elements. The minimalism is seen in the simplified forms of the character—particularly the body and legs—while the hyperrealism comes through in the detailing of the eye and the subtle textures. This gives the character a tactile, almost tangible quality while maintaining its fantastical, imaginative essence.</p>
<p>The overall effect of the design is both charming and surreal, combining everyday objects (a shell, shoes) with anthropomorphic and fantastical elements to create a unique, playful character.</p>
<p><strong>GTP-4o</strong>: Here is the image based on the description you provided. Let me know if you’d like to make any adjustments!</p>


</section></section>

    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<p><img src="../../assets/images/uottawa_hor_black.png" class="slide-logo"></p>
<div class="footer footer-default">
<p><a href="https://turcotte.xyz/teaching/csi-4106">turcotte.xyz/teaching/csi-4106</a></p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="../../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
            const codeEl = trigger.previousElementSibling.cloneNode(true);
            for (const childEl of codeEl.children) {
              if (isCodeAnnotation(childEl)) {
                childEl.remove();
              }
            }
            return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp("https:\/\/turcotte\.xyz\/teaching\/csi-4106");
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    <script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
    (function() {
      let previousOnload = window.onload;
      window.onload = () => {
        if (previousOnload) {
          previousOnload();
        }
        lightboxQuarto.on('slide_before_load', (data) => {
          const { slideIndex, slideNode, slideConfig, player, trigger } = data;
          const href = trigger.getAttribute('href');
          if (href !== null) {
            const imgEl = window.document.querySelector(`a[href="${href}"] img`);
            if (imgEl !== null) {
              const srcAttr = imgEl.getAttribute("src");
              if (srcAttr && srcAttr.startsWith("data:")) {
                slideConfig.href = srcAttr;
              }
            }
          } 
        });
      
        lightboxQuarto.on('slide_after_load', (data) => {
          const { slideIndex, slideNode, slideConfig, player, trigger } = data;
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(slideNode);
          }
        });
      
      };
      
    })();
              </script>
    

<script src="https://platform.twitter.com/widgets.js"></script>
</body></html>