<!DOCTYPE html>
<html lang="en"><head>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/tabby.min.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.7.32">

  <meta name="author" content="Marcel Turcotte">
  <title>CSI 4106 - Fall 2025 – Monte Carlo Tree Search</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
      margin-bottom: 0em;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/theme/quarto-f563837468303362081e247dddd440d0.css">
  <link href="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
<meta property="og:title" content="Monte Carlo Tree Search – CSI 4106 - Fall 2025">
<meta property="og:description" content="CSI 4106 Introduction to Artificial Intelligence">
<meta property="og:site_name" content="CSI 4106 - Fall 2025">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Monte Carlo Tree Search</h1>
  <p class="subtitle">CSI 4106 Introduction to Artificial Intelligence</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Marcel Turcotte 
</div>
</div>
</div>

  <p class="date">Version: Jul 11, 2025 15:54</p>
</section>
<section>
<section id="preamble" class="title-slide slide level1 center">
<h1>Preamble</h1>

</section>
<section id="quote-of-the-day" class="slide level2">
<h2>Quote of the Day</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="../../assets/images/marco-o1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img data-src="../../assets/images/marco-o1.png" class="quarto-figure quarto-figure-center" height="475"></a></p>
</figure>
</div>

<aside class="notes">
<p>Alibaba has recently introduced a large-scale reasoning model named Marco-o1. This model employs Monte Carlo Tree Search (MCTS) to expand the solution space and devise innovative reasoning strategies.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<aside><div>
<p><a href="https://huggingface.co/AIDC-AI/Marco-o1">huggingface.co/AIDC-AI/Marco-o1</a> or <a href="https://ollama.com/library/marco-o1">ollama.com/library/marco-o1</a></p>
</div></aside></section>
<section id="learning-objectives" class="slide level2">
<h2>Learning objectives</h2>
<ul>
<li><strong>Explain</strong> the concept and key steps of Monte Carlo Tree Search (MCTS).</li>
<li><strong>Compare</strong> MCTS with other search algorithms like BFS, DFS, A*, Simulated Annealing, and Genetic Algorithms.</li>
<li><strong>Analyze</strong> how MCTS balances exploration and exploitation using the UCB1 formula.</li>
<li><strong>Implement</strong> MCTS in practical applications such as Tic-Tac-Toe.</li>
</ul>
</section></section>
<section>
<section id="introduction" class="title-slide slide level1 center">
<h1>Introduction</h1>

</section>
<section id="monte-carlo-tree-search-mcts" class="slide level2">
<h2>Monte Carlo Tree Search (MCTS)</h2>
<p>In the introductory lecture on <strong>state space search</strong>, I used <strong>Monte Carlo Tree Search (MCTS)</strong>, a key component of <strong>AlphaGo</strong>, to exemplify the role of search algorithms in reasoning.</p>
<p>Today, we conclude this series by examining the implementation details of this algorithm.</p>
</section>
<section id="applications" class="slide level2">
<h2>Applications</h2>
<ul>
<li>De novo drug design</li>
<li>Electronic circuit routing</li>
<li>Load monitoring in smart grids</li>
<li>Lane keeping and overtaking tasks</li>
<li>Motion planning in autonomous driving</li>
<li>Even solving the travelling salesman problem</li>
</ul>

<aside class="notes">
<p>The paper by Kemmerling and colleagues&nbsp;<span class="citation" data-cites="Kemmerling:2024aa">(<a href="#/references" role="doc-biblioref" onclick="">Kemmerling, Lütticke, and Schmitt 2024</a>)</span> illustrates the wide range of applications for MCTS when combined with deep neural networks.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<aside><div>
<p><strong>See</strong>: <span class="citation" data-cites="Kemmerling:2024aa">Kemmerling, Lütticke, and Schmitt (<a href="#/references" role="doc-biblioref" onclick="">2024</a>)</span></p>
</div></aside></section>
<section id="historical-notes" class="slide level2">
<h2>Historical Notes</h2>
<ul>
<li><strong>2008</strong>: the algorithm is introduced in the context of <strong>AI game</strong> <span class="citation" data-cites="Chaslot:2008aa">(<a href="#/references" role="doc-biblioref" onclick="">Chaslot et al. 2008</a>)</span></li>
<li><strong>2016</strong>: the algorithm is combined with <strong>deep neural networks</strong> to create <strong>AlphaGo</strong> <span class="citation" data-cites="Silver:2016aa">(<a href="#/references" role="doc-biblioref" onclick="">Silver et al. 2016</a>)</span></li>
</ul>
</section>
<section id="definition" class="slide level2">
<h2>Definition</h2>
<p>A <strong>Monte Carlo algorithm</strong> is a computational method that uses <strong>random sampling to obtain numerical results</strong>, often used for optimization, numerical integration, and probability distribution estimation.</p>
<p>It is characterized by its ability to handle <strong>complex problems</strong> with probabilistic solutions, trading <strong>exactness</strong> for <strong>efficiency</strong> and <strong>scalability</strong>.</p>
</section>
<section id="algorithm" class="slide level2">
<h2>Algorithm</h2>
<ol type="1">
<li><strong>Selection</strong> (tree traversal)</li>
<li>Node <strong>expansion</strong></li>
<li><strong>Rollout</strong> (simulation)</li>
<li><strong>Back-propagation</strong></li>
</ol>
</section>
<section id="algorithm-1" class="slide level2">
<h2>Algorithm</h2>
<div class="quarto-figure quarto-figure-centre">
<figure>
<p><a href="../../assets/images/mcts_rn-5_11.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img data-src="../../assets/images/mcts_rn-5_11.png" class="quarto-figure quarto-figure-centre"></a></p>
</figure>
</div>

<aside><div>
<p><strong>Attribution</strong>: <span class="citation" data-cites="Russell:2020aa">Russell and Norvig (<a href="#/references" role="doc-biblioref" onclick="">2020</a>)</span>, Figure 5.11</p>
</div></aside></section>
<section id="discussion" class="slide level2">
<h2>Discussion</h2>
<p>Like other algorithms previously discussed, such as <strong>BFS</strong>, <strong>DFS</strong>, and <span class="math inline">\(A^\star\)</span>, Monte Carlo Tree Search (MCTS) maintains a <strong>frontier</strong> of unexpanded nodes.</p>
<aside class="notes">
<p>Examining the relationship between MCTS and previous search algorithms offers valuable insights into their similarities and differences, providing an excellent opportunity to synthesize key concepts.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="discussion-1" class="slide level2">
<h2>Discussion</h2>
<p>Similar to <span class="math inline">\(A^\star\)</span>, Monte Carlo Tree Search (MCTS) employs a heuristic, referred to as a <strong>policy</strong>, to determine the <strong>optimal node for expansion</strong>.</p>
<p>However, in <span class="math inline">\(A^\star\)</span>, the heuristic is typically a <strong>static</strong> function estimating cost to a goal, whereas in MCTS, the “policy” involves <strong>dynamic</strong> evaluation.</p>
<aside class="notes">
<p>By “static evaluation,” we mean a function that yields the same result for a given state, irrespective of the moment the function is called within the program’s execution.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="discussion-2" class="slide level2">
<h2>Discussion</h2>
<p>Similar to <strong>Simulated Annealing</strong> and <strong>Genetic Algorithms</strong>, Monte Carlo Tree Search (MCTS) incorporates a mechanism to <strong>balance</strong> <strong>exploration</strong> and <strong>exploitation</strong>.</p>
</section>
<section id="discussion-3" class="slide level2">
<h2>Discussion</h2>
<ul>
<li class="fragment">MCTS <strong>leverages all visited nodes</strong> in its <strong>decision-making process</strong>, unlike <span class="math inline">\(A^\star\)</span>, which primarily focuses on the current frontier.</li>
<li class="fragment">Additionally, <strong>MCTS iteratively updates the value of its nodes based on simulations</strong>, whereas <span class="math inline">\(A^\star\)</span> typically uses a <strong>static</strong> heuristic.</li>
</ul>

<aside><div>
<p>The effectiveness of MCTS in selecting promising nodes increases with longer execution time.</p>
</div></aside></section>
<section id="discussion-4" class="slide level2">
<h2>Discussion</h2>
<p>In contrast to previous algorithms with <strong>implicit</strong> search trees, MCTS constructs an <strong>explicit</strong> <strong>tree structure</strong> during execution.</p>

<aside class="notes">
<p>While previous algorithms often imply a search tree structure without explicitly constructing it, MCTS explicitly builds and maintains a tree structure during execution.</p>
<p>This explicit tree is used to record the outcomes of simulations and guide decision-making.</p>
<p>The explicit tree tracks visited states and their evaluations, while the implicit aspect refers to the expansion of the tree during simulations.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<aside><div>
<p>As we will explore, MCTS maintains <strong>both</strong> <strong>explicit</strong> and <strong>implicit</strong> representations of the search tree.</p>
</div></aside></section>
<section id="walk-through" class="slide level2">
<h2>Walk-through</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="../../assets/images/mtcs-00.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img data-src="../../assets/images/mtcs-00.png" class="quarto-figure quarto-figure-center" height="450"></a></p>
</figure>
</div>

<aside><div>
<p>Adapted from: <a href="https://youtu.be/UXW2yZndl7U">Monte Carlo Tree Search</a> by John Levine posted on YouTube on 2017-03-06.</p>
</div></aside></section>
<section id="walk-through-1" class="slide level2">
<h2>Walk-through</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="../../assets/images/mtcs-01.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img data-src="../../assets/images/mtcs-01.png" class="quarto-figure quarto-figure-center" height="450"></a></p>
</figure>
</div>

<aside><div>
<p>Each node keeps track of the number of visits (<span class="math inline">\(n\)</span>) and a total score (<span class="math inline">\(t\)</span>).</p>
<p><span class="math inline">\(S_0\)</span> is the initial state.</p>
</div></aside></section>
<section id="walk-through-2" class="slide level2">
<h2>Walk-through</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="../../assets/images/mtcs-01b.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img data-src="../../assets/images/mtcs-01b.png" class="quarto-figure quarto-figure-center" height="450"></a></p>
</figure>
</div>

<aside><div>
<p>Adding the available actions, <span class="math inline">\(a_1\)</span> and <span class="math inline">\(a_2\)</span>, as well as the corresponding states, <span class="math inline">\(S_1\)</span> and <span class="math inline">\(S_2\)</span>.</p>
</div></aside></section>
<section id="walk-through-3" class="slide level2">
<h2>Walk-through</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="../../assets/images/mtcs-01b.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img data-src="../../assets/images/mtcs-01b.png" class="quarto-figure quarto-figure-center" height="450"></a></p>
</figure>
</div>

<aside><div>
<p>1.1 Start of the first iteration: Selection Step.</p>
</div></aside></section>
<section id="walk-through-4" class="slide level2">
<h2>Walk-through</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="../../assets/images/mtcs-01b.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img data-src="../../assets/images/mtcs-01b.png" class="quarto-figure quarto-figure-center" height="450"></a></p>
</figure>
</div>

<aside><div>
<p>1.1 The UCB1 score of <span class="math inline">\(S_1\)</span> and <span class="math inline">\(S_2\)</span> are both <span class="math inline">\(\infty\)</span> since <span class="math inline">\(n_1 = n_2 = 0\)</span>.</p>
<p>We can select the either node.</p>
</div></aside></section>
<section id="walk-through-5" class="slide level2">
<h2>Walk-through</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="../../assets/images/mtcs-01b.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img data-src="../../assets/images/mtcs-01b.png" class="quarto-figure quarto-figure-center" height="450"></a></p>
</figure>
</div>

<aside><div>
<p>1.1 We reached a leaf node, <span class="math inline">\(S_1\)</span>.</p>
</div></aside></section>
<section id="walk-through-6" class="slide level2">
<h2>Walk-through</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="../../assets/images/mtcs-01b.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img data-src="../../assets/images/mtcs-01b.png" class="quarto-figure quarto-figure-center" height="450"></a></p>
</figure>
</div>

<aside><div>
<p>1.2 Node expansion. This node has not been visited yet. Therefore, no expansion.</p>
</div></aside></section>
<section id="walk-through-7" class="slide level2">
<h2>Walk-through</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="../../assets/images/mtcs-02.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10"><img data-src="../../assets/images/mtcs-02.png" class="quarto-figure quarto-figure-center" height="450"></a></p>
</figure>
</div>

<aside><div>
<p>1.3 A rollout (simulation) is simply randomly selecting actions until a terminal node is found.</p>
</div></aside></section>
<section id="walk-through-8" class="slide level2">
<h2>Walk-through</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="../../assets/images/mtcs-03.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11"><img data-src="../../assets/images/mtcs-03.png" class="quarto-figure quarto-figure-center" height="450"></a></p>
</figure>
</div>

<aside><div>
<p>1.4 Back-propagation.</p>
</div></aside></section>
<section id="walk-through-9" class="slide level2">
<h2>Walk-through</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="../../assets/images/mtcs-04.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12"><img data-src="../../assets/images/mtcs-04.png" class="quarto-figure quarto-figure-center" height="450"></a></p>
</figure>
</div>

<aside><div>
<p>End of iteration 1.</p>
</div></aside></section>
<section id="walk-through-10" class="slide level2">
<h2>Walk-through</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="../../assets/images/mtcs-04.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13"><img data-src="../../assets/images/mtcs-04.png" class="quarto-figure quarto-figure-center" height="450"></a></p>
</figure>
</div>

<aside><div>
<p>2.1 Selection. Computing the UCB1 value of <span class="math inline">\(S_1 = 20 + 2 \sqrt{\frac{\ln(1)}{1}}\)</span> and <span class="math inline">\(S_2  = \infty\)</span>.</p>
<p>We select <span class="math inline">\(S_2\)</span>.</p>
</div></aside></section>
<section id="walk-through-11" class="slide level2">
<h2>Walk-through</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="../../assets/images/mtcs-04.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14"><img data-src="../../assets/images/mtcs-04.png" class="quarto-figure quarto-figure-center" height="450"></a></p>
</figure>
</div>

<aside><div>
<p>2.2 Expansion. This node has not been visited yet. Therefore, no expansion.</p>
</div></aside></section>
<section id="walk-through-12" class="slide level2">
<h2>Walk-through</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="../../assets/images/mtcs-06.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15"><img data-src="../../assets/images/mtcs-06.png" class="quarto-figure quarto-figure-center" height="450"></a></p>
</figure>
</div>

<aside><div>
<p>2.3 Rollout.</p>
</div></aside></section>
<section id="walk-through-13" class="slide level2">
<h2>Walk-through</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="../../assets/images/mtcs-06b.png" class="lightbox" data-gallery="quarto-lightbox-gallery-16"><img data-src="../../assets/images/mtcs-06b.png" class="quarto-figure quarto-figure-center" height="450"></a></p>
</figure>
</div>

<aside><div>
<p>2.4 Back-propagation.</p>
</div></aside></section>
<section id="walk-through-14" class="slide level2">
<h2>Walk-through</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="../../assets/images/mtcs-07.png" class="lightbox" data-gallery="quarto-lightbox-gallery-17"><img data-src="../../assets/images/mtcs-07.png" class="quarto-figure quarto-figure-center" height="450"></a></p>
</figure>
</div>

<aside><div>
<p>End of iteration 2.</p>
</div></aside></section>
<section id="walk-through-15" class="slide level2">
<h2>Walk-through</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="../../assets/images/mtcs-07.png" class="lightbox" data-gallery="quarto-lightbox-gallery-18"><img data-src="../../assets/images/mtcs-07.png" class="quarto-figure quarto-figure-center" height="450"></a></p>
</figure>
</div>

<aside><div>
<p>3.1 Selection. Calculating UCB1 values.</p>
</div></aside></section>
<section id="walk-through-16" class="slide level2">
<h2>Walk-through</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="../../assets/images/mtcs-07.png" class="lightbox" data-gallery="quarto-lightbox-gallery-19"><img data-src="../../assets/images/mtcs-07.png" class="quarto-figure quarto-figure-center" height="450"></a></p>
</figure>
</div>

<aside><div>
<p>3.1 Selection.</p>
<p>Computing the UCB1 value of <span class="math inline">\(S_1 = 20 + 2 \sqrt{\frac{\ln(2)}{1}} = 21.67\)</span> and <span class="math inline">\(S_2  = 10 + 2 \sqrt{\frac{\ln(2)}{1}} = 11.67\)</span>.</p>
<p>Selecting <span class="math inline">\(S_1\)</span></p>
</div></aside></section>
<section id="walk-through-17" class="slide level2">
<h2>Walk-through</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="../../assets/images/mtcs-07.png" class="lightbox" data-gallery="quarto-lightbox-gallery-20"><img data-src="../../assets/images/mtcs-07.png" class="quarto-figure quarto-figure-center" height="450"></a></p>
</figure>
</div>

<aside><div>
<p>3.2 Node expansion.</p>
</div></aside></section>
<section id="walk-through-18" class="slide level2">
<h2>Walk-through</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="../../assets/images/mtcs-08.png" class="lightbox" data-gallery="quarto-lightbox-gallery-21"><img data-src="../../assets/images/mtcs-08.png" class="quarto-figure quarto-figure-center" height="450"></a></p>
</figure>
</div>

<aside><div>
<p>3.2 Node expansion. Since <span class="math inline">\(n_1 \gt 0\)</span>, the node is expanded.</p>
</div></aside></section>
<section id="walk-through-19" class="slide level2">
<h2>Walk-through</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="../../assets/images/mtcs-09.png" class="lightbox" data-gallery="quarto-lightbox-gallery-22"><img data-src="../../assets/images/mtcs-09.png" class="quarto-figure quarto-figure-center" height="450"></a></p>
</figure>
</div>

<aside><div>
<p>3.3 Rollout.</p>
</div></aside></section>
<section id="walk-through-20" class="slide level2">
<h2>Walk-through</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="../../assets/images/mtcs-10.png" class="lightbox" data-gallery="quarto-lightbox-gallery-23"><img data-src="../../assets/images/mtcs-10.png" class="quarto-figure quarto-figure-center" height="450"></a></p>
</figure>
</div>

<aside><div>
<p>3.4 Back-propagation.</p>
</div></aside></section>
<section id="walk-through-21" class="slide level2">
<h2>Walk-through</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="../../assets/images/mtcs-11.png" class="lightbox" data-gallery="quarto-lightbox-gallery-24"><img data-src="../../assets/images/mtcs-11.png" class="quarto-figure quarto-figure-center" height="450"></a></p>
</figure>
</div>

<aside><div>
<p>End of iteration 3.</p>
</div></aside></section>
<section id="walk-through-22" class="slide level2">
<h2>Walk-through</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="../../assets/images/mtcs-11.png" class="lightbox" data-gallery="quarto-lightbox-gallery-25"><img data-src="../../assets/images/mtcs-11.png" class="quarto-figure quarto-figure-center" height="450"></a></p>
</figure>
</div>

<aside><div>
<p>4.1 Selection. Calculating UCB1 values.</p>
</div></aside></section>
<section id="walk-through-23" class="slide level2">
<h2>Walk-through</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="../../assets/images/mtcs-11.png" class="lightbox" data-gallery="quarto-lightbox-gallery-26"><img data-src="../../assets/images/mtcs-11.png" class="quarto-figure quarto-figure-center" height="450"></a></p>
</figure>
</div>

<aside><div>
<p>Computing the UCB1 value of <span class="math inline">\(S_1 = \frac{20}{2} + 2 \sqrt{\frac{\ln(3)}{2}} = 10 + 2 \sqrt{\frac{\ln(3)}{2}} = 11.48\)</span> and <span class="math inline">\(S_2  == 10 + 2 \sqrt{\frac{\ln(3)}{1}} = 12.10\)</span>.</p>
<p>Selecting <span class="math inline">\(S_2\)</span></p>
</div></aside></section>
<section id="walk-through-24" class="slide level2">
<h2>Walk-through</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="../../assets/images/mtcs-12.png" class="lightbox" data-gallery="quarto-lightbox-gallery-27"><img data-src="../../assets/images/mtcs-12.png" class="quarto-figure quarto-figure-center" height="450"></a></p>
</figure>
</div>

<aside><div>
<p>4.2 Expansion.</p>
</div></aside></section>
<section id="walk-through-25" class="slide level2">
<h2>Walk-through</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="../../assets/images/mtcs-12.png" class="lightbox" data-gallery="quarto-lightbox-gallery-28"><img data-src="../../assets/images/mtcs-12.png" class="quarto-figure quarto-figure-center" height="450"></a></p>
</figure>
</div>

<aside><div>
<p>4.2 Expansion. Both nodes have the same USCB1 value, <span class="math inline">\(\infty\)</span>.</p>
<p>Selecting <span class="math inline">\(S_6\)</span>.</p>
</div></aside></section>
<section id="walk-through-26" class="slide level2">
<h2>Walk-through</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="../../assets/images/mtcs-13.png" class="lightbox" data-gallery="quarto-lightbox-gallery-29"><img data-src="../../assets/images/mtcs-13.png" class="quarto-figure quarto-figure-center" height="450"></a></p>
</figure>
</div>

<aside><div>
<p>4.3 Rollout.</p>
</div></aside></section>
<section id="walk-through-27" class="slide level2">
<h2>Walk-through</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="../../assets/images/mtcs-14.png" class="lightbox" data-gallery="quarto-lightbox-gallery-30"><img data-src="../../assets/images/mtcs-14.png" class="quarto-figure quarto-figure-center" height="450"></a></p>
</figure>
</div>

<aside><div>
<p>4.4 Back-propagation.</p>
</div></aside></section>
<section id="walk-through-28" class="slide level2">
<h2>Walk-through</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="../../assets/images/mtcs-15.png" class="lightbox" data-gallery="quarto-lightbox-gallery-31"><img data-src="../../assets/images/mtcs-15.png" class="quarto-figure quarto-figure-center" height="450"></a></p>
</figure>
</div>

<aside><div>
<p>End of iteration 4.</p>
</div></aside></section>
<section id="walk-through-29" class="slide level2">
<h2>Walk-through</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="../../assets/images/mtcs-15.png" class="lightbox" data-gallery="quarto-lightbox-gallery-32"><img data-src="../../assets/images/mtcs-15.png" class="quarto-figure quarto-figure-center" height="450"></a></p>
</figure>
</div>

<aside class="notes">
<p>In applications such as chess, Go, or Atari games, MCTS conducts 1000 to 2000 simulations per move. This seemingly low count is attributed to the use of deep learning algorithms, which direct the search through tree and default policies.</p>
<p>Each set of iterations, for instance, 1000, is utilized solely to determine the subsequent optimal move.</p>
<p>During the initial iterations, MCTS operates with limited information for selecting the next best move. As iterations increase, the estimates become more refined.</p>
<p>The number of nodes in a search tree after 1000 iterations of MCTS depends on several factors, including the branching factor at each node and the specific policy used for node expansion. Generally, each iteration of MCTS consists of four main steps: selection, expansion, simulation, and backpropagation. During the expansion phase, a new node is added to the tree.</p>
<p>In a typical MCTS setup:</p>
<ol type="1">
<li><strong>Selection</strong>: Traverse the existing tree from the root to a leaf node using a tree policy, often based on Upper Confidence Bounds for Trees (UCT).</li>
<li><strong>Expansion</strong>: Add one or more child nodes to the selected node if it is not fully expanded.</li>
<li><strong>Simulation</strong>: Perform a simulation from the new node to a terminal state.</li>
<li><strong>Backpropagation</strong>: Update the value estimates of the traversed nodes based on the simulation result.</li>
</ol>
<p>Assuming that each iteration expands exactly one new node, the search tree will have approximately 1000 additional nodes after 1000 iterations. However, the actual number can vary if multiple nodes are expanded per iteration or due to the tree’s initial setup and other variations in the algorithm’s implementation.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<aside><div>
<p>If the algorithm halts at this stage, it will recommend <span class="math inline">\(a_2\)</span> as the optimal move, given that <span class="math inline">\(S_2\)</span> possesses the highest average score.</p>
</div></aside></section>
<section id="russell-and-norvig" class="slide level2">
<h2>Russell and Norvig</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="../../assets/images/mcts_rn-5_10.png" class="lightbox" data-gallery="quarto-lightbox-gallery-33"><img data-src="../../assets/images/mcts_rn-5_10.png" class="quarto-figure quarto-figure-center" height="450"></a></p>
</figure>
</div>

<aside class="notes">
<p>This example includes a significantly larger number of nodes, which may aid in comprehending the selection step more effectively.</p>
<p>The algorithm seeks to navigate toward the most promising area of the tree, characterized by the highest average score, and subsequently expands this section of the search tree.</p>
<p>Observe that the backpropagation step updates all nodes along the path from the selected node to the root. This update can influence the path chosen in the subsequent iteration.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<aside><div>
<p><strong>Attribution</strong>: <span class="citation" data-cites="Russell:2020aa">Russell and Norvig (<a href="#/references" role="doc-biblioref" onclick="">2020</a>)</span>, Figure 5.10</p>
</div></aside></section>
<section id="summary-1" class="slide level2">
<h2>Summary (1)</h2>
<p>Initially, the tree has one node, it is <span class="math inline">\(S_0\)</span>.</p>
<p>We add its descendants and we are ready to start.</p>
<p>The Monte Carlo Tree Search slowly builds its search tree.</p>
</section>
<section id="summary-2" class="slide level2 smaller">
<h2>Summary (2)</h2>
<p>With each iteration, the following steps occur:</p>
<ol type="1">
<li><p><strong>Selection</strong>: Identify the optimal node by traversing a single path in the tree, guided by UCB1.</p></li>
<li><p><strong>Expansion</strong>: Expand the node if it is a leaf in the MCTS Tree and <span class="math inline">\(n \gt 0\)</span>.</p></li>
<li><p><strong>Rollout</strong>: Simulate a game from the current state to a terminal state by randomly selecting actions.</p></li>
<li><p><strong>Backpropagation</strong>: Use the obtained information to update the current node and all parent nodes up to the root.</p></li>
</ol>
</section>
<section id="summary-3" class="slide level2">
<h2>Summary (3)</h2>
<p>Each node records its total score and visit count.</p>
<p>This information is used to calculate a value that guides tree traversal, balancing exploration and exploitation.</p>
</section>
<section id="summary-4" class="slide level2 smaller">
<h2>Summary (4)</h2>
<p><span class="math display">\[
\mathrm{UCB1}(S_i) = \overline{V_i} + C \sqrt{\frac{\ln(N)}{n_i}}
\]</span></p>
<p>The usual value for <span class="math inline">\(C\)</span> is <span class="math inline">\(\sqrt{2}\)</span>.</p>
<p>Exploration essentially occurs when two nodes have approximately the same average score, then MCTS favours nodes with fewer visits (dividing by <span class="math inline">\(n\)</span>).</p>
<p>For <span class="math inline">\(n \lt \ln(N)\)</span>, the value of the ratio is greater than 1, whereas for <span class="math inline">\(n \gt \ln(N)\)</span>, the ratio becomes less than 1.</p>
<p>So there is a small fraction of the time where exploration kicks in. But even then, the contribution of the ratio is quite tame, we’re taking the square root of that ratio, multiplied by <span class="math inline">\(\sqrt{2} \sim 1.414213562\)</span>.</p>
</section>
<section id="summary-5" class="slide level2">
<h2>Summary (5)</h2>
<div id="657f1dd9" class="cell" data-execution_count="1">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><a href="slides_files/figure-revealjs/cell-2-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-34"><img data-src="slides_files/figure-revealjs/cell-2-output-1.png" width="801" height="523"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[4.60517019 6.90775528 9.21034037]</code></pre>
</div>
</div>
</section>
<section id="summary-5-1" class="slide level2">
<h2>Summary (5)</h2>
<div id="80bb1978" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-2"><a></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb2-3"><a></a></span>
<span id="cb2-4"><a></a>num_iterations <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb2-5"><a></a></span>
<span id="cb2-6"><a></a><span class="co"># Define the range for n and N</span></span>
<span id="cb2-7"><a></a>n_values <span class="op">=</span> np.arange(<span class="dv">1</span>, num_iterations <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb2-8"><a></a>N_values <span class="op">=</span> np.arange(<span class="dv">1</span>, num_iterations <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb2-9"><a></a></span>
<span id="cb2-10"><a></a><span class="co"># Prepare a meshgrid for n and N</span></span>
<span id="cb2-11"><a></a>N, n <span class="op">=</span> np.meshgrid(N_values, n_values)</span>
<span id="cb2-12"><a></a></span>
<span id="cb2-13"><a></a><span class="co"># Compute the expression for each pair (n, N)</span></span>
<span id="cb2-14"><a></a>Z <span class="op">=</span> np.sqrt(<span class="dv">2</span>) <span class="op">*</span> np.sqrt(np.log(N) <span class="op">/</span> n)</span>
<span id="cb2-15"><a></a></span>
<span id="cb2-16"><a></a><span class="co"># Plotting</span></span>
<span id="cb2-17"><a></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb2-18"><a></a>plt.contourf(N, n, Z, cmap<span class="op">=</span><span class="st">'viridis'</span>)</span>
<span id="cb2-19"><a></a>plt.colorbar(label<span class="op">=</span><span class="vs">r'</span><span class="dv">$\s</span><span class="vs">qrt</span><span class="op">{2}</span><span class="vs"> </span><span class="ch">\t</span><span class="vs">imes </span><span class="dv">\s</span><span class="vs">qrt{</span><span class="ch">\f</span><span class="vs">rac{</span><span class="er">\</span><span class="vs">log{N}}{n}}</span><span class="dv">$</span><span class="vs">'</span>)</span>
<span id="cb2-20"><a></a>plt.xlabel(<span class="st">'N'</span>)</span>
<span id="cb2-21"><a></a>plt.ylabel(<span class="st">'n'</span>)</span>
<span id="cb2-22"><a></a>plt.title(<span class="vs">r'Visualization of </span><span class="dv">$\s</span><span class="vs">qrt</span><span class="op">{2}</span><span class="vs"> </span><span class="ch">\t</span><span class="vs">imes </span><span class="dv">\s</span><span class="vs">qrt{</span><span class="ch">\f</span><span class="vs">rac{</span><span class="er">\</span><span class="vs">log{N}}{n}}</span><span class="dv">$</span><span class="vs"> for </span><span class="dv">$</span><span class="vs">n, N = 1</span><span class="dv">..\m</span><span class="vs">athrm{num</span><span class="ch">\_</span><span class="vs">iterations}</span><span class="dv">$</span><span class="vs">'</span>)</span>
<span id="cb2-23"><a></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><a href="slides_files/figure-revealjs/cell-3-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-35"><img data-src="slides_files/figure-revealjs/cell-3-output-1.png" width="654" height="536"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="summary-5-2" class="slide level2">
<h2>Summary (5)</h2>
<div id="44598123" class="cell" data-execution_count="3">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-2"><a></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb3-3"><a></a></span>
<span id="cb3-4"><a></a>num_iterations <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb3-5"><a></a></span>
<span id="cb3-6"><a></a><span class="co"># Define the range for n and N</span></span>
<span id="cb3-7"><a></a>n_values <span class="op">=</span> np.arange(<span class="dv">1</span>, num_iterations <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb3-8"><a></a>N_values <span class="op">=</span> np.arange(<span class="dv">1</span>, num_iterations <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb3-9"><a></a></span>
<span id="cb3-10"><a></a><span class="co"># Prepare a meshgrid for n and N</span></span>
<span id="cb3-11"><a></a>N, n <span class="op">=</span> np.meshgrid(N_values, n_values)</span>
<span id="cb3-12"><a></a></span>
<span id="cb3-13"><a></a><span class="co"># Compute the expression for each pair (n, N)</span></span>
<span id="cb3-14"><a></a>Z <span class="op">=</span> np.sqrt(<span class="dv">2</span>) <span class="op">*</span> np.sqrt(np.log(N) <span class="op">/</span> n)</span>
<span id="cb3-15"><a></a></span>
<span id="cb3-16"><a></a><span class="co"># Plotting</span></span>
<span id="cb3-17"><a></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb3-18"><a></a>plt.contourf(N, n, Z, cmap<span class="op">=</span><span class="st">'viridis'</span>)</span>
<span id="cb3-19"><a></a>plt.colorbar(label<span class="op">=</span><span class="vs">r'</span><span class="dv">$\s</span><span class="vs">qrt</span><span class="op">{2}</span><span class="vs"> </span><span class="ch">\t</span><span class="vs">imes </span><span class="dv">\s</span><span class="vs">qrt{</span><span class="ch">\f</span><span class="vs">rac{</span><span class="er">\</span><span class="vs">log{N}}{n}}</span><span class="dv">$</span><span class="vs">'</span>)</span>
<span id="cb3-20"><a></a>plt.xlabel(<span class="st">'N'</span>)</span>
<span id="cb3-21"><a></a>plt.ylabel(<span class="st">'n'</span>)</span>
<span id="cb3-22"><a></a>plt.title(<span class="vs">r'Visualization of </span><span class="dv">$\s</span><span class="vs">qrt</span><span class="op">{2}</span><span class="vs"> </span><span class="ch">\t</span><span class="vs">imes </span><span class="dv">\s</span><span class="vs">qrt{</span><span class="ch">\f</span><span class="vs">rac{</span><span class="er">\</span><span class="vs">log{N}}{n}}</span><span class="dv">$</span><span class="vs"> for </span><span class="dv">$</span><span class="vs">n, N = 1</span><span class="dv">..\m</span><span class="vs">athrm{num</span><span class="ch">\_</span><span class="vs">iterations}</span><span class="dv">$</span><span class="vs">'</span>)</span>
<span id="cb3-23"><a></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><a href="slides_files/figure-revealjs/cell-4-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-36"><img data-src="slides_files/figure-revealjs/cell-4-output-1.png" width="662" height="536"></a></p>
</figure>
</div>
</div>
</div>
<aside class="notes">
<p><strong>Origin of UCB1 in MCTS:</strong></p>
<p>The <strong>Upper Confidence Bound 1 (UCB1)</strong> formula originates from the <strong>multi-armed bandit problem</strong>, a classic problem in reinforcement learning and decision theory. In this problem, a gambler must decide which arm of multiple slot machines to pull to maximize their total reward, balancing the exploration of less-known machines and the exploitation of machines known to provide high rewards.</p>
<p>The UCB1 algorithm was developed to address this exploration-exploitation dilemma by providing a statistical upper bound on the expected reward of each action (or arm). In the context of <strong>Monte Carlo Tree Search (MCTS)</strong>, UCB1 is adapted to guide the selection of nodes during the <strong>Selection</strong> phase, helping the algorithm decide which node to explore next.</p>
<p><strong>Understanding the UCB1 Formula:</strong></p>
<p>The UCB1 formula used in MCTS is:</p>
<p><span class="math display">\[
\text{UCB1}(i) = \overline{X}_i + C \sqrt{\frac{\ln N}{n_i}}
\]</span></p>
<ul>
<li><strong><span class="math inline">\(\overline{X}_i\)</span></strong>: The average reward (value) of node <span class="math inline">\(i\)</span> (exploitation term).</li>
<li><strong><span class="math inline">\(C\)</span></strong>: A constant parameter that balances exploration and exploitation (commonly set to <span class="math inline">\(\sqrt{2}\)</span>).</li>
<li><strong><span class="math inline">\(N\)</span></strong>: The total number of simulations or visits to the parent node.</li>
<li><strong><span class="math inline">\(n_i\)</span></strong>: The number of times node <span class="math inline">\(i\)</span> has been visited.</li>
</ul>
<p><strong>Components Explained:</strong></p>
<ol type="1">
<li><p><strong>Exploitation Term (<span class="math inline">\(\overline{X}_i\)</span>)</strong>: Represents the average reward obtained from node <span class="math inline">\(i\)</span>, encouraging the selection of nodes with higher known rewards.</p></li>
<li><p><strong>Exploration Term (<span class="math inline">\(C \sqrt{\frac{\ln N}{n_i}}\)</span>)</strong>: Provides a bonus to nodes that have been visited less frequently, encouraging the exploration of less-visited nodes.</p></li>
</ol>
<p><strong>Balancing Exploration and Exploitation:</strong></p>
<ul>
<li><strong>Exploitation</strong>: Favors nodes with high average rewards.</li>
<li><strong>Exploration</strong>: Favors nodes that have been visited less, to gather more information.</li>
</ul>
<p>The <strong>exploration term decreases as <span class="math inline">\(n_i\)</span> increases</strong>, meaning that as a node is visited more often, the incentive to explore it further diminishes. Conversely, nodes with fewer visits receive a higher exploration bonus.</p>
<p><strong>Why Exploration Occurs When Average Scores Are Similar:</strong></p>
<p>Here’s why:</p>
<ul>
<li><p><strong>Similar Average Rewards (<span class="math inline">\(\overline{X}_i\)</span>)</strong>: When nodes have comparable exploitation values, the exploration term becomes the deciding factor in the UCB1 value.</p></li>
<li><p><strong>Influence of the Exploration Term</strong>:</p>
<ul>
<li><strong>Less-Visited Nodes</strong>: Have a higher exploration term due to smaller <span class="math inline">\(n_i\)</span>, increasing their UCB1 value.</li>
<li><strong>Well-Visited Nodes</strong>: Have a lower exploration term, as <span class="math inline">\(n_i\)</span> is larger.</li>
</ul></li>
<li><p><strong>Result</strong>: The algorithm is more likely to select less-explored nodes when the average rewards are similar, promoting exploration to potentially discover better outcomes.</p></li>
</ul>
<p><strong>Mathematical Insight:</strong></p>
<ul>
<li>When <strong><span class="math inline">\(\overline{X}_i\)</span> values are equal</strong>, the UCB1 formula simplifies to comparing the exploration terms.</li>
<li>The node with the <strong>smaller <span class="math inline">\(n_i\)</span></strong> (less visited) will have a larger exploration term due to the <span class="math inline">\(\frac{1}{\sqrt{n_i}}\)</span> relationship.</li>
<li>As <strong><span class="math inline">\(N\)</span></strong> increases (more total simulations), the exploration bonus diminishes logarithmically, ensuring that the algorithm eventually favors exploitation.</li>
</ul>
<p><strong>Visualizing the Exploration Term:</strong></p>
<p>To further understand how exploration is encouraged:</p>
<ul>
<li><strong>Exploration Term Behavior</strong>:
<ul>
<li><strong>Early Stages (<span class="math inline">\(n_i\)</span> is small)</strong>: Exploration term is significant, promoting the exploration of all nodes.</li>
<li><strong>Later Stages (<span class="math inline">\(n_i\)</span> increases)</strong>: Exploration term decreases, and nodes with higher average rewards are preferred.</li>
</ul></li>
<li><strong>Logarithmic Growth</strong>:
<ul>
<li>The <span class="math inline">\(\ln N\)</span> term grows slowly, meaning that the exploration bonus reduces over time unless <span class="math inline">\(n_i\)</span> remains low.</li>
</ul></li>
</ul>
<p><strong>Conclusion:</strong></p>
<p>The UCB1 formula in MCTS effectively balances exploration and exploitation by:</p>
<ul>
<li><strong>Using the average reward</strong> to exploit known good nodes.</li>
<li><strong>Incorporating the exploration term</strong> to ensure that less-visited nodes are explored, especially when their average rewards are similar to others.</li>
<li><strong>Adapting over time</strong>, so the algorithm initially explores widely but gradually focuses on the most promising nodes as more information is gathered.</li>
</ul>
<p><strong>In summary</strong>, the UCB1 formula originates from the need to solve the exploration-exploitation dilemma in the multi-armed bandit problem and is integral to MCTS’s ability to efficiently search large decision spaces. The exploration primarily occurs when nodes have similar average scores because the exploration term then plays a crucial role in differentiating between them, guiding the algorithm to potentially unexplored but promising areas of the search space.</p>
<p><strong>Additional Resources:</strong></p>
<ul>
<li><strong>Research Papers</strong>:
<ul>
<li>Auer, P., Cesa-Bianchi, N., &amp; Fischer, P. (2002). <em>Finite-time Analysis of the Multiarmed Bandit Problem</em>. Machine Learning.</li>
<li>Kocsis, L., &amp; Szepesvári, C. (2006). <em>Bandit Based Monte-Carlo Planning</em>. ECML.</li>
</ul></li>
<li><strong>Further Reading</strong>:
<ul>
<li><a href="https://jeffbradberry.com/posts/2015/09/intro-to-monte-carlo-tree-search/">Monte Carlo Tree Search Tutorial</a></li>
<li><a href="https://www.baeldung.com/cs/monte-carlo-tree-search">Understanding UCB1 and MCTS</a></li>
</ul></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="tic-tac-toe" class="slide level2 scrollable">
<h2>Tic-tac-toe</h2>
<div id="a3764a79" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a></a><span class="co"># Game class for Tic-Tac-Toe</span></span>
<span id="cb4-2"><a></a><span class="kw">class</span> TicTacToe:</span>
<span id="cb4-3"><a></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb4-4"><a></a>        <span class="co"># Initialize the 3x3 board with empty spaces</span></span>
<span id="cb4-5"><a></a>        <span class="va">self</span>.size <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb4-6"><a></a>        <span class="va">self</span>.board <span class="op">=</span> np.full((<span class="va">self</span>.size, <span class="va">self</span>.size), <span class="st">' '</span>)</span>
<span id="cb4-7"><a></a></span>
<span id="cb4-8"><a></a>    <span class="kw">def</span> get_valid_moves(<span class="va">self</span>, state):</span>
<span id="cb4-9"><a></a>        <span class="co">"""</span></span>
<span id="cb4-10"><a></a><span class="co">        Return a list of available positions on the board.</span></span>
<span id="cb4-11"><a></a><span class="co">        """</span></span>
<span id="cb4-12"><a></a>        moves <span class="op">=</span> [(i, j) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="va">self</span>.size) <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="va">self</span>.size) <span class="cf">if</span> state[i][j] <span class="op">==</span> <span class="st">' '</span>]</span>
<span id="cb4-13"><a></a>        <span class="cf">return</span> moves</span>
<span id="cb4-14"><a></a></span>
<span id="cb4-15"><a></a>    <span class="kw">def</span> make_move(<span class="va">self</span>, state, move, player):</span>
<span id="cb4-16"><a></a>        <span class="co">"""</span></span>
<span id="cb4-17"><a></a><span class="co">        Place the player's symbol on the board at the specified move.</span></span>
<span id="cb4-18"><a></a><span class="co">        Return the new state.</span></span>
<span id="cb4-19"><a></a><span class="co">        """</span></span>
<span id="cb4-20"><a></a>        new_state <span class="op">=</span> state.copy()</span>
<span id="cb4-21"><a></a>        new_state[move[<span class="dv">0</span>], move[<span class="dv">1</span>]] <span class="op">=</span> player</span>
<span id="cb4-22"><a></a>        <span class="cf">return</span> new_state</span>
<span id="cb4-23"><a></a></span>
<span id="cb4-24"><a></a>    <span class="kw">def</span> get_opponent(<span class="va">self</span>, player):</span>
<span id="cb4-25"><a></a>        <span class="co">"""</span></span>
<span id="cb4-26"><a></a><span class="co">        Return the opponent of the given player.</span></span>
<span id="cb4-27"><a></a><span class="co">        """</span></span>
<span id="cb4-28"><a></a>        <span class="cf">return</span> <span class="st">'O'</span> <span class="cf">if</span> player <span class="op">==</span> <span class="st">'X'</span> <span class="cf">else</span> <span class="st">'X'</span></span>
<span id="cb4-29"><a></a></span>
<span id="cb4-30"><a></a>    <span class="kw">def</span> is_terminal(<span class="va">self</span>, state):</span>
<span id="cb4-31"><a></a>        <span class="co">"""</span></span>
<span id="cb4-32"><a></a><span class="co">        Check if the game has ended, either by win or draw.</span></span>
<span id="cb4-33"><a></a><span class="co">        """</span></span>
<span id="cb4-34"><a></a>        <span class="cf">return</span> <span class="va">self</span>.evaluate(state) <span class="op">!=</span> <span class="dv">0</span> <span class="kw">or</span> <span class="st">' '</span> <span class="kw">not</span> <span class="kw">in</span> state</span>
<span id="cb4-35"><a></a></span>
<span id="cb4-36"><a></a>    <span class="kw">def</span> evaluate(<span class="va">self</span>, state):</span>
<span id="cb4-37"><a></a>        <span class="co">"""</span></span>
<span id="cb4-38"><a></a><span class="co">        Evaluate the board state.</span></span>
<span id="cb4-39"><a></a><span class="co">        Return:</span></span>
<span id="cb4-40"><a></a><span class="co">            1 if 'X' wins,</span></span>
<span id="cb4-41"><a></a><span class="co">            -1 if 'O' wins,</span></span>
<span id="cb4-42"><a></a><span class="co">            0 otherwise (draw or ongoing game).</span></span>
<span id="cb4-43"><a></a><span class="co">        """</span></span>
<span id="cb4-44"><a></a>        lines <span class="op">=</span> []</span>
<span id="cb4-45"><a></a></span>
<span id="cb4-46"><a></a>        <span class="co"># Rows and columns</span></span>
<span id="cb4-47"><a></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="va">self</span>.size):</span>
<span id="cb4-48"><a></a>            lines.append(state[i, :])      <span class="co"># Row i</span></span>
<span id="cb4-49"><a></a>            lines.append(state[:, i])      <span class="co"># Column i</span></span>
<span id="cb4-50"><a></a></span>
<span id="cb4-51"><a></a>        <span class="co"># Diagonals</span></span>
<span id="cb4-52"><a></a>        lines.append(np.diag(state))</span>
<span id="cb4-53"><a></a>        lines.append(np.diag(np.fliplr(state)))</span>
<span id="cb4-54"><a></a></span>
<span id="cb4-55"><a></a>        <span class="co"># Check for a winner</span></span>
<span id="cb4-56"><a></a>        <span class="cf">for</span> line <span class="kw">in</span> lines:</span>
<span id="cb4-57"><a></a>            <span class="cf">if</span> np.<span class="bu">all</span>(line <span class="op">==</span> <span class="st">'X'</span>):</span>
<span id="cb4-58"><a></a>                <span class="cf">return</span> <span class="dv">1</span></span>
<span id="cb4-59"><a></a>            <span class="cf">elif</span> np.<span class="bu">all</span>(line <span class="op">==</span> <span class="st">'O'</span>):</span>
<span id="cb4-60"><a></a>                <span class="cf">return</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb4-61"><a></a></span>
<span id="cb4-62"><a></a>        <span class="co"># No winner</span></span>
<span id="cb4-63"><a></a>        <span class="cf">return</span> <span class="dv">0</span></span>
<span id="cb4-64"><a></a></span>
<span id="cb4-65"><a></a>    <span class="kw">def</span> display(<span class="va">self</span>, state):</span>
<span id="cb4-66"><a></a>        <span class="co">"""</span></span>
<span id="cb4-67"><a></a><span class="co">        Print the board to the console.</span></span>
<span id="cb4-68"><a></a><span class="co">        """</span></span>
<span id="cb4-69"><a></a>        <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Current board:"</span>)</span>
<span id="cb4-70"><a></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="va">self</span>.size):</span>
<span id="cb4-71"><a></a>            row <span class="op">=</span> <span class="st">'|'</span>.join(state[i])</span>
<span id="cb4-72"><a></a>            <span class="bu">print</span>(row)</span>
<span id="cb4-73"><a></a>            <span class="cf">if</span> i <span class="op">&lt;</span> <span class="va">self</span>.size <span class="op">-</span> <span class="dv">1</span>:</span>
<span id="cb4-74"><a></a>                <span class="bu">print</span>(<span class="st">'-'</span> <span class="op">*</span> (<span class="va">self</span>.size <span class="op">*</span> <span class="dv">2</span> <span class="op">-</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="node" class="slide level2">
<h2><code>Node</code></h2>
<div id="b6fbd066" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a></a><span class="co"># Node class for MCTS</span></span>
<span id="cb5-2"><a></a><span class="kw">class</span> Node:</span>
<span id="cb5-3"><a></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, state, parent<span class="op">=</span><span class="va">None</span>, move<span class="op">=</span><span class="va">None</span>, player<span class="op">=</span><span class="st">'X'</span>):</span>
<span id="cb5-4"><a></a>        <span class="va">self</span>.state <span class="op">=</span> state            <span class="co"># Game state at this node</span></span>
<span id="cb5-5"><a></a>        <span class="va">self</span>.parent <span class="op">=</span> parent          <span class="co"># Parent node</span></span>
<span id="cb5-6"><a></a>        <span class="va">self</span>.children <span class="op">=</span> []            <span class="co"># List of child nodes</span></span>
<span id="cb5-7"><a></a>        <span class="va">self</span>.visits <span class="op">=</span> <span class="dv">0</span>               <span class="co"># Number of times node has been visited</span></span>
<span id="cb5-8"><a></a>        <span class="va">self</span>.wins <span class="op">=</span> <span class="dv">0</span>                 <span class="co"># Number of wins from this node</span></span>
<span id="cb5-9"><a></a>        <span class="va">self</span>.move <span class="op">=</span> move              <span class="co"># Move that led to this node</span></span>
<span id="cb5-10"><a></a>        <span class="va">self</span>.player <span class="op">=</span> player          <span class="co"># Player who made the move</span></span>
<span id="cb5-11"><a></a></span>
<span id="cb5-12"><a></a>    <span class="kw">def</span> is_fully_expanded(<span class="va">self</span>, game):</span>
<span id="cb5-13"><a></a></span>
<span id="cb5-14"><a></a>        <span class="co">"""</span></span>
<span id="cb5-15"><a></a><span class="co">        Check if all possible moves from this node have been explored.</span></span>
<span id="cb5-16"><a></a><span class="co">        """</span></span>
<span id="cb5-17"><a></a></span>
<span id="cb5-18"><a></a>        <span class="cf">return</span> <span class="bu">len</span>(<span class="va">self</span>.children) <span class="op">==</span> <span class="bu">len</span>(game.get_valid_moves(<span class="va">self</span>.state))</span>
<span id="cb5-19"><a></a></span>
<span id="cb5-20"><a></a>    <span class="kw">def</span> best_child(<span class="va">self</span>, c_param<span class="op">=</span>math.sqrt(<span class="dv">2</span>)):</span>
<span id="cb5-21"><a></a></span>
<span id="cb5-22"><a></a>        <span class="co">"""</span></span>
<span id="cb5-23"><a></a><span class="co">        Select the child node with the highest UCB1 value.</span></span>
<span id="cb5-24"><a></a><span class="co">        """</span></span>
<span id="cb5-25"><a></a></span>
<span id="cb5-26"><a></a>        choices_weights <span class="op">=</span> []</span>
<span id="cb5-27"><a></a>        <span class="cf">for</span> child <span class="kw">in</span> <span class="va">self</span>.children:</span>
<span id="cb5-28"><a></a>            <span class="cf">if</span> child.visits <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb5-29"><a></a>                ucb1 <span class="op">=</span> <span class="bu">float</span>(<span class="st">'inf'</span>)</span>
<span id="cb5-30"><a></a>            <span class="cf">else</span>:</span>
<span id="cb5-31"><a></a>                win_rate <span class="op">=</span> child.wins <span class="op">/</span> child.visits</span>
<span id="cb5-32"><a></a>                exploration <span class="op">=</span> c_param <span class="op">*</span> math.sqrt((<span class="dv">2</span> <span class="op">*</span> math.log(<span class="va">self</span>.visits)) <span class="op">/</span> child.visits)</span>
<span id="cb5-33"><a></a>                ucb1 <span class="op">=</span> win_rate <span class="op">+</span> exploration</span>
<span id="cb5-34"><a></a>            choices_weights.append(ucb1)</span>
<span id="cb5-35"><a></a></span>
<span id="cb5-36"><a></a>        <span class="cf">return</span> <span class="va">self</span>.children[np.argmax(choices_weights)]</span>
<span id="cb5-37"><a></a></span>
<span id="cb5-38"><a></a>    <span class="kw">def</span> most_visited_child(<span class="va">self</span>):</span>
<span id="cb5-39"><a></a></span>
<span id="cb5-40"><a></a>        <span class="co">"""</span></span>
<span id="cb5-41"><a></a><span class="co">        Select the child node with the highest visit count.</span></span>
<span id="cb5-42"><a></a><span class="co">        """</span></span>
<span id="cb5-43"><a></a></span>
<span id="cb5-44"><a></a>        visits <span class="op">=</span> [child.visits <span class="cf">for</span> child <span class="kw">in</span> <span class="va">self</span>.children]</span>
<span id="cb5-45"><a></a>        <span class="cf">return</span> <span class="va">self</span>.children[np.argmax(visits)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="mcts" class="slide level2">
<h2><code>mcts</code></h2>
<div id="354c7885" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a></a><span class="co"># MCTS Algorithm</span></span>
<span id="cb6-2"><a></a><span class="kw">def</span> mcts(game, root, iterations):</span>
<span id="cb6-3"><a></a></span>
<span id="cb6-4"><a></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(iterations):</span>
<span id="cb6-5"><a></a>        node <span class="op">=</span> tree_policy(game, root)</span>
<span id="cb6-6"><a></a>        reward <span class="op">=</span> default_policy(game, node.state, node.player)</span>
<span id="cb6-7"><a></a>        backup(node, reward)</span>
<span id="cb6-8"><a></a></span>
<span id="cb6-9"><a></a>    <span class="cf">return</span> root.most_visited_child()</span>
<span id="cb6-10"><a></a></span>
<span id="cb6-11"><a></a><span class="kw">def</span> tree_policy(game, node):</span>
<span id="cb6-12"><a></a></span>
<span id="cb6-13"><a></a>    <span class="co">"""</span></span>
<span id="cb6-14"><a></a><span class="co">    Selection and Expansion phases.</span></span>
<span id="cb6-15"><a></a><span class="co">    """</span></span>
<span id="cb6-16"><a></a></span>
<span id="cb6-17"><a></a>    <span class="cf">while</span> <span class="kw">not</span> game.is_terminal(node.state):</span>
<span id="cb6-18"><a></a>        <span class="cf">if</span> <span class="kw">not</span> node.is_fully_expanded(game):</span>
<span id="cb6-19"><a></a>            <span class="cf">return</span> expand(game, node)</span>
<span id="cb6-20"><a></a>        <span class="cf">else</span>:</span>
<span id="cb6-21"><a></a>            node <span class="op">=</span> node.best_child()</span>
<span id="cb6-22"><a></a></span>
<span id="cb6-23"><a></a>    <span class="cf">return</span> node</span>
<span id="cb6-24"><a></a></span>
<span id="cb6-25"><a></a><span class="kw">def</span> expand(game, node):</span>
<span id="cb6-26"><a></a></span>
<span id="cb6-27"><a></a>    <span class="co">"""</span></span>
<span id="cb6-28"><a></a><span class="co">    Expand a child node from the current node.</span></span>
<span id="cb6-29"><a></a><span class="co">    """</span></span>
<span id="cb6-30"><a></a></span>
<span id="cb6-31"><a></a>    tried_moves <span class="op">=</span> [child.move <span class="cf">for</span> child <span class="kw">in</span> node.children]</span>
<span id="cb6-32"><a></a>    possible_moves <span class="op">=</span> game.get_valid_moves(node.state)</span>
<span id="cb6-33"><a></a></span>
<span id="cb6-34"><a></a>    <span class="cf">for</span> move <span class="kw">in</span> possible_moves:</span>
<span id="cb6-35"><a></a>        <span class="cf">if</span> move <span class="kw">not</span> <span class="kw">in</span> tried_moves:</span>
<span id="cb6-36"><a></a>            next_state <span class="op">=</span> game.make_move(node.state, move, node.player)</span>
<span id="cb6-37"><a></a>            child_node <span class="op">=</span> Node(state<span class="op">=</span>next_state, parent<span class="op">=</span>node, move<span class="op">=</span>move, player<span class="op">=</span>game.get_opponent(node.player))</span>
<span id="cb6-38"><a></a>            node.children.append(child_node)</span>
<span id="cb6-39"><a></a>            <span class="cf">return</span> child_node</span>
<span id="cb6-40"><a></a></span>
<span id="cb6-41"><a></a><span class="kw">def</span> default_policy(game, state, player):</span>
<span id="cb6-42"><a></a></span>
<span id="cb6-43"><a></a>    <span class="co">"""</span></span>
<span id="cb6-44"><a></a><span class="co">    Simulation phase: play out the game randomly from the given state.</span></span>
<span id="cb6-45"><a></a><span class="co">    """</span></span>
<span id="cb6-46"><a></a></span>
<span id="cb6-47"><a></a>    current_state <span class="op">=</span> state.copy()</span>
<span id="cb6-48"><a></a>    current_player <span class="op">=</span> player</span>
<span id="cb6-49"><a></a></span>
<span id="cb6-50"><a></a>    <span class="cf">while</span> <span class="kw">not</span> game.is_terminal(current_state):</span>
<span id="cb6-51"><a></a>        possible_moves <span class="op">=</span> game.get_valid_moves(current_state)</span>
<span id="cb6-52"><a></a>        move <span class="op">=</span> random.choice(possible_moves)</span>
<span id="cb6-53"><a></a>        current_state <span class="op">=</span> game.make_move(current_state, move, current_player)</span>
<span id="cb6-54"><a></a>        current_player <span class="op">=</span> game.get_opponent(current_player)</span>
<span id="cb6-55"><a></a></span>
<span id="cb6-56"><a></a>    result <span class="op">=</span> game.evaluate(current_state)</span>
<span id="cb6-57"><a></a></span>
<span id="cb6-58"><a></a>    <span class="cf">return</span> result</span>
<span id="cb6-59"><a></a></span>
<span id="cb6-60"><a></a><span class="kw">def</span> backup(node, reward):</span>
<span id="cb6-61"><a></a></span>
<span id="cb6-62"><a></a>    <span class="co">"""</span></span>
<span id="cb6-63"><a></a><span class="co">    Backpropagation phase: update the node statistics.</span></span>
<span id="cb6-64"><a></a><span class="co">    """</span></span>
<span id="cb6-65"><a></a></span>
<span id="cb6-66"><a></a>    <span class="cf">while</span> node <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb6-67"><a></a>        node.visits <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb6-68"><a></a>        <span class="co"># Update wins. If the result is a win for the player who just played, add 1.</span></span>
<span id="cb6-69"><a></a>        <span class="cf">if</span> (node.player <span class="op">==</span> <span class="st">'X'</span> <span class="kw">and</span> reward <span class="op">==</span> <span class="dv">1</span>) <span class="kw">or</span> (node.player <span class="op">==</span> <span class="st">'O'</span> <span class="kw">and</span> reward <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb6-70"><a></a>            node.wins <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb6-71"><a></a>        <span class="cf">elif</span> reward <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb6-72"><a></a>            node.wins <span class="op">+=</span> <span class="fl">0.5</span>  <span class="co"># Consider draw as half win</span></span>
<span id="cb6-73"><a></a>        node <span class="op">=</span> node.parent</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="test_tic_tac_toe_mcts" class="slide level2">
<h2><code>test_tic_tac_toe_mcts</code></h2>
<div id="bba3efcb" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a></a><span class="co"># Main function to demonstrate the application</span></span>
<span id="cb7-2"><a></a><span class="kw">def</span> test_tic_tac_toe_mcts():</span>
<span id="cb7-3"><a></a></span>
<span id="cb7-4"><a></a>    game <span class="op">=</span> TicTacToe()</span>
<span id="cb7-5"><a></a>    current_state <span class="op">=</span> game.board.copy()</span>
<span id="cb7-6"><a></a>    current_player <span class="op">=</span> <span class="st">'X'</span></span>
<span id="cb7-7"><a></a>    root_node <span class="op">=</span> Node(state<span class="op">=</span>current_state, player<span class="op">=</span>current_player)</span>
<span id="cb7-8"><a></a></span>
<span id="cb7-9"><a></a>    <span class="cf">while</span> <span class="kw">not</span> game.is_terminal(current_state):</span>
<span id="cb7-10"><a></a></span>
<span id="cb7-11"><a></a>        game.display(current_state)</span>
<span id="cb7-12"><a></a>        <span class="bu">print</span>(<span class="ss">f"Player </span><span class="sc">{</span>current_player<span class="sc">}</span><span class="ss">'s turn."</span>)</span>
<span id="cb7-13"><a></a></span>
<span id="cb7-14"><a></a>        <span class="cf">if</span> current_player <span class="op">==</span> <span class="st">'X'</span>:</span>
<span id="cb7-15"><a></a>            <span class="co"># AI's turn using MCTS</span></span>
<span id="cb7-16"><a></a>            iterations <span class="op">=</span> <span class="dv">1000</span>  <span class="co"># Adjust as needed</span></span>
<span id="cb7-17"><a></a>            best_child <span class="op">=</span> mcts(game, root_node, iterations)</span>
<span id="cb7-18"><a></a>            current_state <span class="op">=</span> best_child.state</span>
<span id="cb7-19"><a></a>            root_node <span class="op">=</span> best_child</span>
<span id="cb7-20"><a></a>        <span class="cf">else</span>:</span>
<span id="cb7-21"><a></a>            <span class="co"># Human player's turn</span></span>
<span id="cb7-22"><a></a>            possible_moves <span class="op">=</span> game.get_valid_moves(current_state)</span>
<span id="cb7-23"><a></a>            <span class="bu">print</span>(<span class="st">"Possible moves:"</span>, possible_moves)</span>
<span id="cb7-24"><a></a>            move <span class="op">=</span> <span class="va">None</span></span>
<span id="cb7-25"><a></a>            <span class="cf">while</span> move <span class="kw">not</span> <span class="kw">in</span> possible_moves:</span>
<span id="cb7-26"><a></a>                <span class="cf">try</span>:</span>
<span id="cb7-27"><a></a>                    move_input <span class="op">=</span> <span class="bu">input</span>(<span class="st">"Enter your move as 'row,col': "</span>)</span>
<span id="cb7-28"><a></a>                    move <span class="op">=</span> <span class="bu">tuple</span>(<span class="bu">int</span>(x.strip()) <span class="cf">for</span> x <span class="kw">in</span> move_input.split(<span class="st">','</span>))</span>
<span id="cb7-29"><a></a>                <span class="cf">except</span>:</span>
<span id="cb7-30"><a></a>                    <span class="bu">print</span>(<span class="st">"Invalid input. Please enter row and column numbers separated by a comma."</span>)</span>
<span id="cb7-31"><a></a>            current_state <span class="op">=</span> game.make_move(current_state, move, current_player)</span>
<span id="cb7-32"><a></a>            <span class="co"># Update the tree: find or create the child node corresponding to the move</span></span>
<span id="cb7-33"><a></a>            matching_child <span class="op">=</span> <span class="va">None</span></span>
<span id="cb7-34"><a></a>            <span class="cf">for</span> child <span class="kw">in</span> root_node.children:</span>
<span id="cb7-35"><a></a>                <span class="cf">if</span> child.move <span class="op">==</span> move:</span>
<span id="cb7-36"><a></a>                    matching_child <span class="op">=</span> child</span>
<span id="cb7-37"><a></a>                    <span class="cf">break</span></span>
<span id="cb7-38"><a></a>            <span class="cf">if</span> matching_child:</span>
<span id="cb7-39"><a></a>                root_node <span class="op">=</span> matching_child</span>
<span id="cb7-40"><a></a>            <span class="cf">else</span>:</span>
<span id="cb7-41"><a></a>                root_node <span class="op">=</span> Node(state<span class="op">=</span>current_state, parent<span class="op">=</span><span class="va">None</span>, move<span class="op">=</span>move, player<span class="op">=</span>game.get_opponent(current_player))</span>
<span id="cb7-42"><a></a>        <span class="co"># Switch player</span></span>
<span id="cb7-43"><a></a>        current_player <span class="op">=</span> game.get_opponent(current_player)</span>
<span id="cb7-44"><a></a></span>
<span id="cb7-45"><a></a>    <span class="co"># Game over</span></span>
<span id="cb7-46"><a></a>    game.display(current_state)</span>
<span id="cb7-47"><a></a>    result <span class="op">=</span> game.evaluate(current_state)</span>
<span id="cb7-48"><a></a>    <span class="cf">if</span> result <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb7-49"><a></a>        <span class="bu">print</span>(<span class="st">"X wins!"</span>)</span>
<span id="cb7-50"><a></a>    <span class="cf">elif</span> result <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>:</span>
<span id="cb7-51"><a></a>        <span class="bu">print</span>(<span class="st">"O wins!"</span>)</span>
<span id="cb7-52"><a></a>    <span class="cf">else</span>:</span>
<span id="cb7-53"><a></a>        <span class="bu">print</span>(<span class="st">"It's a draw!"</span>)</span>
<span id="cb7-54"><a></a></span>
<span id="cb7-55"><a></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">"__main__"</span>:</span>
<span id="cb7-56"><a></a>    test_tic_tac_toe_mcts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exploration" class="slide level2">
<h2>Exploration</h2>
<ul>
<li><p>Implement code to visualize the search tree, either as text or using Graphviz.</p></li>
<li><p>Incorporate heuristics to detect when a winning move is achievable in a single step.</p></li>
<li><p>Experiment with varying the number of iterations and the constant <span class="math inline">\(C\)</span>.</p></li>
</ul>
</section></section>
<section>
<section id="prologue" class="title-slide slide level1 center">
<h1>Prologue</h1>

</section>
<section id="summary" class="slide level2 scrollable">
<h2>Summary</h2>
<ul>
<li>Monte Carlo Tree Search (MCTS) is a search algorithm used for decision-making in complex games.</li>
<li>MCTS operates through four main steps: Selection, Expansion, Rollout (Simulation), and Backpropagation.</li>
<li>It balances exploration and exploitation using the UCB1 formula, which guides node selection based on visit counts and scores.</li>
<li>MCTS maintains an explicit search tree, updating node values iteratively based on simulations.</li>
<li>The algorithm has wide-ranging applications, including AI gaming, drug design, circuit routing, and autonomous driving.</li>
<li>Introduced in 2008, MCTS gained prominence with its use in AlphaGo in 2016.</li>
<li>Unlike traditional algorithms like <span class="math inline">\(A^\star\)</span>, MCTS uses dynamic policies and leverages all visited nodes for decision-making.</li>
<li>Implementing MCTS involves tracking node statistics and applying the UCB1 formula to guide search.</li>
<li>A practical example of MCTS is demonstrated through implementing Tic-Tac-Toe.</li>
<li>Further exploration includes integrating MCTS with deep learning models like AlphaZero and MuZero.</li>
</ul>
<aside class="notes">

<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="further-exploration" class="slide level2">
<h2>Further exploration</h2>
<ul>
<li><a href="https://github.com/sotetsuk/pgx">JAX-native environment for simulations</a></li>
<li><a href="https://deepmind.google/discover/blog/alphazero-shedding-new-light-on-chess-shogi-and-go/">AlphaZero</a></li>
<li><a href="https://deepmind.google/discover/blog/muzero-mastering-go-chess-shogi-and-atari-without-rules/">MuZero</a></li>
<li><a href="https://openreview.net/forum?id=bERaNdoegnO">Gumbel</a></li>
<li><a href="https://github.com/kevinzhangftw/Monte-Carlo-Tree-Search-Tic-Tac-Toe/tree/master">MCTS Tic-Tac-Toe with Visualization</a></li>
</ul>
</section>
<section id="the-end" class="slide level2">
<h2>The End</h2>
<ul>
<li>Consult the course website for information on the final examination.</li>
</ul>
</section>
<section id="references" class="slide level2 smaller scrollable">
<h2>References</h2>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Chaslot:2008aa" class="csl-entry" role="listitem">
Chaslot, Guillaume, Sander Bakkes, Istvan Szita, and Pieter Spronck. 2008. <span>“<span class="nocase">Monte-Carlo Tree Search: a new framework for game AI</span>.”</span> In <em>Proceedings of the Fourth AAAI Conference on Artificial Intelligence and Interactive Digital Entertainment</em>, 216–17. AIIDE’08. Stanford, California: AAAI Press.
</div>
<div id="ref-Kemmerling:2024aa" class="csl-entry" role="listitem">
Kemmerling, Marco, Daniel Lütticke, and Robert H. Schmitt. 2024. <span>“Beyond Games: A Systematic Review of Neural Monte Carlo Tree Search Applications.”</span> <em>Applied Intelligence</em> 54 (1): 1020–46. <a href="https://doi.org/10.1007/s10489-023-05240-w">https://doi.org/10.1007/s10489-023-05240-w</a>.
</div>
<div id="ref-Russell:2020aa" class="csl-entry" role="listitem">
Russell, Stuart, and Peter Norvig. 2020. <em>Artificial Intelligence: <span>A</span> Modern Approach</em>. 4th ed. Pearson. <a href="http://aima.cs.berkeley.edu/">http://aima.cs.berkeley.edu/</a>.
</div>
<div id="ref-Silver:2016aa" class="csl-entry" role="listitem">
Silver, David, Aja Huang, Chris J. Maddison, Arthur Guez, Laurent Sifre, George van den Driessche, Julian Schrittwieser, et al. 2016. <span>“<span class="nocase">Mastering the game of Go with deep neural networks and tree search</span>.”</span> <em>Nature</em> 529 (7587): 484–89. <a href="https://doi.org/10.1038/nature16961">https://doi.org/10.1038/nature16961</a>.
</div>
</div>
</section>
<section class="slide level2">

<p>Marcel <strong>Turcotte</strong></p>
<p><a href="mailto:Marcel.Turcotte@uOttawa.ca">Marcel.Turcotte@uOttawa.ca</a></p>
<p>School of Electrical Engineering and <strong>Computer Science</strong> (EE<strong>CS</strong>)</p>
<p>University of Ottawa</p>


</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<p><img src="../../assets/images/uottawa_hor_black.png" class="slide-logo"></p>
<div class="footer footer-default">
<p><a href="https://turcotte.xyz/teaching/csi-4106">turcotte.xyz/teaching/csi-4106</a></p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="../../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
            const codeEl = trigger.previousElementSibling.cloneNode(true);
            for (const childEl of codeEl.children) {
              if (isCodeAnnotation(childEl)) {
                childEl.remove();
              }
            }
            return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp("https:\/\/turcotte\.xyz\/teaching\/csi-4106");
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    <script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
    (function() {
      let previousOnload = window.onload;
      window.onload = () => {
        if (previousOnload) {
          previousOnload();
        }
        lightboxQuarto.on('slide_before_load', (data) => {
          const { slideIndex, slideNode, slideConfig, player, trigger } = data;
          const href = trigger.getAttribute('href');
          if (href !== null) {
            const imgEl = window.document.querySelector(`a[href="${href}"] img`);
            if (imgEl !== null) {
              const srcAttr = imgEl.getAttribute("src");
              if (srcAttr && srcAttr.startsWith("data:")) {
                slideConfig.href = srcAttr;
              }
            }
          } 
        });
      
        lightboxQuarto.on('slide_after_load', (data) => {
          const { slideIndex, slideNode, slideConfig, player, trigger } = data;
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(slideNode);
          }
        });
      
      };
      
    })();
              </script>
    

</body></html>